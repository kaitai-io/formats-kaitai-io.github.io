<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>NT-MDT data: JavaScript parsing library</title>
  <meta name="keywords" content="kaitai,struct,binary,format,parsing,decoding,java,javascript,python,ruby,library,metadata">
  <meta name="description" content="Kaitai Struct is a formal language for binary format specification that can be compiled into parser code">

  <link rel="stylesheet" href="http://kaitai.io/styles/bootstrap.min.css">
  <link rel="stylesheet" href="http://kaitai.io/styles/bootstrap-theme.min.css">
  <link href='https://fonts.googleapis.com/css?family=Exo:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Share+Tech+Mono' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  <link rel="stylesheet" href="http://kaitai.io/styles/main.css" type="text/css">

  <link rel="stylesheet" href="http://kaitai.io/styles/highlight/default.css">
  <style>
.diagram-img {
    display: block;
    max-width: 100%;
    height: auto;
    margin: 0 auto;
}

section.format {
    padding: 30px 0;
}

section#format-meta, section#format-index-header {
    background: #e3eef7;
}

section#format-diagram, section#format-index-footer {
    background: #e9f8dd;
}

section#format-ksy, section#format-lang {
    background: #d1eadd;
}

section#format-index .row {
    padding-bottom: 10px;
}

  </style>
  <script src="http://kaitai.io/js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>
<body data-spy="scroll" data-target="#main-navbar" data-offset="100">

    <nav class="navbar navbar-inverse navbar-fixed-top" id="main-navbar">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-navbar-collapse" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <span class="navbar-brand">Kaitai Struct</span>
            </div>
            <div class="collapse navbar-collapse" id="main-navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="http://kaitai.io/#what-is-it">What is it?</a></li>
                    <li><a href="http://kaitai.io/#quick-start">Quick Start</a></li>
                    <li><a href="http://kaitai.io/#download">Download</a></li>
                    <li class="active"><a href="http://formats.kaitai.io/">Format Gallery</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="http://kaitai.io/repl/index.html">Try it</a></li>
                    <li><a href="https://ide.kaitai.io/">Web IDE</a></li>
                    <li><a href="http://doc.kaitai.io/">Documentation</a></li>
                </ul>
            </div>
        </div>
    </nav>
<nav>
    <div class="container">
    <ol class="breadcrumb">
        <li><a href="../index.html">Format Gallery</a></li>
        <li>Scientific Applications</li>
        <li class="active">NT-MDT data</li>
    </ol>
    </div>
</nav>

<section id="format-meta" class="format">
    <div class="container">
        <h1>NT-MDT data:
            
            JavaScript parsing library
            
        </h1>

        <div class="row">
            <div class="col-md-8">
                <p><p>A native file format of NT-MDT scientific software. Usually contains
any of:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Scanning_probe_microscopy">Scanning probe</a> microscopy scans and spectra</li>
<li><a href="https://en.wikipedia.org/wiki/Raman_spectroscopy">Raman spectra</a></li>
<li>results of their analysis</li>
</ul>
<p>Some examples of mdt files can be downloaded at:</p>
<ul>
<li>http://www.ntmdt-si.ru/scan-gallery</li>
<li>http://callistosoft.narod.ru/Resources/Mdt.zip</li>
</ul>
</p>
            </div>
            <div class="col-md-4">
                <div class="panel panel-info">
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">Application</h3>
                    </div>
                    <div class="panel-body">
                        ["Nova", "Image Analysis", "NanoEducator", "Gwyddion", "Callisto"]
                    </div>
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">File extension</h3>
                    </div>
                    <div class="panel-body">
                        mdt
                    </div>
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">KS implementation details</h3>
                    </div>
                    
                    <div class="panel-body">
                        License: <a href="https://spdx.org/licenses/GPL-3.0+.html">GPL-3.0+</a>
                    </div>
                    
                    
                    
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
            <p>
            This page hosts a formal specification of NT-MDT data
            using <a href="http://kaitai.io">Kaitai Struct</a>. This
            specification can be automatically translated into a
            variety of programming languages to get a parsing library.
            </p>

            <ul class="nav nav-pills">
                
                
                <li>
                
                <a href="index.html" title="NT-MDT data parsing Overview library">Overview</a></li>
                
                
                <li>
                
                <a href="cpp_stl.html" title="NT-MDT data parsing C++/STL library">C++/STL</a></li>
                
                
                <li>
                
                <a href="csharp.html" title="NT-MDT data parsing C# library">C#</a></li>
                
                
                <li>
                
                <a href="graphviz.html" title="NT-MDT data parsing GraphViz library">GraphViz</a></li>
                
                
                <li>
                
                <a href="java.html" title="NT-MDT data parsing Java library">Java</a></li>
                
                
                <li class="active">
                
                <a href="javascript.html" title="NT-MDT data parsing JavaScript library">JavaScript</a></li>
                
                
                <li>
                
                <a href="lua.html" title="NT-MDT data parsing Lua library">Lua</a></li>
                
                
                <li>
                
                <a href="perl.html" title="NT-MDT data parsing Perl library">Perl</a></li>
                
                
                <li>
                
                <a href="php.html" title="NT-MDT data parsing PHP library">PHP</a></li>
                
                
                <li>
                
                <a href="python.html" title="NT-MDT data parsing Python library">Python</a></li>
                
                
                <li>
                
                <a href="ruby.html" title="NT-MDT data parsing Ruby library">Ruby</a></li>
                
            </ul>
            </div>
        </div>
    </div>
</section>

<section id="format-usage" class="format">
    <div class="container">
        <h2>Usage</h2>

        
<p>See the usage examples in the <a href="http://doc.kaitai.io/lang_javascript.html" target="_blank">JavaScript notes</a>.</p>

<p>Parse structure from an ArrayBuffer:</p>

<pre><code class="javascript">var arrayBuffer = ...;
var data = new NtMdt(new KaitaiStream(arrayBuffer));</code></pre>

<p>After that, one can get various attributes from the structure by invoking getter methods like:</p>

<pre><code class="javascript">data.size() // => File size (w/o header)</code></pre>

    </div>
</section>


<section id="format-lang" class="format">
    <div class="container">
        <h2>
            
            JavaScript source code to parse NT-MDT data
            
        </h2>

        

        <h3>NtMdt.js</h3>

        <div class="row">
            <div class="pull-right">
                <p>
                    <a href="src/javascript/NtMdt.js" class="btn btn-success">Download <i class="fa fa-download"></i></a>
                </p>
            </div>
        </div>

        <div class="row">
            <pre><code class="javascript">// This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild

(function (root, factory) {
  if (typeof define === &#39;function&#39; &amp;&amp; define.amd) {
    define([&#39;kaitai-struct/KaitaiStream&#39;], factory);
  } else if (typeof module === &#39;object&#39; &amp;&amp; module.exports) {
    module.exports = factory(require(&#39;kaitai-struct/KaitaiStream&#39;));
  } else {
    root.NtMdt = factory(root.KaitaiStream);
  }
}(this, function (KaitaiStream) {
/**
 * A native file format of NT-MDT scientific software. Usually contains
 * any of:
 * 
 * * [Scanning probe](https://en.wikipedia.org/wiki/Scanning_probe_microscopy) microscopy scans and spectra
 * * [Raman spectra](https://en.wikipedia.org/wiki/Raman_spectroscopy)
 * * results of their analysis
 * 
 * Some examples of mdt files can be downloaded at:
 * 
 * * http://www.ntmdt-si.ru/scan-gallery
 * * http://callistosoft.narod.ru/Resources/Mdt.zip
 * @see {@link https://svn.code.sf.net/p/gwyddion/code/trunk/gwyddion/modules/file/nt-mdt.c|Source}
 */

var NtMdt = (function() {
  NtMdt.AdcMode = Object.freeze({
    HEIGHT: 0,
    DFL: 1,
    LATERAL_F: 2,
    BIAS_V: 3,
    CURRENT: 4,
    FB_OUT: 5,
    MAG: 6,
    MAG_SIN: 7,
    MAG_COS: 8,
    RMS: 9,
    CALC_MAG: 10,
    PHASE1: 11,
    PHASE2: 12,
    CALC_PHASE: 13,
    EX1: 14,
    EX2: 15,
    HV_X: 16,
    HV_Y: 17,
    SNAP_BACK: 18,
    FALSE: 255,

    0: &quot;HEIGHT&quot;,
    1: &quot;DFL&quot;,
    2: &quot;LATERAL_F&quot;,
    3: &quot;BIAS_V&quot;,
    4: &quot;CURRENT&quot;,
    5: &quot;FB_OUT&quot;,
    6: &quot;MAG&quot;,
    7: &quot;MAG_SIN&quot;,
    8: &quot;MAG_COS&quot;,
    9: &quot;RMS&quot;,
    10: &quot;CALC_MAG&quot;,
    11: &quot;PHASE1&quot;,
    12: &quot;PHASE2&quot;,
    13: &quot;CALC_PHASE&quot;,
    14: &quot;EX1&quot;,
    15: &quot;EX2&quot;,
    16: &quot;HV_X&quot;,
    17: &quot;HV_Y&quot;,
    18: &quot;SNAP_BACK&quot;,
    255: &quot;FALSE&quot;,
  });

  NtMdt.XmlScanLocation = Object.freeze({
    HLT: 0,
    HLB: 1,
    HRT: 2,
    HRB: 3,
    VLT: 4,
    VLB: 5,
    VRT: 6,
    VRB: 7,

    0: &quot;HLT&quot;,
    1: &quot;HLB&quot;,
    2: &quot;HRT&quot;,
    3: &quot;HRB&quot;,
    4: &quot;VLT&quot;,
    5: &quot;VLB&quot;,
    6: &quot;VRT&quot;,
    7: &quot;VRB&quot;,
  });

  NtMdt.DataType = Object.freeze({
    FLOATFIX: -65544,
    FLOAT80: -16138,
    FLOAT64: -13320,
    FLOAT48: -9990,
    FLOAT32: -5892,
    INT64: -8,
    INT32: -4,
    INT16: -2,
    INT8: -1,
    UNKNOWN0: 0,
    UINT8: 1,
    UINT16: 2,
    UINT32: 4,
    UINT64: 8,

    &quot;-65544&quot;: &quot;FLOATFIX&quot;,
    &quot;-16138&quot;: &quot;FLOAT80&quot;,
    &quot;-13320&quot;: &quot;FLOAT64&quot;,
    &quot;-9990&quot;: &quot;FLOAT48&quot;,
    &quot;-5892&quot;: &quot;FLOAT32&quot;,
    &quot;-8&quot;: &quot;INT64&quot;,
    &quot;-4&quot;: &quot;INT32&quot;,
    &quot;-2&quot;: &quot;INT16&quot;,
    &quot;-1&quot;: &quot;INT8&quot;,
    0: &quot;UNKNOWN0&quot;,
    1: &quot;UINT8&quot;,
    2: &quot;UINT16&quot;,
    4: &quot;UINT32&quot;,
    8: &quot;UINT64&quot;,
  });

  NtMdt.XmlParamType = Object.freeze({
    NONE: 0,
    LASER_WAVELENGTH: 1,
    UNITS: 2,
    DATA_ARRAY: 255,

    0: &quot;NONE&quot;,
    1: &quot;LASER_WAVELENGTH&quot;,
    2: &quot;UNITS&quot;,
    255: &quot;DATA_ARRAY&quot;,
  });

  NtMdt.SpmMode = Object.freeze({
    CONSTANT_FORCE: 0,
    CONTACT_CONSTANT_HEIGHT: 1,
    CONTACT_ERROR: 2,
    LATERAL_FORCE: 3,
    FORCE_MODULATION: 4,
    SPREADING_RESISTANCE_IMAGING: 5,
    SEMICONTACT_TOPOGRAPHY: 6,
    SEMICONTACT_ERROR: 7,
    PHASE_CONTRAST: 8,
    AC_MAGNETIC_FORCE: 9,
    DC_MAGNETIC_FORCE: 10,
    ELECTROSTATIC_FORCE: 11,
    CAPACITANCE_CONTRAST: 12,
    KELVIN_PROBE: 13,
    CONSTANT_CURRENT: 14,
    BARRIER_HEIGHT: 15,
    CONSTANT_HEIGHT: 16,
    AFAM: 17,
    CONTACT_EFM: 18,
    SHEAR_FORCE_TOPOGRAPHY: 19,
    SFOM: 20,
    CONTACT_CAPACITANCE: 21,
    SNOM_TRANSMISSION: 22,
    SNOM_REFLECTION: 23,
    SNOM_ALL: 24,
    SNOM: 25,

    0: &quot;CONSTANT_FORCE&quot;,
    1: &quot;CONTACT_CONSTANT_HEIGHT&quot;,
    2: &quot;CONTACT_ERROR&quot;,
    3: &quot;LATERAL_FORCE&quot;,
    4: &quot;FORCE_MODULATION&quot;,
    5: &quot;SPREADING_RESISTANCE_IMAGING&quot;,
    6: &quot;SEMICONTACT_TOPOGRAPHY&quot;,
    7: &quot;SEMICONTACT_ERROR&quot;,
    8: &quot;PHASE_CONTRAST&quot;,
    9: &quot;AC_MAGNETIC_FORCE&quot;,
    10: &quot;DC_MAGNETIC_FORCE&quot;,
    11: &quot;ELECTROSTATIC_FORCE&quot;,
    12: &quot;CAPACITANCE_CONTRAST&quot;,
    13: &quot;KELVIN_PROBE&quot;,
    14: &quot;CONSTANT_CURRENT&quot;,
    15: &quot;BARRIER_HEIGHT&quot;,
    16: &quot;CONSTANT_HEIGHT&quot;,
    17: &quot;AFAM&quot;,
    18: &quot;CONTACT_EFM&quot;,
    19: &quot;SHEAR_FORCE_TOPOGRAPHY&quot;,
    20: &quot;SFOM&quot;,
    21: &quot;CONTACT_CAPACITANCE&quot;,
    22: &quot;SNOM_TRANSMISSION&quot;,
    23: &quot;SNOM_REFLECTION&quot;,
    24: &quot;SNOM_ALL&quot;,
    25: &quot;SNOM&quot;,
  });

  NtMdt.Unit = Object.freeze({
    RAMAN_SHIFT: -10,
    RESERVED0: -9,
    RESERVED1: -8,
    RESERVED2: -7,
    RESERVED3: -6,
    METER: -5,
    CENTI_METER: -4,
    MILLI_METER: -3,
    MICRO_METER: -2,
    NANO_METER: -1,
    ANGSTROM: 0,
    NANO_AMPERE: 1,
    VOLT: 2,
    NONE: 3,
    KILO_HERTZ: 4,
    DEGREES: 5,
    PERCENT: 6,
    CELSIUS_DEGREE: 7,
    VOLT_HIGH: 8,
    SECOND: 9,
    MILLI_SECOND: 10,
    MICRO_SECOND: 11,
    NANO_SECOND: 12,
    COUNTS: 13,
    PIXELS: 14,
    RESERVED_SFOM0: 15,
    RESERVED_SFOM1: 16,
    RESERVED_SFOM2: 17,
    RESERVED_SFOM3: 18,
    RESERVED_SFOM4: 19,
    AMPERE2: 20,
    MILLI_AMPERE: 21,
    MICRO_AMPERE: 22,
    NANO_AMPERE2: 23,
    PICO_AMPERE: 24,
    VOLT2: 25,
    MILLI_VOLT: 26,
    MICRO_VOLT: 27,
    NANO_VOLT: 28,
    PICO_VOLT: 29,
    NEWTON: 30,
    MILLI_NEWTON: 31,
    MICRO_NEWTON: 32,
    NANO_NEWTON: 33,
    PICO_NEWTON: 34,
    RESERVED_DOS0: 35,
    RESERVED_DOS1: 36,
    RESERVED_DOS2: 37,
    RESERVED_DOS3: 38,
    RESERVED_DOS4: 39,

    &quot;-10&quot;: &quot;RAMAN_SHIFT&quot;,
    &quot;-9&quot;: &quot;RESERVED0&quot;,
    &quot;-8&quot;: &quot;RESERVED1&quot;,
    &quot;-7&quot;: &quot;RESERVED2&quot;,
    &quot;-6&quot;: &quot;RESERVED3&quot;,
    &quot;-5&quot;: &quot;METER&quot;,
    &quot;-4&quot;: &quot;CENTI_METER&quot;,
    &quot;-3&quot;: &quot;MILLI_METER&quot;,
    &quot;-2&quot;: &quot;MICRO_METER&quot;,
    &quot;-1&quot;: &quot;NANO_METER&quot;,
    0: &quot;ANGSTROM&quot;,
    1: &quot;NANO_AMPERE&quot;,
    2: &quot;VOLT&quot;,
    3: &quot;NONE&quot;,
    4: &quot;KILO_HERTZ&quot;,
    5: &quot;DEGREES&quot;,
    6: &quot;PERCENT&quot;,
    7: &quot;CELSIUS_DEGREE&quot;,
    8: &quot;VOLT_HIGH&quot;,
    9: &quot;SECOND&quot;,
    10: &quot;MILLI_SECOND&quot;,
    11: &quot;MICRO_SECOND&quot;,
    12: &quot;NANO_SECOND&quot;,
    13: &quot;COUNTS&quot;,
    14: &quot;PIXELS&quot;,
    15: &quot;RESERVED_SFOM0&quot;,
    16: &quot;RESERVED_SFOM1&quot;,
    17: &quot;RESERVED_SFOM2&quot;,
    18: &quot;RESERVED_SFOM3&quot;,
    19: &quot;RESERVED_SFOM4&quot;,
    20: &quot;AMPERE2&quot;,
    21: &quot;MILLI_AMPERE&quot;,
    22: &quot;MICRO_AMPERE&quot;,
    23: &quot;NANO_AMPERE2&quot;,
    24: &quot;PICO_AMPERE&quot;,
    25: &quot;VOLT2&quot;,
    26: &quot;MILLI_VOLT&quot;,
    27: &quot;MICRO_VOLT&quot;,
    28: &quot;NANO_VOLT&quot;,
    29: &quot;PICO_VOLT&quot;,
    30: &quot;NEWTON&quot;,
    31: &quot;MILLI_NEWTON&quot;,
    32: &quot;MICRO_NEWTON&quot;,
    33: &quot;NANO_NEWTON&quot;,
    34: &quot;PICO_NEWTON&quot;,
    35: &quot;RESERVED_DOS0&quot;,
    36: &quot;RESERVED_DOS1&quot;,
    37: &quot;RESERVED_DOS2&quot;,
    38: &quot;RESERVED_DOS3&quot;,
    39: &quot;RESERVED_DOS4&quot;,
  });

  NtMdt.SpmTechnique = Object.freeze({
    CONTACT_MODE: 0,
    SEMICONTACT_MODE: 1,
    TUNNEL_CURRENT: 2,
    SNOM: 3,

    0: &quot;CONTACT_MODE&quot;,
    1: &quot;SEMICONTACT_MODE&quot;,
    2: &quot;TUNNEL_CURRENT&quot;,
    3: &quot;SNOM&quot;,
  });

  NtMdt.Consts = Object.freeze({
    FRAME_MODE_SIZE: 8,
    FRAME_HEADER_SIZE: 22,
    AXIS_SCALES_SIZE: 30,
    FILE_HEADER_SIZE: 32,
    SPECTRO_VARS_MIN_SIZE: 38,
    SCAN_VARS_MIN_SIZE: 77,

    8: &quot;FRAME_MODE_SIZE&quot;,
    22: &quot;FRAME_HEADER_SIZE&quot;,
    30: &quot;AXIS_SCALES_SIZE&quot;,
    32: &quot;FILE_HEADER_SIZE&quot;,
    38: &quot;SPECTRO_VARS_MIN_SIZE&quot;,
    77: &quot;SCAN_VARS_MIN_SIZE&quot;,
  });

  function NtMdt(_io, _parent, _root) {
    this._io = _io;
    this._parent = _parent;
    this._root = _root || this;

    this._read();
  }
  NtMdt.prototype._read = function() {
    this.signature = this._io.ensureFixedContents([1, 176, 147, 255]);
    this.size = this._io.readU4le();
    this.reserved0 = this._io.readBytes(4);
    this.lastFrame = this._io.readU2le();
    this.reserved1 = this._io.readBytes(18);
    this.wrondDoc = this._io.readBytes(1);
    this._raw_frames = this._io.readBytes(this.size);
    var _io__raw_frames = new KaitaiStream(this._raw_frames);
    this.frames = new Framez(_io__raw_frames, this, this._root);
  }

  var Uuid = NtMdt.Uuid = (function() {
    function Uuid(_io, _parent, _root) {
      this._io = _io;
      this._parent = _parent;
      this._root = _root || this;

      this._read();
    }
    Uuid.prototype._read = function() {
      this.data = new Array(16);
      for (var i = 0; i &lt; 16; i++) {
        this.data[i] = this._io.readU1();
      }
    }

    return Uuid;
  })();

  var Framez = NtMdt.Framez = (function() {
    function Framez(_io, _parent, _root) {
      this._io = _io;
      this._parent = _parent;
      this._root = _root || this;

      this._read();
    }
    Framez.prototype._read = function() {
      this.frames = new Array((this._root.lastFrame + 1));
      for (var i = 0; i &lt; (this._root.lastFrame + 1); i++) {
        this.frames[i] = new Frame(this._io, this, this._root);
      }
    }

    return Framez;
  })();

  var Frame = NtMdt.Frame = (function() {
    Frame.FrameType = Object.freeze({
      SCANNED: 0,
      SPECTROSCOPY: 1,
      TEXT: 3,
      OLD_MDA: 105,
      MDA: 106,
      PALETTE: 107,
      CURVES_NEW: 190,
      CURVES: 201,

      0: &quot;SCANNED&quot;,
      1: &quot;SPECTROSCOPY&quot;,
      3: &quot;TEXT&quot;,
      105: &quot;OLD_MDA&quot;,
      106: &quot;MDA&quot;,
      107: &quot;PALETTE&quot;,
      190: &quot;CURVES_NEW&quot;,
      201: &quot;CURVES&quot;,
    });

    function Frame(_io, _parent, _root) {
      this._io = _io;
      this._parent = _parent;
      this._root = _root || this;

      this._read();
    }
    Frame.prototype._read = function() {
      this.size = this._io.readU4le();
      this._raw_main = this._io.readBytes((this.size - 4));
      var _io__raw_main = new KaitaiStream(this._raw_main);
      this.main = new FrameMain(_io__raw_main, this, this._root);
    }

    var Dots = Frame.Dots = (function() {
      function Dots(_io, _parent, _root) {
        this._io = _io;
        this._parent = _parent;
        this._root = _root || this;

        this._read();
      }
      Dots.prototype._read = function() {
        this.fmNdots = this._io.readU2le();
        if (this.fmNdots &gt; 0) {
          this.coordHeader = new DotsHeader(this._io, this, this._root);
        }
        this.coordinates = new Array(this.fmNdots);
        for (var i = 0; i &lt; this.fmNdots; i++) {
          this.coordinates[i] = new DotsData(this._io, this, this._root);
        }
        this.data = new Array(this.fmNdots);
        for (var i = 0; i &lt; this.fmNdots; i++) {
          this.data[i] = new DataLinez(this._io, this, this._root, i);
        }
      }

      var DotsHeader = Dots.DotsHeader = (function() {
        function DotsHeader(_io, _parent, _root) {
          this._io = _io;
          this._parent = _parent;
          this._root = _root || this;

          this._read();
        }
        DotsHeader.prototype._read = function() {
          this.headerSize = this._io.readS4le();
          this._raw_header = this._io.readBytes(this.headerSize);
          var _io__raw_header = new KaitaiStream(this._raw_header);
          this.header = new Header(_io__raw_header, this, this._root);
        }

        var Header = DotsHeader.Header = (function() {
          function Header(_io, _parent, _root) {
            this._io = _io;
            this._parent = _parent;
            this._root = _root || this;

            this._read();
          }
          Header.prototype._read = function() {
            this.coordSize = this._io.readS4le();
            this.version = this._io.readS4le();
            this.xyunits = this._io.readS2le();
          }

          return Header;
        })();

        return DotsHeader;
      })();

      var DotsData = Dots.DotsData = (function() {
        function DotsData(_io, _parent, _root) {
          this._io = _io;
          this._parent = _parent;
          this._root = _root || this;

          this._read();
        }
        DotsData.prototype._read = function() {
          this.coordX = this._io.readF4le();
          this.coordY = this._io.readF4le();
          this.forwardSize = this._io.readS4le();
          this.backwardSize = this._io.readS4le();
        }

        return DotsData;
      })();

      var DataLinez = Dots.DataLinez = (function() {
        function DataLinez(_io, _parent, _root, index) {
          this._io = _io;
          this._parent = _parent;
          this._root = _root || this;
          this.index = index;

          this._read();
        }
        DataLinez.prototype._read = function() {
          this.forward = new Array(this._parent.coordinates[this.index].forwardSize);
          for (var i = 0; i &lt; this._parent.coordinates[this.index].forwardSize; i++) {
            this.forward[i] = this._io.readS2le();
          }
          this.backward = new Array(this._parent.coordinates[this.index].backwardSize);
          for (var i = 0; i &lt; this._parent.coordinates[this.index].backwardSize; i++) {
            this.backward[i] = this._io.readS2le();
          }
        }

        return DataLinez;
      })();

      return Dots;
    })();

    var FrameMain = Frame.FrameMain = (function() {
      function FrameMain(_io, _parent, _root) {
        this._io = _io;
        this._parent = _parent;
        this._root = _root || this;

        this._read();
      }
      FrameMain.prototype._read = function() {
        this.type = this._io.readU2le();
        this.version = new Version(this._io, this, this._root);
        this.dateTime = new DateTime(this._io, this, this._root);
        this.varSize = this._io.readU2le();
        switch (this.type) {
        case NtMdt.Frame.FrameType.SCANNED:
          this._raw_frameData = this._io.readBytesFull();
          var _io__raw_frameData = new KaitaiStream(this._raw_frameData);
          this.frameData = new FdScanned(_io__raw_frameData, this, this._root);
          break;
        case NtMdt.Frame.FrameType.CURVES_NEW:
          this._raw_frameData = this._io.readBytesFull();
          var _io__raw_frameData = new KaitaiStream(this._raw_frameData);
          this.frameData = new FdCurvesNew(_io__raw_frameData, this, this._root);
          break;
        case NtMdt.Frame.FrameType.MDA:
          this._raw_frameData = this._io.readBytesFull();
          var _io__raw_frameData = new KaitaiStream(this._raw_frameData);
          this.frameData = new FdMetaData(_io__raw_frameData, this, this._root);
          break;
        case NtMdt.Frame.FrameType.SPECTROSCOPY:
          this._raw_frameData = this._io.readBytesFull();
          var _io__raw_frameData = new KaitaiStream(this._raw_frameData);
          this.frameData = new FdSpectroscopy(_io__raw_frameData, this, this._root);
          break;
        case NtMdt.Frame.FrameType.CURVES:
          this._raw_frameData = this._io.readBytesFull();
          var _io__raw_frameData = new KaitaiStream(this._raw_frameData);
          this.frameData = new FdSpectroscopy(_io__raw_frameData, this, this._root);
          break;
        default:
          this.frameData = this._io.readBytesFull();
          break;
        }
      }

      /**
       * h_what
       */

      /**
       * h_am, v6 and older only
       */

      /**
       * 
       */

      return FrameMain;
    })();

    var FdCurvesNew = Frame.FdCurvesNew = (function() {
      function FdCurvesNew(_io, _parent, _root) {
        this._io = _io;
        this._parent = _parent;
        this._root = _root || this;

        this._read();
      }
      FdCurvesNew.prototype._read = function() {
        this.blockCount = this._io.readU4le();
        this.blocksHeaders = new Array(this.blockCount);
        for (var i = 0; i &lt; this.blockCount; i++) {
          this.blocksHeaders[i] = new BlockDescr(this._io, this, this._root);
        }
        this.blocksNames = new Array(this.blockCount);
        for (var i = 0; i &lt; this.blockCount; i++) {
          this.blocksNames[i] = KaitaiStream.bytesToStr(this._io.readBytes(this.blocksHeaders[i].nameLen), &quot;UTF-8&quot;);
        }
        this.blocksData = new Array(this.blockCount);
        for (var i = 0; i &lt; this.blockCount; i++) {
          this.blocksData[i] = this._io.readBytes(this.blocksHeaders[i].len);
        }
      }

      var BlockDescr = FdCurvesNew.BlockDescr = (function() {
        function BlockDescr(_io, _parent, _root) {
          this._io = _io;
          this._parent = _parent;
          this._root = _root || this;

          this._read();
        }
        BlockDescr.prototype._read = function() {
          this.nameLen = this._io.readU4le();
          this.len = this._io.readU4le();
        }

        return BlockDescr;
      })();

      return FdCurvesNew;
    })();

    var FdMetaData = Frame.FdMetaData = (function() {
      function FdMetaData(_io, _parent, _root) {
        this._io = _io;
        this._parent = _parent;
        this._root = _root || this;

        this._read();
      }
      FdMetaData.prototype._read = function() {
        this.headSize = this._io.readU4le();
        this.totLen = this._io.readU4le();
        this.guids = new Array(2);
        for (var i = 0; i &lt; 2; i++) {
          this.guids[i] = new Uuid(this._io, this, this._root);
        }
        this.frameStatus = this._io.readBytes(4);
        this.nameSize = this._io.readU4le();
        this.commSize = this._io.readU4le();
        this.viewInfoSize = this._io.readU4le();
        this.specSize = this._io.readU4le();
        this.sourceInfoSize = this._io.readU4le();
        this.varSize = this._io.readU4le();
        this.dataOffset = this._io.readU4le();
        this.dataSize = this._io.readU4le();
        this.title = KaitaiStream.bytesToStr(this._io.readBytes(this.nameSize), &quot;UTF-8&quot;);
        this.xml = KaitaiStream.bytesToStr(this._io.readBytes(this.commSize), &quot;UTF-8&quot;);
        this.structLen = this._io.readU4le();
        this.arraySize = this._io.readU8le();
        this.cellSize = this._io.readU4le();
        this.nDimensions = this._io.readU4le();
        this.nMesurands = this._io.readU4le();
        this.dimensions = new Array(this.nDimensions);
        for (var i = 0; i &lt; this.nDimensions; i++) {
          this.dimensions[i] = new Calibration(this._io, this, this._root);
        }
        this.mesurands = new Array(this.nMesurands);
        for (var i = 0; i &lt; this.nMesurands; i++) {
          this.mesurands[i] = new Calibration(this._io, this, this._root);
        }
      }

      var Image = FdMetaData.Image = (function() {
        function Image(_io, _parent, _root) {
          this._io = _io;
          this._parent = _parent;
          this._root = _root || this;

          this._read();
        }
        Image.prototype._read = function() {
          this.image = [];
          var i = 0;
          while (!this._io.isEof()) {
            this.image.push(new Vec(this._io, this, this._root));
            i++;
          }
        }

        var Vec = Image.Vec = (function() {
          function Vec(_io, _parent, _root) {
            this._io = _io;
            this._parent = _parent;
            this._root = _root || this;

            this._read();
          }
          Vec.prototype._read = function() {
            this.items = new Array(this._parent._parent.nMesurands);
            for (var i = 0; i &lt; this._parent._parent.nMesurands; i++) {
              switch (this._parent._parent.mesurands[i].dataType) {
              case NtMdt.DataType.UINT8:
                this.items[i] = this._io.readU1();
                break;
              case NtMdt.DataType.INT8:
                this.items[i] = this._io.readS1();
                break;
              case NtMdt.DataType.INT16:
                this.items[i] = this._io.readS2le();
                break;
              case NtMdt.DataType.UINT64:
                this.items[i] = this._io.readU8le();
                break;
              case NtMdt.DataType.FLOAT64:
                this.items[i] = this._io.readF8le();
                break;
              case NtMdt.DataType.INT32:
                this.items[i] = this._io.readS4le();
                break;
              case NtMdt.DataType.FLOAT32:
                this.items[i] = this._io.readF4le();
                break;
              case NtMdt.DataType.UINT16:
                this.items[i] = this._io.readU2le();
                break;
              case NtMdt.DataType.INT64:
                this.items[i] = this._io.readS8le();
                break;
              case NtMdt.DataType.UINT32:
                this.items[i] = this._io.readU4le();
                break;
              }
            }
          }

          return Vec;
        })();

        return Image;
      })();

      var Calibration = FdMetaData.Calibration = (function() {
        function Calibration(_io, _parent, _root) {
          this._io = _io;
          this._parent = _parent;
          this._root = _root || this;

          this._read();
        }
        Calibration.prototype._read = function() {
          this.lenTot = this._io.readU4le();
          this.lenStruct = this._io.readU4le();
          this.lenName = this._io.readU4le();
          this.lenComment = this._io.readU4le();
          this.lenUnit = this._io.readU4le();
          this.siUnit = this._io.readU8le();
          this.accuracy = this._io.readF8le();
          this.functionIdAndDimensions = this._io.readU8le();
          this.bias = this._io.readF8le();
          this.scale = this._io.readF8le();
          this.minIndex = this._io.readU8le();
          this.maxIndex = this._io.readU8le();
          this.dataType = this._io.readS4le();
          this.lenAuthor = this._io.readU4le();
          this.name = KaitaiStream.bytesToStr(this._io.readBytes(this.lenName), &quot;utf-8&quot;);
          this.comment = KaitaiStream.bytesToStr(this._io.readBytes(this.lenComment), &quot;utf-8&quot;);
          this.unit = KaitaiStream.bytesToStr(this._io.readBytes(this.lenUnit), &quot;utf-8&quot;);
          this.author = KaitaiStream.bytesToStr(this._io.readBytes(this.lenAuthor), &quot;utf-8&quot;);
        }
        Object.defineProperty(Calibration.prototype, &#39;count&#39;, {
          get: function() {
            if (this._m_count !== undefined)
              return this._m_count;
            this._m_count = ((this.maxIndex - this.minIndex) + 1);
            return this._m_count;
          }
        });

        return Calibration;
      })();
      Object.defineProperty(FdMetaData.prototype, &#39;image&#39;, {
        get: function() {
          if (this._m_image !== undefined)
            return this._m_image;
          var _pos = this._io.pos;
          this._io.seek(this.dataOffset);
          this._raw__m_image = this._io.readBytes(this.dataSize);
          var _io__raw__m_image = new KaitaiStream(this._raw__m_image);
          this._m_image = new Image(_io__raw__m_image, this, this._root);
          this._io.seek(_pos);
          return this._m_image;
        }
      });

      return FdMetaData;
    })();

    var FdSpectroscopy = Frame.FdSpectroscopy = (function() {
      function FdSpectroscopy(_io, _parent, _root) {
        this._io = _io;
        this._parent = _parent;
        this._root = _root || this;

        this._read();
      }
      FdSpectroscopy.prototype._read = function() {
        this._raw_vars = this._io.readBytes(this._parent.varSize);
        var _io__raw_vars = new KaitaiStream(this._raw_vars);
        this.vars = new Vars(_io__raw_vars, this, this._root);
        this.fmMode = this._io.readU2le();
        this.fmXres = this._io.readU2le();
        this.fmYres = this._io.readU2le();
        this.dots = new Dots(this._io, this, this._root);
        this.data = new Array((this.fmXres * this.fmYres));
        for (var i = 0; i &lt; (this.fmXres * this.fmYres); i++) {
          this.data[i] = this._io.readS2le();
        }
        this.title = new Title(this._io, this, this._root);
        this.xml = new Xml(this._io, this, this._root);
      }

      var Vars = FdSpectroscopy.Vars = (function() {
        function Vars(_io, _parent, _root) {
          this._io = _io;
          this._parent = _parent;
          this._root = _root || this;

          this._read();
        }
        Vars.prototype._read = function() {
          this.xScale = new AxisScale(this._io, this, this._root);
          this.yScale = new AxisScale(this._io, this, this._root);
          this.zScale = new AxisScale(this._io, this, this._root);
          this.spMode = this._io.readU2le();
          this.spFilter = this._io.readU2le();
          this.uBegin = this._io.readF4le();
          this.uEnd = this._io.readF4le();
          this.zUp = this._io.readS2le();
          this.zDown = this._io.readS2le();
          this.spAveraging = this._io.readU2le();
          this.spRepeat = this._io.readU1();
          this.spBack = this._io.readU1();
          this.sp4nx = this._io.readS2le();
          this.spOsc = this._io.readU1();
          this.spN4 = this._io.readU1();
          this.sp4x0 = this._io.readF4le();
          this.sp4xr = this._io.readF4le();
          this.sp4u = this._io.readS2le();
          this.sp4i = this._io.readS2le();
          this.spNx = this._io.readS2le();
        }

        return Vars;
      })();

      return FdSpectroscopy;
    })();

    var DateTime = Frame.DateTime = (function() {
      function DateTime(_io, _parent, _root) {
        this._io = _io;
        this._parent = _parent;
        this._root = _root || this;

        this._read();
      }
      DateTime.prototype._read = function() {
        this.date = new Date(this._io, this, this._root);
        this.time = new Time(this._io, this, this._root);
      }

      var Date = DateTime.Date = (function() {
        function Date(_io, _parent, _root) {
          this._io = _io;
          this._parent = _parent;
          this._root = _root || this;

          this._read();
        }
        Date.prototype._read = function() {
          this.year = this._io.readU2le();
          this.month = this._io.readU2le();
          this.day = this._io.readU2le();
        }

        /**
         * h_yea
         */

        /**
         * h_mon
         */

        /**
         * h_day
         */

        return Date;
      })();

      var Time = DateTime.Time = (function() {
        function Time(_io, _parent, _root) {
          this._io = _io;
          this._parent = _parent;
          this._root = _root || this;

          this._read();
        }
        Time.prototype._read = function() {
          this.hour = this._io.readU2le();
          this.min = this._io.readU2le();
          this.sec = this._io.readU2le();
        }

        /**
         * h_h
         */

        /**
         * h_m
         */

        /**
         * h_s
         */

        return Time;
      })();

      return DateTime;
    })();

    var AxisScale = Frame.AxisScale = (function() {
      function AxisScale(_io, _parent, _root) {
        this._io = _io;
        this._parent = _parent;
        this._root = _root || this;

        this._read();
      }
      AxisScale.prototype._read = function() {
        this.offset = this._io.readF4le();
        this.step = this._io.readF4le();
        this.unit = this._io.readS2le();
      }

      /**
       * x_scale-&gt;offset = gwy_get_gfloat_le(&amp;p);# r0 (physical units)
       */

      /**
       * x_scale-&gt;step = gwy_get_gfloat_le(&amp;p); r (physical units) x_scale-&gt;step = fabs(x_scale-&gt;step); if (!x_scale-&gt;step) {
       *   g_warning(&quot;x_scale.step == 0, changing to 1&quot;);
       *   x_scale-&gt;step = 1.0;
       * }
       */

      /**
       * U
       */

      return AxisScale;
    })();

    var FdScanned = Frame.FdScanned = (function() {
      FdScanned.Mode = Object.freeze({
        STM: 0,
        AFM: 1,
        UNKNOWN2: 2,
        UNKNOWN3: 3,
        UNKNOWN4: 4,

        0: &quot;STM&quot;,
        1: &quot;AFM&quot;,
        2: &quot;UNKNOWN2&quot;,
        3: &quot;UNKNOWN3&quot;,
        4: &quot;UNKNOWN4&quot;,
      });

      FdScanned.InputSignal = Object.freeze({
        EXTENSION_SLOT: 0,
        BIAS_V: 1,
        GROUND: 2,

        0: &quot;EXTENSION_SLOT&quot;,
        1: &quot;BIAS_V&quot;,
        2: &quot;GROUND&quot;,
      });

      FdScanned.LiftMode = Object.freeze({
        STEP: 0,
        FINE: 1,
        SLOPE: 2,

        0: &quot;STEP&quot;,
        1: &quot;FINE&quot;,
        2: &quot;SLOPE&quot;,
      });

      function FdScanned(_io, _parent, _root) {
        this._io = _io;
        this._parent = _parent;
        this._root = _root || this;

        this._read();
      }
      FdScanned.prototype._read = function() {
        this._raw_vars = this._io.readBytes(this._parent.varSize);
        var _io__raw_vars = new KaitaiStream(this._raw_vars);
        this.vars = new Vars(_io__raw_vars, this, this._root);
        if (false) {
          this.origFormat = this._io.readU4le();
        }
        if (false) {
          this.tune = this._io.readU4le();
        }
        if (false) {
          this.feedbackGain = this._io.readF8le();
        }
        if (false) {
          this.dacScale = this._io.readS4le();
        }
        if (false) {
          this.overscan = this._io.readS4le();
        }
        this.fmMode = this._io.readU2le();
        this.fmXres = this._io.readU2le();
        this.fmYres = this._io.readU2le();
        this.dots = new Dots(this._io, this, this._root);
        this.image = new Array((this.fmXres * this.fmYres));
        for (var i = 0; i &lt; (this.fmXres * this.fmYres); i++) {
          this.image[i] = this._io.readS2le();
        }
        this.title = new Title(this._io, this, this._root);
        this.xml = new Xml(this._io, this, this._root);
      }

      var Vars = FdScanned.Vars = (function() {
        function Vars(_io, _parent, _root) {
          this._io = _io;
          this._parent = _parent;
          this._root = _root || this;

          this._read();
        }
        Vars.prototype._read = function() {
          this.xScale = new AxisScale(this._io, this, this._root);
          this.yScale = new AxisScale(this._io, this, this._root);
          this.zScale = new AxisScale(this._io, this, this._root);
          this.channelIndex = this._io.readU1();
          this.mode = this._io.readU1();
          this.xres = this._io.readU2le();
          this.yres = this._io.readU2le();
          this.ndacq = this._io.readU2le();
          this.stepLength = this._io.readF4le();
          this.adt = this._io.readU2le();
          this.adcGainAmpLog10 = this._io.readU1();
          this.adcIndex = this._io.readU1();
          this.inputSignalOrVersion = this._io.readU1();
          this.substrPlaneOrderOrPassNum = this._io.readU1();
          this.scanDir = new ScanDir(this._io, this, this._root);
          this.powerOf2 = this._io.readU1();
          this.velocity = this._io.readF4le();
          this.setpoint = this._io.readF4le();
          this.biasVoltage = this._io.readF4le();
          this.draw = this._io.readU1();
          this.reserved = this._io.readU1();
          this.xoff = this._io.readS4le();
          this.yoff = this._io.readS4le();
          this.nlCorr = this._io.readU1();
        }

        /**
         * s_mode
         */

        /**
         * s_dev
         */

        /**
         * s_nx
         */

        /**
         * s_ny
         */

        /**
         * Step (DAC)
         */

        /**
         * s_rs in Angstrom&#39;s (Angstrom*gwy_get_gfloat_le(&amp;p))
         */

        /**
         * s_adt
         */

        /**
         * s_adc_a
         */

        /**
         * ADC index
         */

        /**
         * MDTInputSignal smp_in; s_smp_in (for signal) s_8xx (for version)
         */

        /**
         * s_spl or z_03
         */

        /**
         * s_xy TODO: interpretation
         */

        /**
         * s_2n (bool)
         */

        /**
         * s_vel (Angstrom/second)
         */

        /**
         * s_i0
         */

        /**
         * s_ut
         */

        /**
         * s_draw (bool)
         */

        /**
         * s_x00 (in DAC quants)
         */

        /**
         * s_y00 (in DAC quants)
         */

        /**
         * s_cor (bool)
         */

        return Vars;
      })();

      var Dot = FdScanned.Dot = (function() {
        function Dot(_io, _parent, _root) {
          this._io = _io;
          this._parent = _parent;
          this._root = _root || this;

          this._read();
        }
        Dot.prototype._read = function() {
          this.x = this._io.readS2le();
          this.y = this._io.readS2le();
        }

        return Dot;
      })();

      var ScanDir = FdScanned.ScanDir = (function() {
        function ScanDir(_io, _parent, _root) {
          this._io = _io;
          this._parent = _parent;
          this._root = _root || this;

          this._read();
        }
        ScanDir.prototype._read = function() {
          this.unkn = this._io.readBitsInt(4);
          this.doublePass = this._io.readBitsInt(1) != 0;
          this.bottom = this._io.readBitsInt(1) != 0;
          this.left = this._io.readBitsInt(1) != 0;
          this.horizontal = this._io.readBitsInt(1) != 0;
        }

        /**
         * Bottom - 1 Top - 0
         */

        /**
         * Left - 1 Right - 0
         */

        /**
         * Horizontal - 1 Vertical - 0
         */

        return ScanDir;
      })();

      /**
       * s_oem
       */

      /**
       * z_tune
       */

      /**
       * s_fbg
       */

      /**
       * s_s
       */

      /**
       * s_xov (in %)
       */

      /**
       * m_mode
       */

      /**
       * m_nx
       */

      /**
       * m_ny
       */

      return FdScanned;
    })();

    /**
     * h_sz
     */

    return Frame;
  })();

  var Version = NtMdt.Version = (function() {
    function Version(_io, _parent, _root) {
      this._io = _io;
      this._parent = _parent;
      this._root = _root || this;

      this._read();
    }
    Version.prototype._read = function() {
      this.minor = this._io.readU1();
      this.major = this._io.readU1();
    }

    return Version;
  })();

  var Xml = NtMdt.Xml = (function() {
    function Xml(_io, _parent, _root) {
      this._io = _io;
      this._parent = _parent;
      this._root = _root || this;

      this._read();
    }
    Xml.prototype._read = function() {
      this.xmlLen = this._io.readU4le();
      this.xml = KaitaiStream.bytesToStr(this._io.readBytes(this.xmlLen), &quot;UTF-16LE&quot;);
    }

    return Xml;
  })();

  var Title = NtMdt.Title = (function() {
    function Title(_io, _parent, _root) {
      this._io = _io;
      this._parent = _parent;
      this._root = _root || this;

      this._read();
    }
    Title.prototype._read = function() {
      this.titleLen = this._io.readU4le();
      this.title = KaitaiStream.bytesToStr(this._io.readBytes(this.titleLen), &quot;cp1251&quot;);
    }

    return Title;
  })();

  /**
   * File size (w/o header)
   */

  /**
   * documentation specifies 32 bytes long header, but zeroth frame starts at 33th byte in reality
   */

  return NtMdt;
})();
return NtMdt;
}));
</code></pre>
            
        </div>
        
    </div>
</section>

    <footer id="main-footer">
        <div class="container">
            &copy; 2015-2018 Kaitai Project and <a href="https://github.com/kaitai-io/kaitai_struct_formats/graphs/contributors">formats repo contributors</a>

            <h3>Contacts</h3>

            <div class="row">
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-github"></i> <a href="https://github.com/kaitai-io/kaitai_struct">GitHub</a>
                </div>
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-twitter"></i> <a href="https://twitter.com/kaitai_io">@kaitai_io</a>
                </div>
                <div class="col-sm-4">
                    Gitter: <a href="https://gitter.im/kaitai_struct/Lobby">kaitai_struct</a>
                </div>
            </div>
        </div>
    </footer>

  <script src="http://kaitai.io/js/jquery-1.12.3.min.js"></script>
  <script src="http://kaitai.io/js/bootstrap.min.js"></script>

  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-76299550-1', 'auto');
      ga('send', 'pageview');
  </script>
</body>
</html>
