<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>utf8_string: Java parsing library</title>
  <meta name="keywords" content="kaitai,struct,binary,format,parsing,decoding,java,javascript,python,ruby,library,metadata">
  <meta name="description" content="Kaitai Struct is a formal language for binary format specification that can be compiled into parser code">

  <link rel="stylesheet" href="//kaitai.io/styles/bootstrap.min.css">
  <link rel="stylesheet" href="//kaitai.io/styles/bootstrap-theme.min.css">
  <link href='https://fonts.googleapis.com/css?family=Exo:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Share+Tech+Mono' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  <link rel="stylesheet" href="//kaitai.io/styles/main.css" type="text/css">

  <link rel="stylesheet" href="//kaitai.io/styles/highlight/default.css">
  <style>
.diagram-img {
    display: block;
    max-width: 100%;
    height: auto;
    margin: 0 auto;
}

section.format {
    padding: 30px 0;
}

section#format-meta, section#format-index-header {
    background: #e3eef7;
}

section#format-diagram, section#format-index-footer {
    background: #e9f8dd;
}

section#format-ksy, section#format-lang {
    background: #d1eadd;
}

section#format-index .row {
    padding-bottom: 10px;
}

  </style>
  <script src="//kaitai.io/js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>
<body data-spy="scroll" data-target="#main-navbar" data-offset="100">

    <nav class="navbar navbar-inverse navbar-fixed-top" id="main-navbar">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-navbar-collapse" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <span class="navbar-brand">Kaitai Struct</span>
            </div>
            <div class="collapse navbar-collapse" id="main-navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="http://kaitai.io/#what-is-it">What is it?</a></li>
                    <li><a href="http://kaitai.io/#quick-start">Quick Start</a></li>
                    <li><a href="http://kaitai.io/#download">Download</a></li>
                    <li class="active"><a href="http://formats.kaitai.io/">Format Gallery</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="http://kaitai.io/repl/index.html">Try it</a></li>
                    <li><a href="https://ide.kaitai.io/">Web IDE</a></li>
                    <li><a href="http://doc.kaitai.io/">Documentation</a></li>
                </ul>
            </div>
        </div>
    </nav>
<nav>
    <div class="container">
    <ol class="breadcrumb">
        <li><a href="../index.html">Format Gallery</a></li>
        <li>Commonly Used Data Types</li>
        <li class="active">utf8_string</li>
    </ol>
    </div>
</nav>

<section id="format-meta" class="format">
    <div class="container">
        <h1>utf8_string:
            
            Java parsing library
            
        </h1>

        <div class="row">
            <div class="col-md-8">
                <p><p>UTF-8 is a popular character encoding schemes that allows to represent
code points defined in Unicode standard. Its features are:</p>
<ul>
<li>variable width (i.e. one code point might be represented by 1 to 4
bytes)</li>
<li>backward compatiblity with ASCII</li>
<li>basic validity checking (and thus distinguishing from other legacy
8-bit encodings)</li>
<li>maintaining sort order of codepoints if sorted as a byte array</li>
</ul>
<p>WARNING: For vast majority of practical purposes of format definitions
in Kaitai Struct, you'd likely note want to use this and rather just
use <code>type: str</code> with <code>encoding: utf8</code>. That will use native string
implementations, which are most likely more efficient and will give you
native language strings, rather than an array of individual codepoints.
This format definition is provided mostly for educational / research
purposes.</p>
</p>
            </div>
            <div class="col-md-4">
                <div class="panel panel-info">
                    
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">KS implementation details</h3>
                    </div>
                    
                    <div class="panel-body">
                        License: <a href="https://spdx.org/licenses/CC0-1.0.html">CC0-1.0</a>
                    </div>
                    
                    
                    
                    
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
            <p>
            This page hosts a formal specification of utf8_string
            using <a href="http://kaitai.io">Kaitai Struct</a>. This
            specification can be automatically translated into a
            variety of programming languages to get a parsing library.
            </p>

            <ul class="nav nav-pills">
                
                
                <li>
                
                <a href="index.html" title="utf8_string parsing Overview library">Overview</a></li>
                
                
                <li>
                
                <a href="cpp_stl.html" title="utf8_string parsing C++/STL library">C++/STL</a></li>
                
                
                <li>
                
                <a href="csharp.html" title="utf8_string parsing C# library">C#</a></li>
                
                
                <li>
                
                <a href="graphviz.html" title="utf8_string parsing GraphViz library">GraphViz</a></li>
                
                
                <li class="active">
                
                <a href="java.html" title="utf8_string parsing Java library">Java</a></li>
                
                
                <li>
                
                <a href="javascript.html" title="utf8_string parsing JavaScript library">JavaScript</a></li>
                
                
                <li>
                
                <a href="lua.html" title="utf8_string parsing Lua library">Lua</a></li>
                
                
                <li>
                
                <a href="perl.html" title="utf8_string parsing Perl library">Perl</a></li>
                
                
                <li>
                
                <a href="php.html" title="utf8_string parsing PHP library">PHP</a></li>
                
                
                <li>
                
                <a href="python.html" title="utf8_string parsing Python library">Python</a></li>
                
                
                <li>
                
                <a href="ruby.html" title="utf8_string parsing Ruby library">Ruby</a></li>
                
            </ul>
            </div>
        </div>
    </div>
</section>

<section id="format-usage" class="format">
    <div class="container">
        <h2>Usage</h2>

        <p>Parse a local file and get structure in memory:</p>



<pre><code class="java">Utf8String data = Utf8String.fromFile("path/to/local/file.utf8_string");</code></pre>

<p>Or parse structure from a byte array:</p>

<pre><code class="java">byte[] someArray = new byte[] { ... };
Utf8String data = new Utf8String(new ByteBufferKaitaiStream(someArray));</code></pre>

<p>After that, one can get various attributes from the structure by invoking getter methods like:</p>

<pre><code class="java">data.codepoints() // => get codepoints</code></pre>

    </div>
</section>


<section id="format-lang" class="format">
    <div class="container">
        <h2>
            
            Java source code to parse utf8_string
            
        </h2>

        

        <h3>Utf8String.java</h3>

        <div class="row">
            <div class="pull-right">
                <p>
                    <a href="src/java/Utf8String.java" class="btn btn-success">Download <i class="fa fa-download"></i></a>
                </p>
            </div>
        </div>

        <div class="row">
            <pre><code class="java">// This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild

import io.kaitai.struct.ByteBufferKaitaiStream;
import io.kaitai.struct.KaitaiStruct;
import io.kaitai.struct.KaitaiStream;
import java.io.IOException;
import java.util.ArrayList;


/**
 * UTF-8 is a popular character encoding schemes that allows to represent
 * code points defined in Unicode standard. Its features are:
 * 
 * * variable width (i.e. one code point might be represented by 1 to 4
 *   bytes)
 * * backward compatiblity with ASCII
 * * basic validity checking (and thus distinguishing from other legacy
 *   8-bit encodings)
 * * maintaining sort order of codepoints if sorted as a byte array
 * 
 * WARNING: For vast majority of practical purposes of format definitions
 * in Kaitai Struct, you&#39;d likely note want to use this and rather just
 * use `type: str` with `encoding: utf8`. That will use native string
 * implementations, which are most likely more efficient and will give you
 * native language strings, rather than an array of individual codepoints.
 * This format definition is provided mostly for educational / research
 * purposes.
 */
public class Utf8String extends KaitaiStruct {
    public static Utf8String fromFile(String fileName) throws IOException {
        return new Utf8String(new ByteBufferKaitaiStream(fileName));
    }

    public Utf8String(KaitaiStream _io) {
        this(_io, null, null);
    }

    public Utf8String(KaitaiStream _io, KaitaiStruct _parent) {
        this(_io, _parent, null);
    }

    public Utf8String(KaitaiStream _io, KaitaiStruct _parent, Utf8String _root) {
        super(_io);
        this._parent = _parent;
        this._root = _root == null ? this : _root;
        _read();
    }
    private void _read() {
        this.codepoints = new ArrayList&lt;Utf8Codepoint&gt;();
        {
            int i = 0;
            while (!this._io.isEof()) {
                this.codepoints.add(new Utf8Codepoint(this._io, this, _root));
                i++;
            }
        }
    }
    public static class Utf8Codepoint extends KaitaiStruct {
        public static Utf8Codepoint fromFile(String fileName) throws IOException {
            return new Utf8Codepoint(new ByteBufferKaitaiStream(fileName));
        }

        public Utf8Codepoint(KaitaiStream _io) {
            this(_io, null, null);
        }

        public Utf8Codepoint(KaitaiStream _io, Utf8String _parent) {
            this(_io, _parent, null);
        }

        public Utf8Codepoint(KaitaiStream _io, Utf8String _parent, Utf8String _root) {
            super(_io);
            this._parent = _parent;
            this._root = _root;
            _read();
        }
        private void _read() {
            this.byte1 = this._io.readU1();
            if (len() &gt;= 2) {
                this.byte2 = this._io.readU1();
            }
            if (len() &gt;= 3) {
                this.byte3 = this._io.readU1();
            }
            if (len() &gt;= 4) {
                this.byte4 = this._io.readU1();
            }
        }
        private Integer raw1;
        public Integer raw1() {
            if (this.raw1 != null)
                return this.raw1;
            int _tmp = (int) ((byte1() &amp; (len() == 1 ? 127 : (len() == 2 ? 31 : (len() == 3 ? 15 : (len() == 4 ? 7 : 0))))));
            this.raw1 = _tmp;
            return this.raw1;
        }
        private Integer raw4;
        public Integer raw4() {
            if (this.raw4 != null)
                return this.raw4;
            if (len() &gt;= 4) {
                int _tmp = (int) ((byte4() &amp; 63));
                this.raw4 = _tmp;
            }
            return this.raw4;
        }
        private Integer raw3;
        public Integer raw3() {
            if (this.raw3 != null)
                return this.raw3;
            if (len() &gt;= 3) {
                int _tmp = (int) ((byte3() &amp; 63));
                this.raw3 = _tmp;
            }
            return this.raw3;
        }
        private Integer valueAsInt;
        public Integer valueAsInt() {
            if (this.valueAsInt != null)
                return this.valueAsInt;
            int _tmp = (int) ((len() == 1 ? raw1() : (len() == 2 ? ((raw1() &lt;&lt; 6) | raw2()) : (len() == 3 ? (((raw1() &lt;&lt; 12) | (raw2() &lt;&lt; 6)) | raw3()) : (len() == 4 ? ((((raw1() &lt;&lt; 18) | (raw2() &lt;&lt; 12)) | (raw3() &lt;&lt; 6)) | raw4()) : -1)))));
            this.valueAsInt = _tmp;
            return this.valueAsInt;
        }
        private Integer raw2;
        public Integer raw2() {
            if (this.raw2 != null)
                return this.raw2;
            if (len() &gt;= 2) {
                int _tmp = (int) ((byte2() &amp; 63));
                this.raw2 = _tmp;
            }
            return this.raw2;
        }
        private Integer len;
        public Integer len() {
            if (this.len != null)
                return this.len;
            int _tmp = (int) (((byte1() &amp; 128) == 0 ? 1 : ((byte1() &amp; 224) == 192 ? 2 : ((byte1() &amp; 240) == 224 ? 3 : ((byte1() &amp; 248) == 240 ? 4 : -1)))));
            this.len = _tmp;
            return this.len;
        }
        private int byte1;
        private Integer byte2;
        private Integer byte3;
        private Integer byte4;
        private Utf8String _root;
        private Utf8String _parent;
        public int byte1() { return byte1; }
        public Integer byte2() { return byte2; }
        public Integer byte3() { return byte3; }
        public Integer byte4() { return byte4; }
        public Utf8String _root() { return _root; }
        public Utf8String _parent() { return _parent; }
    }
    private ArrayList&lt;Utf8Codepoint&gt; codepoints;
    private Utf8String _root;
    private KaitaiStruct _parent;
    public ArrayList&lt;Utf8Codepoint&gt; codepoints() { return codepoints; }
    public Utf8String _root() { return _root; }
    public KaitaiStruct _parent() { return _parent; }
}
</code></pre>
            
        </div>
        
    </div>
</section>

    <footer id="main-footer">
        <div class="container">
            &copy; 2015-2019 Kaitai Project and <a href="https://github.com/kaitai-io/kaitai_struct_formats/graphs/contributors">formats repo contributors</a>

            <h3>Contacts</h3>

            <div class="row">
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-github"></i> <a href="https://github.com/kaitai-io/kaitai_struct">GitHub</a>
                </div>
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-twitter"></i> <a href="https://twitter.com/kaitai_io">@kaitai_io</a>
                </div>
                <div class="col-sm-4">
                    Gitter: <a href="https://gitter.im/kaitai_struct/Lobby">kaitai_struct</a>
                </div>
            </div>
        </div>
    </footer>

  <script src="//kaitai.io/js/jquery-1.12.3.min.js"></script>
  <script src="//kaitai.io/js/bootstrap.min.js"></script>

  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-76299550-1', 'auto');
      ga('send', 'pageview');
  </script>
</body>
</html>
