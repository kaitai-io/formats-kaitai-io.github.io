<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>protocol_body: PHP parsing library</title>
  <meta name="keywords" content="kaitai,struct,binary,format,parsing,decoding,java,javascript,python,ruby,library,metadata">
  <meta name="description" content="Kaitai Struct is a formal language for binary format specification that can be compiled into parser code">

  <link rel="stylesheet" href="//kaitai.io/styles/bootstrap.min.css">
  <link rel="stylesheet" href="//kaitai.io/styles/bootstrap-theme.min.css">
  <link href='https://fonts.googleapis.com/css?family=Exo:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Share+Tech+Mono' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  <link rel="stylesheet" href="//kaitai.io/styles/main.css" type="text/css">

  <link rel="stylesheet" href="//kaitai.io/styles/highlight/default.css">
  <style>
.diagram-img {
    display: block;
    max-width: 100%;
    height: auto;
    margin: 0 auto;
}

section.format {
    padding: 30px 0;
}

section#format-meta, section#format-index-header {
    background: #e3eef7;
}

section#format-diagram, section#format-index-footer {
    background: #e9f8dd;
}

section#format-ksy, section#format-lang {
    background: #d1eadd;
}

section#format-index .row {
    padding-bottom: 10px;
}

  </style>
  <script src="//kaitai.io/js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>
<body data-spy="scroll" data-target="#main-navbar" data-offset="100">

    <nav class="navbar navbar-inverse navbar-fixed-top" id="main-navbar">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-navbar-collapse" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <span class="navbar-brand">Kaitai Struct</span>
            </div>
            <div class="collapse navbar-collapse" id="main-navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="http://kaitai.io/#what-is-it">What is it?</a></li>
                    <li><a href="http://kaitai.io/#quick-start">Quick Start</a></li>
                    <li><a href="http://kaitai.io/#download">Download</a></li>
                    <li class="active"><a href="http://formats.kaitai.io/">Format Gallery</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="http://kaitai.io/repl/index.html">Try it</a></li>
                    <li><a href="https://ide.kaitai.io/">Web IDE</a></li>
                    <li><a href="http://doc.kaitai.io/">Documentation</a></li>
                </ul>
            </div>
        </div>
    </nav>
<nav>
    <div class="container">
    <ol class="breadcrumb">
        <li><a href="../index.html">Format Gallery</a></li>
        <li>Networking Protocols</li>
        <li class="active">protocol_body</li>
    </ol>
    </div>
</nav>

<section id="format-meta" class="format">
    <div class="container">
        <h1>protocol_body:
            
            PHP parsing library
            
        </h1>

        <div class="row">
            <div class="col-md-8">
                <p><p>Protocol body represents particular payload on transport level (OSI
layer 4).</p>
<p>Typically this payload in encapsulated into network level (OSI layer
3) packet, which includes &quot;protocol number&quot; field that would be used
to decide what's inside the payload and how to parse it. Thanks to
IANA's standardization effort, multiple network level use the same
IDs for these payloads named &quot;protocol numbers&quot;.</p>
<p>This is effectively a &quot;router&quot; type: it expects to get protocol
number as a parameter, and then invokes relevant type parser based
on that parameter.</p>
</p>
            </div>
            <div class="col-md-4">
                <div class="panel panel-info">
                    
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">KS implementation details</h3>
                    </div>
                    
                    <div class="panel-body">
                        License: <a href="https://spdx.org/licenses/CC0-1.0.html">CC0-1.0</a>
                    </div>
                    
                    
                    <div class="panel-body">
                        Minimal Kaitai Struct required: 0.8
                    </div>
                    
                    
                    
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
            <p>
            This page hosts a formal specification of protocol_body
            using <a href="http://kaitai.io">Kaitai Struct</a>. This
            specification can be automatically translated into a
            variety of programming languages to get a parsing library.
            </p>

            <ul class="nav nav-pills">
                
                
                <li>
                
                <a href="index.html" title="protocol_body parsing Overview library">Overview</a></li>
                
                
                <li>
                
                <a href="cpp_stl.html" title="protocol_body parsing C++/STL library">C++/STL</a></li>
                
                
                <li>
                
                <a href="csharp.html" title="protocol_body parsing C# library">C#</a></li>
                
                
                <li>
                
                <a href="graphviz.html" title="protocol_body parsing GraphViz library">GraphViz</a></li>
                
                
                <li>
                
                <a href="java.html" title="protocol_body parsing Java library">Java</a></li>
                
                
                <li>
                
                <a href="javascript.html" title="protocol_body parsing JavaScript library">JavaScript</a></li>
                
                
                <li>
                
                <a href="lua.html" title="protocol_body parsing Lua library">Lua</a></li>
                
                
                <li>
                
                <a href="perl.html" title="protocol_body parsing Perl library">Perl</a></li>
                
                
                <li class="active">
                
                <a href="php.html" title="protocol_body parsing PHP library">PHP</a></li>
                
                
                <li>
                
                <a href="python.html" title="protocol_body parsing Python library">Python</a></li>
                
                
                <li>
                
                <a href="ruby.html" title="protocol_body parsing Ruby library">Ruby</a></li>
                
            </ul>
            </div>
        </div>
    </div>
</section>


<section id="format-lang" class="format">
    <div class="container">
        <h2>
            
            PHP source code to parse protocol_body
            
        </h2>

        

        <h3>ProtocolBody.php</h3>

        <div class="row">
            <div class="pull-right">
                <p>
                    <a href="src/php/ProtocolBody.php" class="btn btn-success">Download <i class="fa fa-download"></i></a>
                </p>
            </div>
        </div>

        <div class="row">
            <pre><code class="php">&lt;?php
// This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild

/**
 * Protocol body represents particular payload on transport level (OSI
 * layer 4).
 * 
 * Typically this payload in encapsulated into network level (OSI layer
 * 3) packet, which includes &quot;protocol number&quot; field that would be used
 * to decide what&#39;s inside the payload and how to parse it. Thanks to
 * IANA&#39;s standardization effort, multiple network level use the same
 * IDs for these payloads named &quot;protocol numbers&quot;.
 * 
 * This is effectively a &quot;router&quot; type: it expects to get protocol
 * number as a parameter, and then invokes relevant type parser based
 * on that parameter.
 */

class ProtocolBody extends \Kaitai\Struct\Struct {
    public function __construct(int $protocolNum, \Kaitai\Struct\Stream $_io, \Kaitai\Struct\Struct $_parent = null, \ProtocolBody $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_m_protocolNum = $protocolNum;
        $this-&gt;_read();
    }

    private function _read() {
        switch ($this-&gt;protocol()) {
            case \ProtocolBody\ProtocolEnum::TCP:
                $this-&gt;_m_body = new \TcpSegment($this-&gt;_io);
                break;
            case \ProtocolBody\ProtocolEnum::IPV6_NONXT:
                $this-&gt;_m_body = new \ProtocolBody\NoNextHeader($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \ProtocolBody\ProtocolEnum::ICMP:
                $this-&gt;_m_body = new \IcmpPacket($this-&gt;_io);
                break;
            case \ProtocolBody\ProtocolEnum::UDP:
                $this-&gt;_m_body = new \UdpDatagram($this-&gt;_io);
                break;
            case \ProtocolBody\ProtocolEnum::HOPOPT:
                $this-&gt;_m_body = new \ProtocolBody\OptionHopByHop($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \ProtocolBody\ProtocolEnum::IPV6:
                $this-&gt;_m_body = new \Ipv6Packet($this-&gt;_io);
                break;
            case \ProtocolBody\ProtocolEnum::IPV4:
                $this-&gt;_m_body = new \Ipv4Packet($this-&gt;_io);
                break;
        }
    }
    protected $_m_protocol;
    public function protocol() {
        if ($this-&gt;_m_protocol !== null)
            return $this-&gt;_m_protocol;
        $this-&gt;_m_protocol = $this-&gt;protocolNum();
        return $this-&gt;_m_protocol;
    }
    protected $_m_body;
    protected $_m_protocolNum;
    public function body() { return $this-&gt;_m_body; }

    /**
     * Protocol number as an integer.
     */
    public function protocolNum() { return $this-&gt;_m_protocolNum; }
}

/**
 * Dummy type for IPv6 &quot;no next header&quot; type, which signifies end of headers chain.
 */

namespace \ProtocolBody;

class NoNextHeader extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \ProtocolBody $_parent = null, \ProtocolBody $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
    }
}

namespace \ProtocolBody;

class OptionHopByHop extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \ProtocolBody $_parent = null, \ProtocolBody $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_nextHeaderType = $this-&gt;_io-&gt;readU1();
        $this-&gt;_m_hdrExtLen = $this-&gt;_io-&gt;readU1();
        $this-&gt;_m_body = $this-&gt;_io-&gt;readBytes(($this-&gt;hdrExtLen() - 1));
        $this-&gt;_m_nextHeader = new \ProtocolBody($this-&gt;nextHeaderType(), $this-&gt;_io);
    }
    protected $_m_nextHeaderType;
    protected $_m_hdrExtLen;
    protected $_m_body;
    protected $_m_nextHeader;
    public function nextHeaderType() { return $this-&gt;_m_nextHeaderType; }
    public function hdrExtLen() { return $this-&gt;_m_hdrExtLen; }
    public function body() { return $this-&gt;_m_body; }
    public function nextHeader() { return $this-&gt;_m_nextHeader; }
}

namespace \ProtocolBody;

class ProtocolEnum {
    const HOPOPT = 0;
    const ICMP = 1;
    const IGMP = 2;
    const GGP = 3;
    const IPV4 = 4;
    const ST = 5;
    const TCP = 6;
    const CBT = 7;
    const EGP = 8;
    const IGP = 9;
    const BBN_RCC_MON = 10;
    const NVP_II = 11;
    const PUP = 12;
    const ARGUS = 13;
    const EMCON = 14;
    const XNET = 15;
    const CHAOS = 16;
    const UDP = 17;
    const MUX = 18;
    const DCN_MEAS = 19;
    const HMP = 20;
    const PRM = 21;
    const XNS_IDP = 22;
    const TRUNK_1 = 23;
    const TRUNK_2 = 24;
    const LEAF_1 = 25;
    const LEAF_2 = 26;
    const RDP = 27;
    const IRTP = 28;
    const ISO_TP4 = 29;
    const NETBLT = 30;
    const MFE_NSP = 31;
    const MERIT_INP = 32;
    const DCCP = 33;
    const X_3PC = 34;
    const IDPR = 35;
    const XTP = 36;
    const DDP = 37;
    const IDPR_CMTP = 38;
    const TP_PLUS_PLUS = 39;
    const IL = 40;
    const IPV6 = 41;
    const SDRP = 42;
    const IPV6_ROUTE = 43;
    const IPV6_FRAG = 44;
    const IDRP = 45;
    const RSVP = 46;
    const GRE = 47;
    const DSR = 48;
    const BNA = 49;
    const ESP = 50;
    const AH = 51;
    const I_NLSP = 52;
    const SWIPE = 53;
    const NARP = 54;
    const MOBILE = 55;
    const TLSP = 56;
    const SKIP = 57;
    const IPV6_ICMP = 58;
    const IPV6_NONXT = 59;
    const IPV6_OPTS = 60;
    const ANY_HOST_INTERNAL_PROTOCOL = 61;
    const CFTP = 62;
    const ANY_LOCAL_NETWORK = 63;
    const SAT_EXPAK = 64;
    const KRYPTOLAN = 65;
    const RVD = 66;
    const IPPC = 67;
    const ANY_DISTRIBUTED_FILE_SYSTEM = 68;
    const SAT_MON = 69;
    const VISA = 70;
    const IPCV = 71;
    const CPNX = 72;
    const CPHB = 73;
    const WSN = 74;
    const PVP = 75;
    const BR_SAT_MON = 76;
    const SUN_ND = 77;
    const WB_MON = 78;
    const WB_EXPAK = 79;
    const ISO_IP = 80;
    const VMTP = 81;
    const SECURE_VMTP = 82;
    const VINES = 83;
    const IPTM = 84;
    const NSFNET_IGP = 85;
    const DGP = 86;
    const TCF = 87;
    const EIGRP = 88;
    const OSPFIGP = 89;
    const SPRITE_RPC = 90;
    const LARP = 91;
    const MTP = 92;
    const AX_25 = 93;
    const IPIP = 94;
    const MICP = 95;
    const SCC_SP = 96;
    const ETHERIP = 97;
    const ENCAP = 98;
    const ANY_PRIVATE_ENCRYPTION_SCHEME = 99;
    const GMTP = 100;
    const IFMP = 101;
    const PNNI = 102;
    const PIM = 103;
    const ARIS = 104;
    const SCPS = 105;
    const QNX = 106;
    const A_N = 107;
    const IPCOMP = 108;
    const SNP = 109;
    const COMPAQ_PEER = 110;
    const IPX_IN_IP = 111;
    const VRRP = 112;
    const PGM = 113;
    const ANY_0_HOP = 114;
    const L2TP = 115;
    const DDX = 116;
    const IATP = 117;
    const STP = 118;
    const SRP = 119;
    const UTI = 120;
    const SMP = 121;
    const SM = 122;
    const PTP = 123;
    const ISIS_OVER_IPV4 = 124;
    const FIRE = 125;
    const CRTP = 126;
    const CRUDP = 127;
    const SSCOPMCE = 128;
    const IPLT = 129;
    const SPS = 130;
    const PIPE = 131;
    const SCTP = 132;
    const FC = 133;
    const RSVP_E2E_IGNORE = 134;
    const MOBILITY_HEADER = 135;
    const UDPLITE = 136;
    const MPLS_IN_IP = 137;
    const MANET = 138;
    const HIP = 139;
    const SHIM6 = 140;
    const WESP = 141;
    const ROHC = 142;
    const RESERVED_255 = 255;
}
</code></pre>
            
        </div>
        
    </div>
</section>

    <footer id="main-footer">
        <div class="container">
            &copy; 2015-2019 Kaitai Project and <a href="https://github.com/kaitai-io/kaitai_struct_formats/graphs/contributors">formats repo contributors</a>

            <h3>Contacts</h3>

            <div class="row">
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-github"></i> <a href="https://github.com/kaitai-io/kaitai_struct">GitHub</a>
                </div>
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-twitter"></i> <a href="https://twitter.com/kaitai_io">@kaitai_io</a>
                </div>
                <div class="col-sm-4">
                    Gitter: <a href="https://gitter.im/kaitai_struct/Lobby">kaitai_struct</a>
                </div>
            </div>
        </div>
    </footer>

  <script src="//kaitai.io/js/jquery-1.12.3.min.js"></script>
  <script src="//kaitai.io/js/bootstrap.min.js"></script>

  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-76299550-1', 'auto');
      ga('send', 'pageview');
  </script>
</body>
</html>
