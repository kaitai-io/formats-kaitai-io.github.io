<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Python pickle serialization format: PHP parsing library</title>
  <meta name="keywords" content="kaitai,struct,binary,format,parsing,decoding,java,javascript,python,ruby,library,metadata">
  <meta name="description" content="Kaitai Struct is a formal language for binary format specification that can be compiled into parser code">

  <link rel="stylesheet" href="//kaitai.io/styles/bootstrap.min.css">
  <link rel="stylesheet" href="//kaitai.io/styles/bootstrap-theme.min.css">
  <link href='https://fonts.googleapis.com/css?family=Exo:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Share+Tech+Mono' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  <link rel="stylesheet" href="//kaitai.io/styles/main.css" type="text/css">

  <link rel="stylesheet" href="//kaitai.io/styles/highlight/default.css">
  <style>
.diagram-img {
    display: block;
    max-width: 100%;
    height: auto;
    margin: 0 auto;
}

section.format {
    padding: 30px 0;
}

section#format-meta, section#format-index-header {
    background: #e3eef7;
}

section#format-diagram, section#format-index-footer {
    background: #e9f8dd;
}

section#format-ksy, section#format-lang {
    background: #d1eadd;
}

section#format-index .row {
    padding-bottom: 10px;
}

  </style>
  <script src="//kaitai.io/js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>
<body data-spy="scroll" data-target="#main-navbar" data-offset="100">

    <nav class="navbar navbar-inverse navbar-fixed-top" id="main-navbar">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-navbar-collapse" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <span class="navbar-brand">Kaitai Struct</span>
            </div>
            <div class="collapse navbar-collapse" id="main-navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="http://kaitai.io/#what-is-it">What is it?</a></li>
                    <li><a href="http://kaitai.io/#quick-start">Quick Start</a></li>
                    <li><a href="http://kaitai.io/#download">Download</a></li>
                    <li class="active"><a href="http://formats.kaitai.io/">Format Gallery</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="http://kaitai.io/repl/index.html">Try it</a></li>
                    <li><a href="https://ide.kaitai.io/">Web IDE</a></li>
                    <li><a href="http://doc.kaitai.io/">Documentation</a></li>
                </ul>
            </div>
        </div>
    </nav>
<nav>
    <div class="container">
    <ol class="breadcrumb">
        <li><a href="../index.html">Format Gallery</a></li>
        <li>Serialization Protocols</li>
        <li class="active">Python pickle serialization format</li>
    </ol>
    </div>
</nav>

<section id="format-meta" class="format">
    <div class="container">
        <h1>Python pickle serialization format:
            
            PHP parsing library
            
        </h1>

        <div class="row">
            <div class="col-md-8">
                <p><p>Python Pickle format serializes Python objects to a byte stream, as a sequence
of operations to run on the Pickle Virtual Machine.</p>
<p>The format is mostly implementation defined, there is no formal specification.
Pickle data types are closely coupled to the Python object model.
Python singletons, and most builtin types (e.g. <code>None</code>, <code>int</code>,<code>dict</code>, <code>list</code>)
are serialised using dedicated Pickle opcodes.
Other builtin types, and all classes  (e.g. <code>set</code>, <code>datetime.datetime</code>) are
serialised by encoding the name of a constructor callable.
They are deserialised by importing that constructor, and calling it.
So, unpickling an arbitrary pickle, using the Python's stdlib pickle module
can cause arbitrary code execution.</p>
<p>Pickle format has evolved with Python, later protocols add opcodes &amp; types.
Later Python releases can pickle to or unpickle from any earlier protocol.</p>
<ul>
<li>Protocol 0: ASCII clean, no explicit version, fields are '\n' terminated.</li>
<li>Protocol 1: Binary, no explicit version, first length prefixed types.</li>
<li>Protocol 2: Python 2.3+. Explicit versioning, more length prefixed types.
https://www.python.org/dev/peps/pep-0307/</li>
<li>Protocol 3: Python 3.0+. Dedicated opcodes for <code>bytes</code> objects.</li>
<li>Protocol 4: Python 3.4+. Opcodes for 64 bit strings, framing, <code>set</code>.
https://www.python.org/dev/peps/pep-3154/</li>
</ul>
</p>
            </div>
            <div class="col-md-4">
                <div class="panel panel-info">
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">Application</h3>
                    </div>
                    <div class="panel-body">
                        Python
                    </div>
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">File extension</h3>
                    </div>
                    <div class="panel-body">
                        ["pickle", "pkl"]
                    </div>
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">KS implementation details</h3>
                    </div>
                    
                    <div class="panel-body">
                        License: <a href="https://spdx.org/licenses/CC0-1.0.html">CC0-1.0</a>
                    </div>
                    
                    
                    
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">References</h3>
                    </div>
                    <div class="panel-body">
                        <ul>
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <li><a href="https://www.wikidata.org/wiki/Q7190889">Wikidata Q7190889</a></li>
                            
                            
                            
                            <li><a href="http://fileformats.archiveteam.org/wiki/Pickle">Pickle in Just Solve the File Format Problem</a></li>
                            
                        </ul>
                    </div>
                    
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
            <p>
            This page hosts a formal specification of Python pickle serialization format
            using <a href="http://kaitai.io">Kaitai Struct</a>. This
            specification can be automatically translated into a
            variety of programming languages to get a parsing library.
            </p>

            <ul class="nav nav-pills">
                
                
                <li>
                
                <a href="index.html" title="Python pickle serialization format parsing Overview library">Overview</a></li>
                
                
                <li>
                
                <a href="csharp.html" title="Python pickle serialization format parsing C# library">C#</a></li>
                
                
                <li>
                
                <a href="graphviz.html" title="Python pickle serialization format parsing GraphViz library">GraphViz</a></li>
                
                
                <li>
                
                <a href="java.html" title="Python pickle serialization format parsing Java library">Java</a></li>
                
                
                <li>
                
                <a href="javascript.html" title="Python pickle serialization format parsing JavaScript library">JavaScript</a></li>
                
                
                <li>
                
                <a href="lua.html" title="Python pickle serialization format parsing Lua library">Lua</a></li>
                
                
                <li>
                
                <a href="perl.html" title="Python pickle serialization format parsing Perl library">Perl</a></li>
                
                
                <li class="active">
                
                <a href="php.html" title="Python pickle serialization format parsing PHP library">PHP</a></li>
                
                
                <li>
                
                <a href="python.html" title="Python pickle serialization format parsing Python library">Python</a></li>
                
                
                <li>
                
                <a href="ruby.html" title="Python pickle serialization format parsing Ruby library">Ruby</a></li>
                
            </ul>
            </div>
        </div>
    </div>
</section>


<section id="format-lang" class="format">
    <div class="container">
        <h2>
            
            PHP source code to parse Python pickle serialization format
            
        </h2>

        

        <h3>PythonPickle.php</h3>

        <div class="row">
            <div class="pull-right">
                <p>
                    <a href="src/php/PythonPickle.php" class="btn btn-success">Download <i class="fa fa-download"></i></a>
                </p>
            </div>
        </div>

        <div class="row">
            <pre><code class="php">&lt;?php
// This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild

/**
 * Python Pickle format serializes Python objects to a byte stream, as a sequence
 * of operations to run on the Pickle Virtual Machine.
 * 
 * The format is mostly implementation defined, there is no formal specification.
 * Pickle data types are closely coupled to the Python object model.
 * Python singletons, and most builtin types (e.g. `None`, `int`,`dict`, `list`)
 * are serialised using dedicated Pickle opcodes.
 * Other builtin types, and all classes  (e.g. `set`, `datetime.datetime`) are
 * serialised by encoding the name of a constructor callable.
 * They are deserialised by importing that constructor, and calling it.
 * So, unpickling an arbitrary pickle, using the Python&#39;s stdlib pickle module
 * can cause arbitrary code execution.
 * 
 * Pickle format has evolved with Python, later protocols add opcodes &amp; types.
 * Later Python releases can pickle to or unpickle from any earlier protocol.
 * 
 * * Protocol 0: ASCII clean, no explicit version, fields are &#39;\n&#39; terminated.
 * * Protocol 1: Binary, no explicit version, first length prefixed types.
 * * Protocol 2: Python 2.3+. Explicit versioning, more length prefixed types.
 *   https://www.python.org/dev/peps/pep-0307/
 * * Protocol 3: Python 3.0+. Dedicated opcodes for `bytes` objects.
 * * Protocol 4: Python 3.4+. Opcodes for 64 bit strings, framing, `set`.
 *   https://www.python.org/dev/peps/pep-3154/
 */

class PythonPickle extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \Kaitai\Struct\Struct $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_ops = [];
        $i = 0;
        while (!$this-&gt;_io-&gt;isEof()) {
            $this-&gt;_m_ops[] = new \PythonPickle\Op($this-&gt;_io, $this, $this-&gt;_root);
            $i++;
        }
    }
    protected $_m_ops;
    public function ops() { return $this-&gt;_m_ops; }
}

/**
 * Length prefixed string, between 0 and 2**64-1 bytes long.
 * 
 * Only a 64-bit build of Python would produce a pickle containing strings
 * large enough to need this type. Such a pickle could not be unpickled on
 * a 32-bit build of Python, because the string would be larger than
 * `sys.maxsize`.
 */

namespace \PythonPickle;

class Unicodestring8 extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \PythonPickle\Op $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_len = $this-&gt;_io-&gt;readU8le();
        $this-&gt;_m_val = \Kaitai\Struct\Stream::bytesToStr($this-&gt;_io-&gt;readBytes($this-&gt;len()), &quot;utf8&quot;);
    }
    protected $_m_len;
    protected $_m_val;
    public function len() { return $this-&gt;_m_len; }
    public function val() { return $this-&gt;_m_val; }
}

/**
 * Large signed integer, in the range -2**(8*255-1) to 2**(8*255-1)-1,
 * encoded as two&#39;s complement.
 */

namespace \PythonPickle;

class Long1 extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \PythonPickle\Op $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_len = $this-&gt;_io-&gt;readU1();
        $this-&gt;_m_val = $this-&gt;_io-&gt;readBytes($this-&gt;len());
    }
    protected $_m_len;
    protected $_m_val;
    public function len() { return $this-&gt;_m_len; }
    public function val() { return $this-&gt;_m_val; }
}

/**
 * Length prefixed string, between 0 and 2**64-1 bytes long.
 * 
 * Only a 64-bit build of Python would produce a pickle containing strings
 * large enough to need this type. Such a pickle could not be unpickled on
 * a 32-bit build of Python, because the string would be larger than
 * `sys.maxsize`.
 */

namespace \PythonPickle;

class Bytes8 extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \PythonPickle\Op $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_len = $this-&gt;_io-&gt;readU8le();
        $this-&gt;_m_val = $this-&gt;_io-&gt;readBytes($this-&gt;len());
    }
    protected $_m_len;
    protected $_m_val;
    public function len() { return $this-&gt;_m_len; }
    public function val() { return $this-&gt;_m_val; }
}

/**
 * Length prefixed byte string, between 0 and 255 bytes long.
 */

namespace \PythonPickle;

class Bytes1 extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \PythonPickle\Op $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_len = $this-&gt;_io-&gt;readU1();
        $this-&gt;_m_val = $this-&gt;_io-&gt;readBytes($this-&gt;len());
    }
    protected $_m_len;
    protected $_m_val;
    public function len() { return $this-&gt;_m_len; }
    public function val() { return $this-&gt;_m_val; }
}

/**
 * Length prefixed string, between 0 and 2**32-1 bytes long
 */

namespace \PythonPickle;

class Bytes4 extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \PythonPickle\Op $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_len = $this-&gt;_io-&gt;readU4le();
        $this-&gt;_m_val = $this-&gt;_io-&gt;readBytes($this-&gt;len());
    }
    protected $_m_len;
    protected $_m_val;
    public function len() { return $this-&gt;_m_len; }
    public function val() { return $this-&gt;_m_val; }
}

/**
 * Some opcodes take no argument, this empty type is used for them.
 */

namespace \PythonPickle;

class NoArg extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \PythonPickle\Op $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
    }
}

/**
 * Unquoted string, does not contain string escapes.
 */

namespace \PythonPickle;

class StringnlNoescape extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \Kaitai\Struct\Struct $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_val = \Kaitai\Struct\Stream::bytesToStr($this-&gt;_io-&gt;readBytesTerm(10, false, true, true), &quot;ascii&quot;);
    }
    protected $_m_val;
    public function val() { return $this-&gt;_m_val; }
}

/**
 * Integer, encoded with the ASCII chracters [0-9-], followed by &#39;L&#39;.
 */

namespace \PythonPickle;

class DecimalnlLong extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \PythonPickle\Op $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_val = \Kaitai\Struct\Stream::bytesToStr($this-&gt;_io-&gt;readBytesTerm(10, false, true, true), &quot;ascii&quot;);
    }
    protected $_m_val;
    public function val() { return $this-&gt;_m_val; }
}

/**
 * Length prefixed string, between 0 and 2**32-1 bytes long
 */

namespace \PythonPickle;

class Unicodestring4 extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \PythonPickle\Op $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_len = $this-&gt;_io-&gt;readU4le();
        $this-&gt;_m_val = \Kaitai\Struct\Stream::bytesToStr($this-&gt;_io-&gt;readBytes($this-&gt;len()), &quot;utf8&quot;);
    }
    protected $_m_len;
    protected $_m_val;
    public function len() { return $this-&gt;_m_len; }
    public function val() { return $this-&gt;_m_val; }
}

/**
 * Unquoted string, containing Python Unicode escapes.
 */

namespace \PythonPickle;

class Unicodestringnl extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \PythonPickle\Op $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_val = \Kaitai\Struct\Stream::bytesToStr($this-&gt;_io-&gt;readBytesTerm(10, false, true, true), &quot;ascii&quot;);
    }
    protected $_m_val;
    public function val() { return $this-&gt;_m_val; }
}

/**
 * Large signed integer, in the range -2**(8*2**32-1) to 2**(8*2**32-1)-1,
 * encoded as two&#39;s complement.
 */

namespace \PythonPickle;

class Long4 extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \PythonPickle\Op $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_len = $this-&gt;_io-&gt;readU4le();
        $this-&gt;_m_val = $this-&gt;_io-&gt;readBytes($this-&gt;len());
    }
    protected $_m_len;
    protected $_m_val;
    public function len() { return $this-&gt;_m_len; }
    public function val() { return $this-&gt;_m_val; }
}

/**
 * Length prefixed string, between 0 and 255 bytes long. Encoding is
 * unspecified.
 * 
 * The default Python 2.x string type (`str`) is a sequence of bytes.
 * These are pickled as `string1` or `string4`, when protocol == 2.
 * The bytes are written directly, no explicit encoding is performed.
 * 
 * Python 3.x will not pickle an object as `string1` or `string4`.
 * Instead, opcodes and types with a known encoding are used.
 * When unpickling
 * 
 * - `pickle.Unpickler` objects default to ASCII, which can be overriden
 * - `pickletools.dis` uses latin1, and cannot be overriden
 */

namespace \PythonPickle;

class String1 extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \PythonPickle\Op $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_len = $this-&gt;_io-&gt;readU1();
        $this-&gt;_m_val = $this-&gt;_io-&gt;readBytes($this-&gt;len());
    }
    protected $_m_len;
    protected $_m_val;
    public function len() { return $this-&gt;_m_len; }
    public function val() { return $this-&gt;_m_val; }
}

/**
 * Integer or boolean, encoded with the ASCII characters [0-9-].
 * 
 * The values &#39;00&#39; and &#39;01&#39; encode the Python values `False` and `True`.
 * Normally a value would not contain leading &#39;0&#39; characters.
 */

namespace \PythonPickle;

class DecimalnlShort extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \PythonPickle\Op $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_val = \Kaitai\Struct\Stream::bytesToStr($this-&gt;_io-&gt;readBytesTerm(10, false, true, true), &quot;ascii&quot;);
    }
    protected $_m_val;
    public function val() { return $this-&gt;_m_val; }
}

/**
 * Length prefixed string, between 0 and 255 bytes long
 */

namespace \PythonPickle;

class Unicodestring1 extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \PythonPickle\Op $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_len = $this-&gt;_io-&gt;readU4le();
        $this-&gt;_m_val = \Kaitai\Struct\Stream::bytesToStr($this-&gt;_io-&gt;readBytes($this-&gt;len()), &quot;utf8&quot;);
    }
    protected $_m_len;
    protected $_m_val;
    public function len() { return $this-&gt;_m_len; }
    public function val() { return $this-&gt;_m_val; }
}

/**
 * Quoted string, possibly containing Python string escapes.
 */

namespace \PythonPickle;

class Stringnl extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \PythonPickle\Op $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_val = \Kaitai\Struct\Stream::bytesToStr($this-&gt;_io-&gt;readBytesTerm(10, false, true, true), &quot;ascii&quot;);
    }
    protected $_m_val;
    public function val() { return $this-&gt;_m_val; }
}

/**
 * Pair of unquoted, unescaped strings.
 */

namespace \PythonPickle;

class StringnlNoescapePair extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \PythonPickle\Op $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_val1 = new \PythonPickle\StringnlNoescape($this-&gt;_io, $this, $this-&gt;_root);
        $this-&gt;_m_val2 = new \PythonPickle\StringnlNoescape($this-&gt;_io, $this, $this-&gt;_root);
    }
    protected $_m_val1;
    protected $_m_val2;
    public function val1() { return $this-&gt;_m_val1; }
    public function val2() { return $this-&gt;_m_val2; }
}

/**
 * Length prefixed string, between 0 and 2**31-1 bytes long. Encoding is
 * unspecified.
 * 
 * Although the len field is signed, any length &lt; 0 will raise an exception
 * during unpickling.
 * 
 * See the documentation for `string1` for further detail about encodings.
 */

namespace \PythonPickle;

class String4 extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \PythonPickle\Op $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_len = $this-&gt;_io-&gt;readS4le();
        $this-&gt;_m_val = $this-&gt;_io-&gt;readBytes($this-&gt;len());
    }
    protected $_m_len;
    protected $_m_val;
    public function len() { return $this-&gt;_m_len; }
    public function val() { return $this-&gt;_m_val; }
}

namespace \PythonPickle;

class Op extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \PythonPickle $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_code = $this-&gt;_io-&gt;readU1();
        switch ($this-&gt;code()) {
            case \PythonPickle\Opcode::EXT4:
                $this-&gt;_m_arg = $this-&gt;_io-&gt;readU4le();
                break;
            case \PythonPickle\Opcode::TUPLE1:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::SETITEM:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::STOP:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::EXT2:
                $this-&gt;_m_arg = $this-&gt;_io-&gt;readU2le();
                break;
            case \PythonPickle\Opcode::EMPTY_TUPLE:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::NEWTRUE:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::LONG:
                $this-&gt;_m_arg = new \PythonPickle\DecimalnlLong($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::NEWOBJ:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::PUT:
                $this-&gt;_m_arg = new \PythonPickle\DecimalnlShort($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::STACK_GLOBAL:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::POP_MARK:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::APPEND:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::NEWFALSE:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::BINPERSID:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::BUILD:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::EMPTY_DICT:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::TUPLE2:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::LONG4:
                $this-&gt;_m_arg = new \PythonPickle\Long4($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::APPENDS:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::BINBYTES:
                $this-&gt;_m_arg = new \PythonPickle\Bytes4($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::DUP:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::LIST:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::PROTO:
                $this-&gt;_m_arg = $this-&gt;_io-&gt;readU1();
                break;
            case \PythonPickle\Opcode::POP:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::FRAME:
                $this-&gt;_m_arg = $this-&gt;_io-&gt;readU8le();
                break;
            case \PythonPickle\Opcode::STRING:
                $this-&gt;_m_arg = new \PythonPickle\Stringnl($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::BINUNICODE:
                $this-&gt;_m_arg = new \PythonPickle\Unicodestring4($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::FLOAT:
                $this-&gt;_m_arg = new \PythonPickle\Floatnl($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::REDUCE:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::BINPUT:
                $this-&gt;_m_arg = $this-&gt;_io-&gt;readU1();
                break;
            case \PythonPickle\Opcode::MEMOIZE:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::PERSID:
                $this-&gt;_m_arg = new \PythonPickle\StringnlNoescape($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::EXT1:
                $this-&gt;_m_arg = $this-&gt;_io-&gt;readU1();
                break;
            case \PythonPickle\Opcode::NONE:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::SHORT_BINUNICODE:
                $this-&gt;_m_arg = new \PythonPickle\Unicodestring1($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::OBJ:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::BINFLOAT:
                $this-&gt;_m_arg = $this-&gt;_io-&gt;readF8be();
                break;
            case \PythonPickle\Opcode::NEWOBJ_EX:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::EMPTY_LIST:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::TUPLE:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::BINUNICODE8:
                $this-&gt;_m_arg = new \PythonPickle\Unicodestring8($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::BINGET:
                $this-&gt;_m_arg = $this-&gt;_io-&gt;readU1();
                break;
            case \PythonPickle\Opcode::GLOBAL:
                $this-&gt;_m_arg = new \PythonPickle\StringnlNoescapePair($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::DICT:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::BINSTRING:
                $this-&gt;_m_arg = new \PythonPickle\String4($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::SETITEMS:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::BININT2:
                $this-&gt;_m_arg = $this-&gt;_io-&gt;readU2le();
                break;
            case \PythonPickle\Opcode::BINBYTES8:
                $this-&gt;_m_arg = new \PythonPickle\Bytes8($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::BININT1:
                $this-&gt;_m_arg = $this-&gt;_io-&gt;readU1();
                break;
            case \PythonPickle\Opcode::INST:
                $this-&gt;_m_arg = new \PythonPickle\StringnlNoescapePair($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::LONG_BINGET:
                $this-&gt;_m_arg = $this-&gt;_io-&gt;readU4le();
                break;
            case \PythonPickle\Opcode::LONG_BINPUT:
                $this-&gt;_m_arg = $this-&gt;_io-&gt;readU4le();
                break;
            case \PythonPickle\Opcode::INT:
                $this-&gt;_m_arg = new \PythonPickle\DecimalnlShort($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::BININT:
                $this-&gt;_m_arg = $this-&gt;_io-&gt;readS4le();
                break;
            case \PythonPickle\Opcode::UNICODE:
                $this-&gt;_m_arg = new \PythonPickle\Unicodestringnl($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::LONG1:
                $this-&gt;_m_arg = new \PythonPickle\Long1($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::SHORT_BINSTRING:
                $this-&gt;_m_arg = new \PythonPickle\String1($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::MARK:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::FROZENSET:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::TUPLE3:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::ADDITEMS:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::GET:
                $this-&gt;_m_arg = new \PythonPickle\DecimalnlShort($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::EMPTY_SET:
                $this-&gt;_m_arg = new \PythonPickle\NoArg($this-&gt;_io, $this, $this-&gt;_root);
                break;
            case \PythonPickle\Opcode::SHORT_BINBYTES:
                $this-&gt;_m_arg = new \PythonPickle\Bytes1($this-&gt;_io, $this, $this-&gt;_root);
                break;
        }
    }
    protected $_m_code;
    protected $_m_arg;

    /**
     * Operation code that determines which action should be
     * performed next by the Pickle Virtual Machine. Some opcodes
     * are only available in later versions of the Pickle protocol.
     */
    public function code() { return $this-&gt;_m_code; }

    /**
     * Optional argument for the operation. Data type and length
     * are determined by the value of the opcode.
     */
    public function arg() { return $this-&gt;_m_arg; }
}

/**
 * Double float, encoded with the ASCII characters [0-9.e+-], &#39;-inf&#39;, &#39;inf&#39;,
 * or &#39;nan&#39;.
 */

namespace \PythonPickle;

class Floatnl extends \Kaitai\Struct\Struct {
    public function __construct(\Kaitai\Struct\Stream $_io, \PythonPickle\Op $_parent = null, \PythonPickle $_root = null) {
        parent::__construct($_io, $_parent, $_root);
        $this-&gt;_read();
    }

    private function _read() {
        $this-&gt;_m_val = \Kaitai\Struct\Stream::bytesToStr($this-&gt;_io-&gt;readBytesTerm(10, false, true, true), &quot;ascii&quot;);
    }
    protected $_m_val;
    public function val() { return $this-&gt;_m_val; }
}

namespace \PythonPickle;

class Opcode {

    /**
     * push special markobject on stack
     */
    const MARK = 40;

    /**
     * push empty tuple
     */
    const EMPTY_TUPLE = 41;

    /**
     * every pickle ends with STOP
     */
    const STOP = 46;

    /**
     * discard topmost stack item
     */
    const POP = 48;

    /**
     * discard stack top through topmost markobject
     */
    const POP_MARK = 49;

    /**
     * duplicate top stack item
     */
    const DUP = 50;

    /**
     * push bytes; counted binary string argument
     */
    const BINBYTES = 66;

    /**
     * push bytes; counted binary string argument &lt; 256 bytes
     */
    const SHORT_BINBYTES = 67;

    /**
     * push float object; decimal string argument
     */
    const FLOAT = 70;

    /**
     * push float; arg is 8-byte float encoding
     */
    const BINFLOAT = 71;

    /**
     * push integer or bool; decimal string argument
     */
    const INT = 73;

    /**
     * push four-byte signed int
     */
    const BININT = 74;

    /**
     * push 1-byte unsigned int
     */
    const BININT1 = 75;

    /**
     * push long; decimal string argument
     */
    const LONG = 76;

    /**
     * push 2-byte unsigned int
     */
    const BININT2 = 77;

    /**
     * push None
     */
    const NONE = 78;

    /**
     * push persistent object; id is taken from string arg
     */
    const PERSID = 80;

    /**
     * push persistent object; id is taken from stack
     */
    const BINPERSID = 81;

    /**
     * apply callable to argtuple, both on stack
     */
    const REDUCE = 82;

    /**
     * push string; NL-terminated string argument
     */
    const STRING = 83;

    /**
     * push string; counted binary string argument
     */
    const BINSTRING = 84;

    /**
     * push string; counted binary string argument 256 bytes
     */
    const SHORT_BINSTRING = 85;

    /**
     * push Unicode string; raw-unicode-escaped argument
     */
    const UNICODE = 86;

    /**
     * push Unicode string; counted UTF-8 string argument
     */
    const BINUNICODE = 88;

    /**
     * push empty list
     */
    const EMPTY_LIST = 93;

    /**
     * append stack top to list below it
     */
    const APPEND = 97;

    /**
     * call __setstate__ or __dict__.update()
     */
    const BUILD = 98;

    /**
     * push self.find_class(modname, name); 2 string args
     */
    const GLOBAL = 99;

    /**
     * build a dict from stack items
     */
    const DICT = 100;

    /**
     * extend list on stack by topmost stack slice
     */
    const APPENDS = 101;

    /**
     * push item from memo on stack; index is string arg
     */
    const GET = 103;

    /**
     * push item from memo on stack; index is 1-byte arg
     */
    const BINGET = 104;

    /**
     * build &amp; push class instance
     */
    const INST = 105;

    /**
     * push item from memo on stack; index is 4-byte arg
     */
    const LONG_BINGET = 106;

    /**
     * build list from topmost stack items
     */
    const LIST = 108;

    /**
     * build &amp; push class instance
     */
    const OBJ = 111;

    /**
     * store stack top in memo; index is string arg
     */
    const PUT = 112;

    /**
     * store stack top in memo; index is 1-byte arg
     */
    const BINPUT = 113;

    /**
     * store stack top in memo; index is 4-byte arg
     */
    const LONG_BINPUT = 114;

    /**
     * add key+value pair to dict
     */
    const SETITEM = 115;

    /**
     * build tuple from topmost stack items
     */
    const TUPLE = 116;

    /**
     * modify dict by adding topmost key+value pairs
     */
    const SETITEMS = 117;

    /**
     * push empty dict
     */
    const EMPTY_DICT = 125;

    /**
     * identify pickle protocol
     */
    const PROTO = 128;

    /**
     * build object by applying cls.__new__ to argtuple
     */
    const NEWOBJ = 129;

    /**
     * push object from extension registry; 1-byte index
     */
    const EXT1 = 130;

    /**
     * ditto, but 2-byte index
     */
    const EXT2 = 131;

    /**
     * ditto, but 4-byte index
     */
    const EXT4 = 132;

    /**
     * build 1-tuple from stack top
     */
    const TUPLE1 = 133;

    /**
     * build 2-tuple from two topmost stack items
     */
    const TUPLE2 = 134;

    /**
     * build 3-tuple from three topmost stack items
     */
    const TUPLE3 = 135;

    /**
     * push True
     */
    const NEWTRUE = 136;

    /**
     * push False
     */
    const NEWFALSE = 137;

    /**
     * push long from &lt; 256 bytes
     */
    const LONG1 = 138;

    /**
     * push really big long
     */
    const LONG4 = 139;

    /**
     * push short string; UTF-8 length &lt; 256 bytes
     */
    const SHORT_BINUNICODE = 140;

    /**
     * push very long string
     */
    const BINUNICODE8 = 141;

    /**
     * push very long bytes string
     */
    const BINBYTES8 = 142;

    /**
     * push empty set on the stack
     */
    const EMPTY_SET = 143;

    /**
     * modify set by adding topmost stack items
     */
    const ADDITEMS = 144;

    /**
     * build frozenset from topmost stack items
     */
    const FROZENSET = 145;

    /**
     * like NEWOBJ but work with keyword only arguments
     */
    const NEWOBJ_EX = 146;

    /**
     * same as GLOBAL but using names on the stacks
     */
    const STACK_GLOBAL = 147;

    /**
     * store top of the stack in memo
     */
    const MEMOIZE = 148;

    /**
     * indicate the beginning of a new frame
     */
    const FRAME = 149;
}
</code></pre>
            
        </div>
        
    </div>
</section>

    <footer id="main-footer">
        <div class="container">
            &copy; 2015-2019 Kaitai Project and <a href="https://github.com/kaitai-io/kaitai_struct_formats/graphs/contributors">formats repo contributors</a>

            <h3>Contacts</h3>

            <div class="row">
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-github"></i> <a href="https://github.com/kaitai-io/kaitai_struct">GitHub</a>
                </div>
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-twitter"></i> <a href="https://twitter.com/kaitai_io">@kaitai_io</a>
                </div>
                <div class="col-sm-4">
                    Gitter: <a href="https://gitter.im/kaitai_struct/Lobby">kaitai_struct</a>
                </div>
            </div>
        </div>
    </footer>

  <script src="//kaitai.io/js/jquery-1.12.3.min.js"></script>
  <script src="//kaitai.io/js/bootstrap.min.js"></script>

  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-76299550-1', 'auto');
      ga('send', 'pageview');
  </script>
</body>
</html>
