<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>TE (Terse Executable) file: Python parsing library</title>
  <meta name="keywords" content="kaitai,struct,binary,format,parsing,decoding,java,javascript,python,ruby,library,metadata">
  <meta name="description" content="Kaitai Struct is a formal language for binary format specification that can be compiled into parser code">

  <link rel="stylesheet" href="//kaitai.io/styles/bootstrap.min.css">
  <link rel="stylesheet" href="//kaitai.io/styles/bootstrap-theme.min.css">
  <link href='https://fonts.googleapis.com/css?family=Exo:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Share+Tech+Mono' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  <link rel="stylesheet" href="//kaitai.io/styles/main.css" type="text/css">
  <link rel="stylesheet" href="/pygments-default.css" type="text/css">
  <style>
.diagram-img {
    display: block;
    max-width: 100%;
    height: auto;
    margin: 0 auto;
}

section.format {
    padding: 30px 0;
}

section#format-meta, section#format-index-header {
    background: #e3eef7;
}

section#format-diagram, section#format-index-footer {
    background: #e9f8dd;
}

section#format-ksy, section#format-lang {
    background: #d1eadd;
}

section#format-index .row {
    padding-bottom: 10px;
}

  </style>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-MFSBBRGREL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-MFSBBRGREL');
  </script>
</head>
<body data-spy="scroll" data-target="#main-navbar" data-offset="100">

    <nav class="navbar navbar-inverse navbar-fixed-top" id="main-navbar">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-navbar-collapse" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <span class="navbar-brand">Kaitai Struct</span>
            </div>
            <div class="collapse navbar-collapse" id="main-navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="//kaitai.io/#what-is-it">What is it?</a></li>
                    <li><a href="//kaitai.io/#quick-start">Quick Start</a></li>
                    <li><a href="//kaitai.io/#download">Download</a></li>
                    <li class="active"><a href="//formats.kaitai.io/">Format Gallery</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="https://ide.kaitai.io/">Try it &mdash; Web IDE</a></li>
                    <li><a href="//doc.kaitai.io/">Documentation</a></li>
                </ul>
            </div>
        </div>
    </nav>
<nav>
    <div class="container">
    <ol class="breadcrumb">
        <li><a href="../">Format Gallery</a></li>
        <li>Executables and Byte-code</li>
        <li class="active">TE (Terse Executable) file</li>
    </ol>
    </div>
</nav>

<section id="format-meta" class="format">
    <div class="container">
        <h1>TE (Terse Executable) file:
            
            Python parsing library
            
        </h1>

        <div class="row">
            <div class="col-md-8">
                <p><p>This type of executables could be found inside the UEFI firmware. The UEFI
firmware is stored in SPI flash memory, which is a chip soldered on a
system's motherboard. UEFI firmware is very modular: it usually contains
dozens, if not hundreds, of executables. To store all these separates files,
the firmware is laid out in volumes using the Firmware File System (FFS), a
file system specifically designed to store firmware images. The volumes
contain files that are identified by GUIDs and each of these files contain
one or more sections holding the data. One of these sections contains the
actual executable image. Most of the executable images follow the PE format.
However, some of them follow the TE format.</p>
<p>The Terse Executable (TE) image format was created as a mechanism to reduce
the overhead of the PE/COFF headers in PE32/PE32+ images, resulting in a
corresponding reduction of image sizes for executables running in the PI
(Platform Initialization) Architecture environment. Reducing image size
provides an opportunity for use of a smaller system flash part.</p>
<p>So the TE format is basically a stripped version of PE.</p>
</p>
            </div>
            <div class="col-md-4">
                <div class="panel panel-info">
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">Application</h3>
                    </div>
                    <div class="panel-body">
                        UEFI
                    </div>
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">File extension</h3>
                    </div>
                    <div class="panel-body">
                        ["efi", "te"]
                    </div>
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">KS implementation details</h3>
                    </div>
                    
                    <div class="panel-body">
                        License: <a href="https://spdx.org/licenses/CC0-1.0.html">CC0-1.0</a>
                    </div>
                    
                    
                    <div class="panel-body">
                        Minimal Kaitai Struct required: 0.7
                    </div>
                    
                    
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">References</h3>
                    </div>
                    <div class="panel-body">
                        <ul>
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <li><a href="https://www.wikidata.org/wiki/Q83443959">Wikidata Q83443959</a></li>
                            
                            
                            
                            
                            
                        </ul>
                    </div>
                    
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
            <p>
            This page hosts a formal specification of TE (Terse Executable) file
            using <a href="//kaitai.io">Kaitai Struct</a>. This
            specification can be automatically translated into a
            variety of programming languages to get a parsing library.
            </p>

            <ul class="nav nav-pills">
                
                
                <li>
                
                <a href="index.html" title="TE (Terse Executable) file parsing Overview library">Overview</a></li>
                
                
                <li>
                
                <a href="cpp_stl_11.html" title="TE (Terse Executable) file parsing C++11/STL library">C++11/STL</a></li>
                
                
                <li>
                
                <a href="cpp_stl_98.html" title="TE (Terse Executable) file parsing C++98/STL library">C++98/STL</a></li>
                
                
                <li>
                
                <a href="csharp.html" title="TE (Terse Executable) file parsing C# library">C#</a></li>
                
                
                <li>
                
                <a href="go.html" title="TE (Terse Executable) file parsing Go library">Go</a></li>
                
                
                <li>
                
                <a href="java.html" title="TE (Terse Executable) file parsing Java library">Java</a></li>
                
                
                <li>
                
                <a href="javascript.html" title="TE (Terse Executable) file parsing JavaScript library">JavaScript</a></li>
                
                
                <li>
                
                <a href="lua.html" title="TE (Terse Executable) file parsing Lua library">Lua</a></li>
                
                
                <li>
                
                <a href="nim.html" title="TE (Terse Executable) file parsing Nim library">Nim</a></li>
                
                
                <li>
                
                <a href="perl.html" title="TE (Terse Executable) file parsing Perl library">Perl</a></li>
                
                
                <li>
                
                <a href="php.html" title="TE (Terse Executable) file parsing PHP library">PHP</a></li>
                
                
                <li class="active">
                
                <a href="python.html" title="TE (Terse Executable) file parsing Python library">Python</a></li>
                
                
                <li>
                
                <a href="ruby.html" title="TE (Terse Executable) file parsing Ruby library">Ruby</a></li>
                
            </ul>
            </div>
        </div>
    </div>
</section>

<section id="format-usage" class="format">
    <div class="container">
        <h2>Usage</h2>

        <h3>Runtime library</h3>

        <p>All parsing code for Python generated by Kaitai Struct depends on the
        <a
            href="https://github.com/kaitai-io/kaitai_struct_python_runtime/"
            target="_blank" rel="noopener">
        Python runtime library</a>. You have to
        install it before you can parse data.</p>

        <p>The Python runtime library can be installed
<a href="https://pypi.org/project/kaitaistruct/" target="_blank" rel="noopener">from PyPI</a>:</p>

<pre><code>python3 -m pip install kaitaistruct</code></pre>

<h3>Code</h3>

<p>Parse a local file and get structure in memory:</p>



<div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">UefiTe</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;path/to/local/file.[&quot;</span><span class="n">efi</span><span class="s2">&quot;, &quot;</span><span class="n">te</span><span class="s2">&quot;]&quot;</span><span class="p">)</span>
</pre></div>

<p>Or parse structure from a bytes:</p>

<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kaitaistruct</span> <span class="kn">import</span> <span class="n">KaitaiStream</span><span class="p">,</span> <span class="n">BytesIO</span>

<span class="n">raw</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x00\x01\x02</span><span class="s2">...&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">UefiTe</span><span class="p">(</span><span class="n">KaitaiStream</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">raw</span><span class="p">)))</span>
</pre></div>

<p>After that, one can get various attributes from the structure by invoking getter methods like:</p>


<div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">te_hdr</span> <span class="c1"># =&gt; get te hdr</span>
</pre></div>

    </div>
</section>


<section id="format-lang" class="format">
    <div class="container">
        <h2>
            
            Python source code to parse TE (Terse Executable) file
            
        </h2>

        

        <h3>uefi_te.py</h3>

        <div class="row">
            <div class="pull-right">
                <p>
                    <a href="src/python/uefi_te.py" download="uefi_te.py" class="btn btn-success">Download <i class="fa fa-download"></i></a>
                </p>
            </div>
        </div>

        <div class="row">
            <div class="highlight"><pre><span></span><span class="c1"># This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild</span>

<span class="kn">from</span> <span class="nn">pkg_resources</span> <span class="kn">import</span> <span class="n">parse_version</span>
<span class="kn">import</span> <span class="nn">kaitaistruct</span>
<span class="kn">from</span> <span class="nn">kaitaistruct</span> <span class="kn">import</span> <span class="n">KaitaiStruct</span><span class="p">,</span> <span class="n">KaitaiStream</span><span class="p">,</span> <span class="n">BytesIO</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>


<span class="k">if</span> <span class="n">parse_version</span><span class="p">(</span><span class="n">kaitaistruct</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">parse_version</span><span class="p">(</span><span class="s1">&#39;0.9&#39;</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Incompatible Kaitai Struct Python API: 0.9 or later is required, but you have </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">kaitaistruct</span><span class="o">.</span><span class="n">__version__</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">UefiTe</span><span class="p">(</span><span class="n">KaitaiStruct</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This type of executables could be found inside the UEFI firmware. The UEFI</span>
<span class="sd">    firmware is stored in SPI flash memory, which is a chip soldered on a</span>
<span class="sd">    system&#39;s motherboard. UEFI firmware is very modular: it usually contains</span>
<span class="sd">    dozens, if not hundreds, of executables. To store all these separates files,</span>
<span class="sd">    the firmware is laid out in volumes using the Firmware File System (FFS), a</span>
<span class="sd">    file system specifically designed to store firmware images. The volumes</span>
<span class="sd">    contain files that are identified by GUIDs and each of these files contain</span>
<span class="sd">    one or more sections holding the data. One of these sections contains the</span>
<span class="sd">    actual executable image. Most of the executable images follow the PE format.</span>
<span class="sd">    However, some of them follow the TE format.</span>
<span class="sd">    </span>
<span class="sd">    The Terse Executable (TE) image format was created as a mechanism to reduce</span>
<span class="sd">    the overhead of the PE/COFF headers in PE32/PE32+ images, resulting in a</span>
<span class="sd">    corresponding reduction of image sizes for executables running in the PI</span>
<span class="sd">    (Platform Initialization) Architecture environment. Reducing image size</span>
<span class="sd">    provides an opportunity for use of a smaller system flash part.</span>
<span class="sd">    </span>
<span class="sd">    So the TE format is basically a stripped version of PE.</span>
<span class="sd">    </span>
<span class="sd">    .. seealso::</span>
<span class="sd">       Source - https://uefi.org/sites/default/files/resources/PI_Spec_1_6.pdf</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_io</span><span class="p">,</span> <span class="n">_parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_root</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_io</span> <span class="o">=</span> <span class="n">_io</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">_parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_root</span> <span class="o">=</span> <span class="n">_root</span> <span class="k">if</span> <span class="n">_root</span> <span class="k">else</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_raw_te_hdr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
        <span class="n">_io__raw_te_hdr</span> <span class="o">=</span> <span class="n">KaitaiStream</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_raw_te_hdr</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">te_hdr</span> <span class="o">=</span> <span class="n">UefiTe</span><span class="o">.</span><span class="n">TeHeader</span><span class="p">(</span><span class="n">_io__raw_te_hdr</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">te_hdr</span><span class="o">.</span><span class="n">num_sections</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">te_hdr</span><span class="o">.</span><span class="n">num_sections</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">UefiTe</span><span class="o">.</span><span class="n">Section</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="p">)</span>


    <span class="k">class</span> <span class="nc">TeHeader</span><span class="p">(</span><span class="n">KaitaiStruct</span><span class="p">):</span>

        <span class="k">class</span> <span class="nc">MachineType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
            <span class="n">unknown</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">i386</span> <span class="o">=</span> <span class="mi">332</span>
            <span class="n">r4000</span> <span class="o">=</span> <span class="mi">358</span>
            <span class="n">wcemipsv2</span> <span class="o">=</span> <span class="mi">361</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mi">388</span>
            <span class="n">sh3</span> <span class="o">=</span> <span class="mi">418</span>
            <span class="n">sh3dsp</span> <span class="o">=</span> <span class="mi">419</span>
            <span class="n">sh4</span> <span class="o">=</span> <span class="mi">422</span>
            <span class="n">sh5</span> <span class="o">=</span> <span class="mi">424</span>
            <span class="n">arm</span> <span class="o">=</span> <span class="mi">448</span>
            <span class="n">thumb</span> <span class="o">=</span> <span class="mi">450</span>
            <span class="n">armnt</span> <span class="o">=</span> <span class="mi">452</span>
            <span class="n">am33</span> <span class="o">=</span> <span class="mi">467</span>
            <span class="n">powerpc</span> <span class="o">=</span> <span class="mi">496</span>
            <span class="n">powerpcfp</span> <span class="o">=</span> <span class="mi">497</span>
            <span class="n">ia64</span> <span class="o">=</span> <span class="mi">512</span>
            <span class="n">mips16</span> <span class="o">=</span> <span class="mi">614</span>
            <span class="n">mipsfpu</span> <span class="o">=</span> <span class="mi">870</span>
            <span class="n">mipsfpu16</span> <span class="o">=</span> <span class="mi">1126</span>
            <span class="n">ebc</span> <span class="o">=</span> <span class="mi">3772</span>
            <span class="n">riscv32</span> <span class="o">=</span> <span class="mi">20530</span>
            <span class="n">riscv64</span> <span class="o">=</span> <span class="mi">20580</span>
            <span class="n">riscv128</span> <span class="o">=</span> <span class="mi">20776</span>
            <span class="n">amd64</span> <span class="o">=</span> <span class="mi">34404</span>
            <span class="n">m32r</span> <span class="o">=</span> <span class="mi">36929</span>
            <span class="n">arm64</span> <span class="o">=</span> <span class="mi">43620</span>

        <span class="k">class</span> <span class="nc">SubsystemEnum</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
            <span class="n">unknown</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">native</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">windows_gui</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="n">windows_cui</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="n">posix_cui</span> <span class="o">=</span> <span class="mi">7</span>
            <span class="n">windows_ce_gui</span> <span class="o">=</span> <span class="mi">9</span>
            <span class="n">efi_application</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="n">efi_boot_service_driver</span> <span class="o">=</span> <span class="mi">11</span>
            <span class="n">efi_runtime_driver</span> <span class="o">=</span> <span class="mi">12</span>
            <span class="n">efi_rom</span> <span class="o">=</span> <span class="mi">13</span>
            <span class="n">xbox</span> <span class="o">=</span> <span class="mi">14</span>
            <span class="n">windows_boot_application</span> <span class="o">=</span> <span class="mi">16</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_io</span><span class="p">,</span> <span class="n">_parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_root</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_io</span> <span class="o">=</span> <span class="n">_io</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">_parent</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_root</span> <span class="o">=</span> <span class="n">_root</span> <span class="k">if</span> <span class="n">_root</span> <span class="k">else</span> <span class="bp">self</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">_read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">magic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">magic</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x56\x5A</span><span class="s2">&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">kaitaistruct</span><span class="o">.</span><span class="n">ValidationNotEqualError</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x56\x5A</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">magic</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;/types/te_header/seq/0&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">machine</span> <span class="o">=</span> <span class="n">KaitaiStream</span><span class="o">.</span><span class="n">resolve_enum</span><span class="p">(</span><span class="n">UefiTe</span><span class="o">.</span><span class="n">TeHeader</span><span class="o">.</span><span class="n">MachineType</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_u2le</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">num_sections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_u1</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">subsystem</span> <span class="o">=</span> <span class="n">KaitaiStream</span><span class="o">.</span><span class="n">resolve_enum</span><span class="p">(</span><span class="n">UefiTe</span><span class="o">.</span><span class="n">TeHeader</span><span class="o">.</span><span class="n">SubsystemEnum</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_u1</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stripped_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_u2le</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entry_point_addr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_u4le</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">base_of_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_u4le</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">image_base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_u8le</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_dirs</span> <span class="o">=</span> <span class="n">UefiTe</span><span class="o">.</span><span class="n">HeaderDataDirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="p">)</span>


    <span class="k">class</span> <span class="nc">HeaderDataDirs</span><span class="p">(</span><span class="n">KaitaiStruct</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_io</span><span class="p">,</span> <span class="n">_parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_root</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_io</span> <span class="o">=</span> <span class="n">_io</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">_parent</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_root</span> <span class="o">=</span> <span class="n">_root</span> <span class="k">if</span> <span class="n">_root</span> <span class="k">else</span> <span class="bp">self</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">_read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">base_relocation_table</span> <span class="o">=</span> <span class="n">UefiTe</span><span class="o">.</span><span class="n">DataDir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">UefiTe</span><span class="o">.</span><span class="n">DataDir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="p">)</span>


    <span class="k">class</span> <span class="nc">DataDir</span><span class="p">(</span><span class="n">KaitaiStruct</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_io</span><span class="p">,</span> <span class="n">_parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_root</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_io</span> <span class="o">=</span> <span class="n">_io</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">_parent</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_root</span> <span class="o">=</span> <span class="n">_root</span> <span class="k">if</span> <span class="n">_root</span> <span class="k">else</span> <span class="bp">self</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">_read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">virtual_address</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_u4le</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_u4le</span><span class="p">()</span>


    <span class="k">class</span> <span class="nc">Section</span><span class="p">(</span><span class="n">KaitaiStruct</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_io</span><span class="p">,</span> <span class="n">_parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_root</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_io</span> <span class="o">=</span> <span class="n">_io</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">_parent</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_root</span> <span class="o">=</span> <span class="n">_root</span> <span class="k">if</span> <span class="n">_root</span> <span class="k">else</span> <span class="bp">self</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">_read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="p">(</span><span class="n">KaitaiStream</span><span class="o">.</span><span class="n">bytes_strip_right</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">virtual_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_u4le</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">virtual_address</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_u4le</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size_of_raw_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_u4le</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pointer_to_raw_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_u4le</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pointer_to_relocations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_u4le</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pointer_to_linenumbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_u4le</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">num_relocations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_u2le</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">num_linenumbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_u2le</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">characteristics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_u4le</span><span class="p">()</span>

        <span class="nd">@property</span>
        <span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_m_body&#39;</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_m_body</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_m_body&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>

            <span class="n">_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">seek</span><span class="p">(((</span><span class="bp">self</span><span class="o">.</span><span class="n">pointer_to_raw_data</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">.</span><span class="n">te_hdr</span><span class="o">.</span><span class="n">stripped_size</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">.</span><span class="n">te_hdr</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">size</span><span class="p">()))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_m_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size_of_raw_data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">_pos</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_m_body</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_m_body&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
</pre></div>

        </div>
        
    </div>
</section>

    <footer id="main-footer">
        <div class="container">
            &copy; 2015&ndash;2021 Kaitai Project and <a href="https://github.com/kaitai-io/kaitai_struct_formats/graphs/contributors">format repo contributors</a>

            <h3>Contacts</h3>

            <div class="row">
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-github"></i> <a href="https://github.com/kaitai-io/kaitai_struct">GitHub</a>
                </div>
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-twitter"></i> <a href="https://twitter.com/kaitai_io">@kaitai_io</a>
                </div>
                <div class="col-sm-4">
                    Gitter: <a href="https://gitter.im/kaitai_struct/Lobby">kaitai_struct</a>
                </div>
            </div>
        </div>
    </footer>

  <script src="//kaitai.io/js/jquery-1.12.3.min.js"></script>
  <script src="//kaitai.io/js/bootstrap.min.js"></script>

  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-76299550-1', 'auto');
      ga('send', 'pageview');
  </script>
</body>
</html>
