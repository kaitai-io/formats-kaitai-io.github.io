<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>.roh file format format spec for Kaitai Struct</title>
  <meta name="keywords" content="kaitai,struct,binary,format,parsing,decoding,java,javascript,python,ruby,library,metadata">
  <meta name="description" content="Kaitai Struct is a formal language for binary format specification that can be compiled into parser code">

  <link rel="stylesheet" href="//kaitai.io/styles/bootstrap.min.css">
  <link rel="stylesheet" href="//kaitai.io/styles/bootstrap-theme.min.css">
  <link href='https://fonts.googleapis.com/css?family=Exo:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Share+Tech+Mono' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  <link rel="stylesheet" href="//kaitai.io/styles/main.css" type="text/css">

  <link rel="stylesheet" href="//kaitai.io/styles/highlight/default.css">
  <style>
.diagram-img {
    display: block;
    max-width: 100%;
    height: auto;
    margin: 0 auto;
}

section.format {
    padding: 30px 0;
}

section#format-meta, section#format-index-header {
    background: #e3eef7;
}

section#format-diagram, section#format-index-footer {
    background: #e9f8dd;
}

section#format-ksy, section#format-lang {
    background: #d1eadd;
}

section#format-index .row {
    padding-bottom: 10px;
}

  </style>
  <script src="//kaitai.io/js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>
<body data-spy="scroll" data-target="#main-navbar" data-offset="100">

    <nav class="navbar navbar-inverse navbar-fixed-top" id="main-navbar">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-navbar-collapse" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <span class="navbar-brand">Kaitai Struct</span>
            </div>
            <div class="collapse navbar-collapse" id="main-navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="http://kaitai.io/#what-is-it">What is it?</a></li>
                    <li><a href="http://kaitai.io/#quick-start">Quick Start</a></li>
                    <li><a href="http://kaitai.io/#download">Download</a></li>
                    <li class="active"><a href="http://formats.kaitai.io/">Format Gallery</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="http://kaitai.io/repl/index.html">Try it</a></li>
                    <li><a href="https://ide.kaitai.io/">Web IDE</a></li>
                    <li><a href="http://doc.kaitai.io/">Documentation</a></li>
                </ul>
            </div>
        </div>
    </nav>
<nav>
    <div class="container">
    <ol class="breadcrumb">
        <li><a href="../index.html">Format Gallery</a></li>
        <li>Scientific Applications</li>
        <li class="active">.roh file format</li>
    </ol>
    </div>
</nav>

<section id="format-meta" class="format">
    <div class="container">
        <h1>.roh file format:
            
            format specification
            
        </h1>

        <div class="row">
            <div class="col-md-8">
                <p><p>Avantes USB spectrometers are supplied with a Windows binary which
generates one ROH and one RCM file when the user clicks &quot;Save
experiment&quot;. In the version of 6.0, the ROH file contains a header
of 22 four-byte floats, then the spectrum as a float array and a
footer of 3 floats. The first and last pixel numbers are specified in the
header and determine the (length+1) of the spectral data. In the tested
files, the length is (2032-211-1)=1820 pixels, but Kaitai determines this
automatically anyway.</p>
<p>The wavelength calibration is stored as a polynomial with coefficients
of 'wlintercept', 'wlx1', ... 'wlx4', the argument of which is the
(pixel number + 1), as found out by comparing with the original
Avantes converted data files. There is no intensity calibration saved,
but it is recommended to do it in your program - the CCD in the spectrometer
is so uneven that one should prepare exact pixel-to-pixel calibration curves
to get reasonable spectral results.</p>
<p>The rest of the header floats is not known to the author. Note that the
newer version of Avantes software has a different format, see also
https://kr.mathworks.com/examples/matlab/community/20341-reading-spectra-from-avantes-binary-files-demonstration</p>
<p>The RCM file contains the user-specified comment, so it may be useful
for automatic conversion of data. You may wish to divide the spectra by
the integration time before comparing them.</p>
<p>Written and tested by Filip Dominec, 2017-2018</p>
</p>
            </div>
            <div class="col-md-4">
                <div class="panel panel-info">
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">File extension</h3>
                    </div>
                    <div class="panel-body">
                        roh
                    </div>
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">KS implementation details</h3>
                    </div>
                    
                    <div class="panel-body">
                        License: <a href="https://spdx.org/licenses/CC0-1.0.html">CC0-1.0</a>
                    </div>
                    
                    
                    
                    
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
            <p>
            This page hosts a formal specification of .roh file format
            using <a href="http://kaitai.io">Kaitai Struct</a>. This
            specification can be automatically translated into a
            variety of programming languages to get a parsing library.
            </p>

            <ul class="nav nav-pills">
                
                
                <li class="active">
                
                <a href="index.html" title=".roh file format parsing Overview library">Overview</a></li>
                
                
                <li>
                
                <a href="cpp_stl.html" title=".roh file format parsing C++/STL library">C++/STL</a></li>
                
                
                <li>
                
                <a href="csharp.html" title=".roh file format parsing C# library">C#</a></li>
                
                
                <li>
                
                <a href="graphviz.html" title=".roh file format parsing GraphViz library">GraphViz</a></li>
                
                
                <li>
                
                <a href="java.html" title=".roh file format parsing Java library">Java</a></li>
                
                
                <li>
                
                <a href="javascript.html" title=".roh file format parsing JavaScript library">JavaScript</a></li>
                
                
                <li>
                
                <a href="lua.html" title=".roh file format parsing Lua library">Lua</a></li>
                
                
                <li>
                
                <a href="perl.html" title=".roh file format parsing Perl library">Perl</a></li>
                
                
                <li>
                
                <a href="php.html" title=".roh file format parsing PHP library">PHP</a></li>
                
                
                <li>
                
                <a href="python.html" title=".roh file format parsing Python library">Python</a></li>
                
                
                <li>
                
                <a href="ruby.html" title=".roh file format parsing Ruby library">Ruby</a></li>
                
            </ul>
            </div>
        </div>
    </div>
</section>
<section id="format-diagram" class="format">
    <div class="container">
        <h2>Block diagram</h2>
        <a href="avantes_roh60.svg">
            <img class="diagram-img" src="avantes_roh60.svg" />
        </a>
    </div>
</section>

<section id="format-ksy" class="format">
    <div class="container">
        <h2>Format specification in Kaitai Struct YAML</h2>
        
        <pre><code class="yaml">meta:
  id: avantes_roh60
  file-extension: roh
  license: CC0-1.0
  endian: le
doc: |
  Avantes USB spectrometers are supplied with a Windows binary which 
  generates one ROH and one RCM file when the user clicks "Save
  experiment". In the version of 6.0, the ROH file contains a header 
  of 22 four-byte floats, then the spectrum as a float array and a 
  footer of 3 floats. The first and last pixel numbers are specified in the 
  header and determine the (length+1) of the spectral data. In the tested 
  files, the length is (2032-211-1)=1820 pixels, but Kaitai determines this 
  automatically anyway.

  The wavelength calibration is stored as a polynomial with coefficients
  of 'wlintercept', 'wlx1', ... 'wlx4', the argument of which is the
  (pixel number + 1), as found out by comparing with the original 
  Avantes converted data files. There is no intensity calibration saved,
  but it is recommended to do it in your program - the CCD in the spectrometer 
  is so uneven that one should prepare exact pixel-to-pixel calibration curves 
  to get reasonable spectral results.

  The rest of the header floats is not known to the author. Note that the 
  newer version of Avantes software has a different format, see also
  https://kr.mathworks.com/examples/matlab/community/20341-reading-spectra-from-avantes-binary-files-demonstration

  The RCM file contains the user-specified comment, so it may be useful
  for automatic conversion of data. You may wish to divide the spectra by 
  the integration time before comparing them.
  
  Written and tested by Filip Dominec, 2017-2018
seq:
  - id: unknown1
    type: f4
  - id: wlintercept
    type: f4
  - id: wlx1
    type: f4
  - id: wlx2
    type: f4
  - id: wlx3
    type: f4
  - id: wlx4
    type: f4
  - id: unknown2
    type: f4
    repeat: expr
    repeat-expr: 9
  - id: ipixfirst
    type: f4
  - id: ipixlast
    type: f4
  - id: unknown3
    type: f4
    repeat: expr
    repeat-expr: 4
  - id: spectrum
    type: f4
    repeat: expr
    repeat-expr: ipixlast.to_i - ipixfirst.to_i - 1
  - id: integration_ms
    type: f4
  - id: averaging
    type: f4
  - id: pixel_smoothing
    type: f4
</code></pre>
    </div>
</section>

    <footer id="main-footer">
        <div class="container">
            &copy; 2015-2018 Kaitai Project and <a href="https://github.com/kaitai-io/kaitai_struct_formats/graphs/contributors">formats repo contributors</a>

            <h3>Contacts</h3>

            <div class="row">
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-github"></i> <a href="https://github.com/kaitai-io/kaitai_struct">GitHub</a>
                </div>
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-twitter"></i> <a href="https://twitter.com/kaitai_io">@kaitai_io</a>
                </div>
                <div class="col-sm-4">
                    Gitter: <a href="https://gitter.im/kaitai_struct/Lobby">kaitai_struct</a>
                </div>
            </div>
        </div>
    </footer>

  <script src="//kaitai.io/js/jquery-1.12.3.min.js"></script>
  <script src="//kaitai.io/js/bootstrap.min.js"></script>

  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-76299550-1', 'auto');
      ga('send', 'pageview');
  </script>
</body>
</html>
