<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>MS-DOS datetime: Lua parsing library</title>
  <meta name="keywords" content="kaitai,struct,binary,format,parsing,decoding,java,javascript,python,ruby,library,metadata">
  <meta name="description" content="Kaitai Struct is a formal language for binary format specification that can be compiled into parser code">

  <link rel="stylesheet" href="//kaitai.io/styles/bootstrap.min.css">
  <link rel="stylesheet" href="//kaitai.io/styles/bootstrap-theme.min.css">
  <link href='https://fonts.googleapis.com/css?family=Exo:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Share+Tech+Mono' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  <link rel="stylesheet" href="//kaitai.io/styles/main.css" type="text/css">
  <link rel="stylesheet" href="/pygments-default.css" type="text/css">
  <style>
.diagram-img {
    display: block;
    max-width: 100%;
    height: auto;
    margin: 0 auto;
}

section.format {
    padding: 30px 0;
}

section#format-meta, section#format-index-header {
    background: #e3eef7;
}

section#format-diagram, section#format-index-footer {
    background: #e9f8dd;
}

section#format-ksy, section#format-lang {
    background: #d1eadd;
}

section#format-index .row {
    padding-bottom: 10px;
}

  </style>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-MFSBBRGREL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-MFSBBRGREL');
  </script>
</head>
<body data-spy="scroll" data-target="#main-navbar" data-offset="100">

    <nav class="navbar navbar-inverse navbar-fixed-top" id="main-navbar">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-navbar-collapse" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <span class="navbar-brand">Kaitai Struct</span>
            </div>
            <div class="collapse navbar-collapse" id="main-navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="//kaitai.io/#what-is-it">What is it?</a></li>
                    <li><a href="//kaitai.io/#quick-start">Quick Start</a></li>
                    <li><a href="//kaitai.io/#download">Download</a></li>
                    <li><a href="//kaitai.io/news/">News</a></li>
                    <li class="active"><a href="//formats.kaitai.io/">Format Gallery</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="https://ide.kaitai.io/">Try it &mdash; Web IDE</a></li>
                    <li><a href="//doc.kaitai.io/">Documentation</a></li>
                </ul>
            </div>
        </div>
    </nav>
<nav>
    <div class="container">
    <ol class="breadcrumb">
        <li><a href="../">Format Gallery</a></li>
        <li>Commonly Used Data Types</li>
        <li class="active">MS-DOS datetime</li>
    </ol>
    </div>
</nav>

<section id="format-meta" class="format">
    <div class="container">
        <h1>MS-DOS datetime:
            
            Lua parsing library
            
        </h1>

        <div class="row">
            <div class="col-md-8">
                <p><p>MS-DOS date and time are packed 16-bit values that specify local date/time.
The time is always stored in the current UTC time offset set on the computer
which created the file. Note that the daylight saving time (DST) shifts
also change the UTC time offset.</p>
<p>For example, if you pack two files A and B into a ZIP archive, file A last modified
at 2020-03-29 00:59 UTC+00:00 (GMT) and file B at 2020-03-29 02:00 UTC+01:00 (BST),
the file modification times saved in MS-DOS format in the ZIP file will vary depending
on whether the computer packing the files is set to GMT or BST at the time of ZIP creation.</p>
<ul>
<li>If set to GMT:
<ul>
<li>file A: 2020-03-29 00:59 (UTC+00:00)</li>
<li>file B: 2020-03-29 01:00 (UTC+00:00)</li>
</ul>
</li>
<li>If set to BST:
<ul>
<li>file A: 2020-03-29 01:59 (UTC+01:00)</li>
<li>file B: 2020-03-29 02:00 (UTC+01:00)</li>
</ul>
</li>
</ul>
<p>It follows that you are unable to determine the actual last modified time
of any file stored in the ZIP archive, if you don't know the locale time
setting of the computer at the time it created the ZIP.</p>
<p>This format is used in some data formats from the MS-DOS era, for example:</p>
<ul>
<li><a href="/zip/">zip</a></li>
<li><a href="/rar/">rar</a></li>
<li><a href="/vfat/">vfat</a> (FAT12)</li>
<li><a href="/lzh/">lzh</a></li>
<li><a href="http://justsolve.archiveteam.org/wiki/Cabinet">cab</a></li>
</ul>
</p>
            </div>
            <div class="col-md-4">
                <div class="panel panel-info">
                    
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">KS implementation details</h3>
                    </div>
                    
                    <div class="panel-body">
                        License: <a href="https://spdx.org/licenses/CC0-1.0.html">CC0-1.0</a>
                    </div>
                    
                    
                    <div class="panel-body">
                        Minimal Kaitai Struct required: 0.9
                    </div>
                    
                    
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">References</h3>
                    </div>
                    <div class="panel-body">
                        <ul>
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <li><a href="http://fileformats.archiveteam.org/wiki/MS-DOS_date/time">MS-DOS date/time in Just Solve the File Format Problem</a></li>
                            
                        </ul>
                    </div>
                    
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
            <p>
            This page hosts a formal specification of MS-DOS datetime
            using <a href="//kaitai.io">Kaitai Struct</a>. This
            specification can be automatically translated into a
            variety of programming languages to get a parsing library.
            </p>

            <ul class="nav nav-pills">
                
                
                <li>
                
                <a href="index.html" title="MS-DOS datetime parsing Overview library">Overview</a></li>
                
                
                <li>
                
                <a href="cpp_stl_11.html" title="MS-DOS datetime parsing C++11/STL library">C++11/STL</a></li>
                
                
                <li>
                
                <a href="cpp_stl_98.html" title="MS-DOS datetime parsing C++98/STL library">C++98/STL</a></li>
                
                
                <li>
                
                <a href="csharp.html" title="MS-DOS datetime parsing C# library">C#</a></li>
                
                
                <li>
                
                <a href="go.html" title="MS-DOS datetime parsing Go library">Go</a></li>
                
                
                <li>
                
                <a href="graphviz.html" title="MS-DOS datetime parsing GraphViz library">GraphViz</a></li>
                
                
                <li>
                
                <a href="java.html" title="MS-DOS datetime parsing Java library">Java</a></li>
                
                
                <li>
                
                <a href="javascript.html" title="MS-DOS datetime parsing JavaScript library">JavaScript</a></li>
                
                
                <li class="active">
                
                <a href="lua.html" title="MS-DOS datetime parsing Lua library">Lua</a></li>
                
                
                <li>
                
                <a href="nim.html" title="MS-DOS datetime parsing Nim library">Nim</a></li>
                
                
                <li>
                
                <a href="perl.html" title="MS-DOS datetime parsing Perl library">Perl</a></li>
                
                
                <li>
                
                <a href="php.html" title="MS-DOS datetime parsing PHP library">PHP</a></li>
                
                
                <li>
                
                <a href="python.html" title="MS-DOS datetime parsing Python library">Python</a></li>
                
                
                <li>
                
                <a href="ruby.html" title="MS-DOS datetime parsing Ruby library">Ruby</a></li>
                
            </ul>
            </div>
        </div>
    </div>
</section>


<section id="format-lang" class="format">
    <div class="container">
        <h2>
            
            Lua source code to parse MS-DOS datetime
            
        </h2>

        

        <h3>dos_datetime.lua</h3>

        <div class="row">
            <div class="pull-right">
                <p>
                    <a href="src/lua/dos_datetime.lua" download="dos_datetime.lua" class="btn btn-success">Download <i class="fa fa-download"></i></a>
                </p>
            </div>
        </div>

        <div class="row">
            <div class="highlight"><pre><span></span><span class="c1">-- This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild</span>
<span class="c1">--</span>
<span class="c1">-- This file is compatible with Lua 5.3</span>

<span class="kd">local</span> <span class="n">class</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">)</span>
<span class="nb">require</span><span class="p">(</span><span class="s2">&quot;kaitaistruct&quot;</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">utils</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s2">&quot;utils&quot;</span><span class="p">)</span>

<span class="c1">-- </span>
<span class="c1">-- MS-DOS date and time are packed 16-bit values that specify local date/time.</span>
<span class="c1">-- The time is always stored in the current UTC time offset set on the computer</span>
<span class="c1">-- which created the file. Note that the daylight saving time (DST) shifts</span>
<span class="c1">-- also change the UTC time offset.</span>
<span class="c1">-- </span>
<span class="c1">-- For example, if you pack two files A and B into a ZIP archive, file A last modified</span>
<span class="c1">-- at 2020-03-29 00:59 UTC+00:00 (GMT) and file B at 2020-03-29 02:00 UTC+01:00 (BST),</span>
<span class="c1">-- the file modification times saved in MS-DOS format in the ZIP file will vary depending</span>
<span class="c1">-- on whether the computer packing the files is set to GMT or BST at the time of ZIP creation.</span>
<span class="c1">-- </span>
<span class="c1">--   - If set to GMT:</span>
<span class="c1">--       - file A: 2020-03-29 00:59 (UTC+00:00)</span>
<span class="c1">--       - file B: 2020-03-29 01:00 (UTC+00:00)</span>
<span class="c1">--   - If set to BST:</span>
<span class="c1">--       - file A: 2020-03-29 01:59 (UTC+01:00)</span>
<span class="c1">--       - file B: 2020-03-29 02:00 (UTC+01:00)</span>
<span class="c1">-- </span>
<span class="c1">-- It follows that you are unable to determine the actual last modified time</span>
<span class="c1">-- of any file stored in the ZIP archive, if you don&#39;t know the locale time</span>
<span class="c1">-- setting of the computer at the time it created the ZIP.</span>
<span class="c1">-- </span>
<span class="c1">-- This format is used in some data formats from the MS-DOS era, for example:</span>
<span class="c1">-- </span>
<span class="c1">--   - [zip](/zip/)</span>
<span class="c1">--   - [rar](/rar/)</span>
<span class="c1">--   - [vfat](/vfat/) (FAT12)</span>
<span class="c1">--   - [lzh](/lzh/)</span>
<span class="c1">--   - [cab](http://justsolve.archiveteam.org/wiki/Cabinet)</span>
<span class="c1">-- See also: Source (https://learn.microsoft.com/en-us/windows/win32/sysinfo/ms-dos-date-and-time)</span>
<span class="c1">-- See also: Source (https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-dosdatetimetofiletime)</span>
<span class="c1">-- See also: DosDateTimeToFileTime (https://github.com/reactos/reactos/blob/c6b64448ce4/dll/win32/kernel32/client/time.c#L82-L87)</span>
<span class="c1">-- See also: page 25/34 (https://download.microsoft.com/download/0/8/4/084c452b-b772-4fe5-89bb-a0cbf082286a/fatgen103.doc)</span>
<span class="n">DosDatetime</span> <span class="o">=</span> <span class="n">class</span><span class="p">.</span><span class="n">class</span><span class="p">(</span><span class="n">KaitaiStruct</span><span class="p">)</span>

<span class="kr">function</span> <span class="nc">DosDatetime</span><span class="p">:</span><span class="nf">_init</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">root</span><span class="p">)</span>
  <span class="n">KaitaiStruct</span><span class="p">.</span><span class="n">_init</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">io</span><span class="p">)</span>
  <span class="n">self</span><span class="p">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
  <span class="n">self</span><span class="p">.</span><span class="n">_root</span> <span class="o">=</span> <span class="n">root</span> <span class="ow">or</span> <span class="n">self</span>
  <span class="n">self</span><span class="p">:</span><span class="n">_read</span><span class="p">()</span>
<span class="kr">end</span>

<span class="kr">function</span> <span class="nc">DosDatetime</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
  <span class="n">self</span><span class="p">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">DosDatetime</span><span class="p">.</span><span class="n">Time</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_io</span><span class="p">,</span> <span class="n">self</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">_root</span><span class="p">)</span>
  <span class="n">self</span><span class="p">.</span><span class="n">date</span> <span class="o">=</span> <span class="n">DosDatetime</span><span class="p">.</span><span class="n">Date</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_io</span><span class="p">,</span> <span class="n">self</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">_root</span><span class="p">)</span>
<span class="kr">end</span>


<span class="n">DosDatetime</span><span class="p">.</span><span class="n">Time</span> <span class="o">=</span> <span class="n">class</span><span class="p">.</span><span class="n">class</span><span class="p">(</span><span class="n">KaitaiStruct</span><span class="p">)</span>

<span class="kr">function</span> <span class="nc">DosDatetime</span><span class="p">.</span><span class="nc">Time</span><span class="p">:</span><span class="nf">_init</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">root</span><span class="p">)</span>
  <span class="n">KaitaiStruct</span><span class="p">.</span><span class="n">_init</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">io</span><span class="p">)</span>
  <span class="n">self</span><span class="p">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
  <span class="n">self</span><span class="p">.</span><span class="n">_root</span> <span class="o">=</span> <span class="n">root</span> <span class="ow">or</span> <span class="n">self</span>
  <span class="n">self</span><span class="p">:</span><span class="n">_read</span><span class="p">()</span>
<span class="kr">end</span>

<span class="kr">function</span> <span class="nc">DosDatetime</span><span class="p">.</span><span class="nc">Time</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
  <span class="n">self</span><span class="p">.</span><span class="n">second_div_2</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">_io</span><span class="p">:</span><span class="n">read_bits_int_le</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
  <span class="kr">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">second_div_2</span> <span class="o">&lt;=</span> <span class="mi">29</span><span class="p">)</span> <span class="kr">then</span>
    <span class="nb">error</span><span class="p">(</span><span class="s2">&quot;ValidationGreaterThanError&quot;</span><span class="p">)</span>
  <span class="kr">end</span>
  <span class="n">self</span><span class="p">.</span><span class="n">minute</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">_io</span><span class="p">:</span><span class="n">read_bits_int_le</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
  <span class="kr">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">minute</span> <span class="o">&lt;=</span> <span class="mi">59</span><span class="p">)</span> <span class="kr">then</span>
    <span class="nb">error</span><span class="p">(</span><span class="s2">&quot;ValidationGreaterThanError&quot;</span><span class="p">)</span>
  <span class="kr">end</span>
  <span class="n">self</span><span class="p">.</span><span class="n">hour</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">_io</span><span class="p">:</span><span class="n">read_bits_int_le</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
  <span class="kr">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">hour</span> <span class="o">&lt;=</span> <span class="mi">23</span><span class="p">)</span> <span class="kr">then</span>
    <span class="nb">error</span><span class="p">(</span><span class="s2">&quot;ValidationGreaterThanError&quot;</span><span class="p">)</span>
  <span class="kr">end</span>
<span class="kr">end</span>

<span class="n">DosDatetime</span><span class="p">.</span><span class="n">Time</span><span class="p">.</span><span class="n">property</span><span class="p">.</span><span class="n">second</span> <span class="o">=</span> <span class="p">{}</span>
<span class="kr">function</span> <span class="nc">DosDatetime</span><span class="p">.</span><span class="nc">Time</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">second</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
  <span class="kr">if</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_second</span> <span class="o">~=</span> <span class="kc">nil</span> <span class="kr">then</span>
    <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_second</span>
  <span class="kr">end</span>

  <span class="n">self</span><span class="p">.</span><span class="n">_m_second</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">second_div_2</span><span class="p">)</span>
  <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_second</span>
<span class="kr">end</span>

<span class="n">DosDatetime</span><span class="p">.</span><span class="n">Time</span><span class="p">.</span><span class="n">property</span><span class="p">.</span><span class="n">padded_second</span> <span class="o">=</span> <span class="p">{}</span>
<span class="kr">function</span> <span class="nc">DosDatetime</span><span class="p">.</span><span class="nc">Time</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">padded_second</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
  <span class="kr">if</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_second</span> <span class="o">~=</span> <span class="kc">nil</span> <span class="kr">then</span>
    <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_second</span>
  <span class="kr">end</span>

  <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_second</span> <span class="o">=</span> <span class="n">utils</span><span class="p">.</span><span class="n">box_unwrap</span><span class="p">((</span><span class="n">self</span><span class="p">.</span><span class="n">second</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">)</span> <span class="ow">and</span> <span class="n">utils</span><span class="p">.</span><span class="n">box_wrap</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">second</span><span class="p">)</span>
  <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_second</span>
<span class="kr">end</span>

<span class="n">DosDatetime</span><span class="p">.</span><span class="n">Time</span><span class="p">.</span><span class="n">property</span><span class="p">.</span><span class="n">padded_minute</span> <span class="o">=</span> <span class="p">{}</span>
<span class="kr">function</span> <span class="nc">DosDatetime</span><span class="p">.</span><span class="nc">Time</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">padded_minute</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
  <span class="kr">if</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_minute</span> <span class="o">~=</span> <span class="kc">nil</span> <span class="kr">then</span>
    <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_minute</span>
  <span class="kr">end</span>

  <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_minute</span> <span class="o">=</span> <span class="n">utils</span><span class="p">.</span><span class="n">box_unwrap</span><span class="p">((</span><span class="n">self</span><span class="p">.</span><span class="n">minute</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">)</span> <span class="ow">and</span> <span class="n">utils</span><span class="p">.</span><span class="n">box_wrap</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">minute</span><span class="p">)</span>
  <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_minute</span>
<span class="kr">end</span>

<span class="n">DosDatetime</span><span class="p">.</span><span class="n">Time</span><span class="p">.</span><span class="n">property</span><span class="p">.</span><span class="n">padded_hour</span> <span class="o">=</span> <span class="p">{}</span>
<span class="kr">function</span> <span class="nc">DosDatetime</span><span class="p">.</span><span class="nc">Time</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">padded_hour</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
  <span class="kr">if</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_hour</span> <span class="o">~=</span> <span class="kc">nil</span> <span class="kr">then</span>
    <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_hour</span>
  <span class="kr">end</span>

  <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_hour</span> <span class="o">=</span> <span class="n">utils</span><span class="p">.</span><span class="n">box_unwrap</span><span class="p">((</span><span class="n">self</span><span class="p">.</span><span class="n">hour</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">)</span> <span class="ow">and</span> <span class="n">utils</span><span class="p">.</span><span class="n">box_wrap</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">hour</span><span class="p">)</span>
  <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_hour</span>
<span class="kr">end</span>


<span class="n">DosDatetime</span><span class="p">.</span><span class="n">Date</span> <span class="o">=</span> <span class="n">class</span><span class="p">.</span><span class="n">class</span><span class="p">(</span><span class="n">KaitaiStruct</span><span class="p">)</span>

<span class="kr">function</span> <span class="nc">DosDatetime</span><span class="p">.</span><span class="nc">Date</span><span class="p">:</span><span class="nf">_init</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">root</span><span class="p">)</span>
  <span class="n">KaitaiStruct</span><span class="p">.</span><span class="n">_init</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">io</span><span class="p">)</span>
  <span class="n">self</span><span class="p">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
  <span class="n">self</span><span class="p">.</span><span class="n">_root</span> <span class="o">=</span> <span class="n">root</span> <span class="ow">or</span> <span class="n">self</span>
  <span class="n">self</span><span class="p">:</span><span class="n">_read</span><span class="p">()</span>
<span class="kr">end</span>

<span class="kr">function</span> <span class="nc">DosDatetime</span><span class="p">.</span><span class="nc">Date</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
  <span class="n">self</span><span class="p">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">_io</span><span class="p">:</span><span class="n">read_bits_int_le</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
  <span class="kr">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">day</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="kr">then</span>
    <span class="nb">error</span><span class="p">(</span><span class="s2">&quot;ValidationLessThanError&quot;</span><span class="p">)</span>
  <span class="kr">end</span>
  <span class="n">self</span><span class="p">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">_io</span><span class="p">:</span><span class="n">read_bits_int_le</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
  <span class="kr">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">month</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="kr">then</span>
    <span class="nb">error</span><span class="p">(</span><span class="s2">&quot;ValidationLessThanError&quot;</span><span class="p">)</span>
  <span class="kr">end</span>
  <span class="kr">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">month</span> <span class="o">&lt;=</span> <span class="mi">12</span><span class="p">)</span> <span class="kr">then</span>
    <span class="nb">error</span><span class="p">(</span><span class="s2">&quot;ValidationGreaterThanError&quot;</span><span class="p">)</span>
  <span class="kr">end</span>
  <span class="n">self</span><span class="p">.</span><span class="n">year_minus_1980</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">_io</span><span class="p">:</span><span class="n">read_bits_int_le</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="kr">end</span>

<span class="c1">-- </span>
<span class="c1">-- only years from 1980 to 2107 (1980 + 127) can be represented.</span>
<span class="n">DosDatetime</span><span class="p">.</span><span class="n">Date</span><span class="p">.</span><span class="n">property</span><span class="p">.</span><span class="n">year</span> <span class="o">=</span> <span class="p">{}</span>
<span class="kr">function</span> <span class="nc">DosDatetime</span><span class="p">.</span><span class="nc">Date</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">year</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
  <span class="kr">if</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_year</span> <span class="o">~=</span> <span class="kc">nil</span> <span class="kr">then</span>
    <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_year</span>
  <span class="kr">end</span>

  <span class="n">self</span><span class="p">.</span><span class="n">_m_year</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1980</span> <span class="o">+</span> <span class="n">self</span><span class="p">.</span><span class="n">year_minus_1980</span><span class="p">)</span>
  <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_year</span>
<span class="kr">end</span>

<span class="n">DosDatetime</span><span class="p">.</span><span class="n">Date</span><span class="p">.</span><span class="n">property</span><span class="p">.</span><span class="n">padded_day</span> <span class="o">=</span> <span class="p">{}</span>
<span class="kr">function</span> <span class="nc">DosDatetime</span><span class="p">.</span><span class="nc">Date</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">padded_day</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
  <span class="kr">if</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_day</span> <span class="o">~=</span> <span class="kc">nil</span> <span class="kr">then</span>
    <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_day</span>
  <span class="kr">end</span>

  <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_day</span> <span class="o">=</span> <span class="n">utils</span><span class="p">.</span><span class="n">box_unwrap</span><span class="p">((</span><span class="n">self</span><span class="p">.</span><span class="n">day</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">)</span> <span class="ow">and</span> <span class="n">utils</span><span class="p">.</span><span class="n">box_wrap</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">day</span><span class="p">)</span>
  <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_day</span>
<span class="kr">end</span>

<span class="n">DosDatetime</span><span class="p">.</span><span class="n">Date</span><span class="p">.</span><span class="n">property</span><span class="p">.</span><span class="n">padded_month</span> <span class="o">=</span> <span class="p">{}</span>
<span class="kr">function</span> <span class="nc">DosDatetime</span><span class="p">.</span><span class="nc">Date</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">padded_month</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
  <span class="kr">if</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_month</span> <span class="o">~=</span> <span class="kc">nil</span> <span class="kr">then</span>
    <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_month</span>
  <span class="kr">end</span>

  <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_month</span> <span class="o">=</span> <span class="n">utils</span><span class="p">.</span><span class="n">box_unwrap</span><span class="p">((</span><span class="n">self</span><span class="p">.</span><span class="n">month</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">)</span> <span class="ow">and</span> <span class="n">utils</span><span class="p">.</span><span class="n">box_wrap</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">month</span><span class="p">)</span>
  <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_month</span>
<span class="kr">end</span>

<span class="n">DosDatetime</span><span class="p">.</span><span class="n">Date</span><span class="p">.</span><span class="n">property</span><span class="p">.</span><span class="n">padded_year</span> <span class="o">=</span> <span class="p">{}</span>
<span class="kr">function</span> <span class="nc">DosDatetime</span><span class="p">.</span><span class="nc">Date</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">padded_year</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
  <span class="kr">if</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_year</span> <span class="o">~=</span> <span class="kc">nil</span> <span class="kr">then</span>
    <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_year</span>
  <span class="kr">end</span>

  <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_year</span> <span class="o">=</span> <span class="n">utils</span><span class="p">.</span><span class="n">box_unwrap</span><span class="p">((</span><span class="n">self</span><span class="p">.</span><span class="n">year</span> <span class="o">&lt;=</span> <span class="mi">999</span><span class="p">)</span> <span class="ow">and</span> <span class="n">utils</span><span class="p">.</span><span class="n">box_wrap</span><span class="p">(</span><span class="s2">&quot;0&quot;</span> <span class="o">..</span> <span class="n">utils</span><span class="p">.</span><span class="n">box_unwrap</span><span class="p">((</span><span class="n">self</span><span class="p">.</span><span class="n">year</span> <span class="o">&lt;=</span> <span class="mi">99</span><span class="p">)</span> <span class="ow">and</span> <span class="n">utils</span><span class="p">.</span><span class="n">box_wrap</span><span class="p">(</span><span class="s2">&quot;0&quot;</span> <span class="o">..</span> <span class="n">utils</span><span class="p">.</span><span class="n">box_unwrap</span><span class="p">((</span><span class="n">self</span><span class="p">.</span><span class="n">year</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">)</span> <span class="ow">and</span> <span class="n">utils</span><span class="p">.</span><span class="n">box_wrap</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)))</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)))</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">year</span><span class="p">)</span>
  <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">_m_padded_year</span>
<span class="kr">end</span>
</pre></div>

        </div>
        
    </div>
</section>

    <footer id="main-footer">
        <div class="container">
            &copy; 2015&ndash;2023 Kaitai Project and <a href="https://github.com/kaitai-io/kaitai_struct_formats/graphs/contributors">format repo contributors</a>

            <h3>Contacts</h3>

            <div class="row">
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-github"></i> <a href="https://github.com/kaitai-io/kaitai_struct">GitHub</a>
                </div>
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-twitter"></i> <a href="https://twitter.com/kaitai_io">@kaitai_io</a>
                </div>
                <div class="col-sm-4">
                    Gitter: <a href="https://gitter.im/kaitai_struct/Lobby">kaitai_struct</a>
                </div>
            </div>
        </div>
    </footer>

  <script src="//kaitai.io/js/jquery-1.12.3.min.js"></script>
  <script src="//kaitai.io/js/bootstrap.min.js"></script>

  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-76299550-1', 'auto');
      ga('send', 'pageview');
  </script>
</body>
</html>
