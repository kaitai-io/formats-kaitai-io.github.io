<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Quake II player model (version 8): Lua parsing library</title>
  <meta name="keywords" content="kaitai,struct,binary,format,parsing,decoding,java,javascript,python,ruby,library,metadata">
  <meta name="description" content="Kaitai Struct is a formal language for binary format specification that can be compiled into parser code">

  <link rel="stylesheet" href="//kaitai.io/styles/bootstrap.min.css">
  <link rel="stylesheet" href="//kaitai.io/styles/bootstrap-theme.min.css">
  <link href='https://fonts.googleapis.com/css?family=Exo:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Share+Tech+Mono' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  <link rel="stylesheet" href="//kaitai.io/styles/main.css" type="text/css">
  <link rel="stylesheet" href="/pygments-default.css" type="text/css">
  <style>
.diagram-img {
    display: block;
    max-width: 100%;
    height: auto;
    margin: 0 auto;
}

section.format {
    padding: 30px 0;
}

section#format-meta, section#format-index-header {
    background: #e3eef7;
}

section#format-diagram, section#format-index-footer {
    background: #e9f8dd;
}

section#format-ksy, section#format-lang {
    background: #d1eadd;
}

section#format-index .row {
    padding-bottom: 10px;
}

  </style>
</head>
<body data-spy="scroll" data-target="#main-navbar" data-offset="100">

    <nav class="navbar navbar-inverse navbar-fixed-top" id="main-navbar">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-navbar-collapse" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <span class="navbar-brand">Kaitai Struct</span>
            </div>
            <div class="collapse navbar-collapse" id="main-navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="//kaitai.io/#what-is-it">What is it?</a></li>
                    <li><a href="//kaitai.io/#quick-start">Quick Start</a></li>
                    <li><a href="//kaitai.io/#download">Download</a></li>
                    <li><a href="//kaitai.io/news/">News</a></li>
                    <li class="active"><a href="//formats.kaitai.io/">Format Gallery</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="https://ide.kaitai.io/">Try it &mdash; Web IDE</a></li>
                    <li><a href="//doc.kaitai.io/">Documentation</a></li>
                </ul>
            </div>
        </div>
    </nav>
<nav>
    <div class="container">
    <ol class="breadcrumb">
        <li><a href="../">Format Gallery</a></li>
        <li>Game Data Files</li>
        <li class="active">Quake II player model (version 8)</li>
    </ol>
    </div>
</nav>

<section id="format-meta" class="format">
    <div class="container">
        <h1>Quake II player model (version 8):
            
            Lua parsing library
            
        </h1>

        <div class="row">
            <div class="col-md-8">
                <p><p>The MD2 format is used for 3D animated models in id Sofware's Quake II.</p>
<p>A model consists of named <code>frames</code>, each with the same number of <code>vertices</code>
(<code>vertices_per_frame</code>). Each such vertex has a <code>position</code> and <code>normal</code> in
model space. Each vertex has the same topological &quot;meaning&quot; across frames, in
terms of triangle and texture info; it just varies in position and normal for
animation purposes.</p>
<p>How the vertices form triangles is defined via disjoint <code>triangles</code> or via
<code>gl_cmds</code> (which allows strip and fan topology). Each triangle contains three
<code>vertex_indices</code> into frame vertices, and three <code>tex_point_indices</code> into
global <code>tex_coords</code>. Each texture point has pixel coords <code>s_px</code> and <code>t_px</code>
ranging from 0 to <code>skin_{width,height}_px</code> respectively, along with
<code>{s,t}_normalized</code> ranging from 0 to 1 for your convenience.</p>
<p>A GL command has a <code>primitive</code> type (<code>TRIANGLE_FAN</code> or <code>TRIANGLE_STRIP</code>) along
with some <code>vertices</code>. Each GL vertex contains <code>tex_coords_normalized</code> from 0
to 1, and a <code>vertex_index</code> into frame vertices.</p>
<p>A model may also contain <code>skins</code>, which are just file paths to PCX images.
However, this is empty for many models, in which case it is up to the client
(e.g. Q2PRO) to offer skins some other way (e.g. by similar filename in the
current directory).</p>
<p>There are 198 <code>frames</code> in total, partitioned into a fixed set of ranges used
for different animations. Each frame has a standard <code>name</code> for humans, but the
client just uses their index and the name can be arbitrary. The name, start
frame index and frame count of each animation can be looked up in the arrays
<code>anim_names</code>, <code>anim_start_indices</code>, and <code>anim_num_frames</code> respectively. This
information is summarized in the following table:</p>
<pre style="background-color:#2b303b;"><code><span style="color:#c0c5ce;">|   INDEX  |    NAME | SUFFIX | NOTES                                                  |
</span><span style="color:#c0c5ce;">|:--------:|--------:|:-------|:-------------------------------------------------------|
</span><span style="color:#c0c5ce;">|    0-39  |   stand | 01-40  | Idle animation                                         |
</span><span style="color:#c0c5ce;">|   40-45  |     run | 1-6    | Full run cycle                                         |
</span><span style="color:#c0c5ce;">|   46-53  |  attack | 1-8    | Shoot, reload; some weapons just repeat 1st few frames |
</span><span style="color:#c0c5ce;">|   54-57  |   pain1 | 01-04  | Q2Pro also uses this for switching weapons             |
</span><span style="color:#c0c5ce;">|   58-61  |   pain2 | 01-04  |                                                        |
</span><span style="color:#c0c5ce;">|   62-65  |   pain3 | 01-04  |                                                        |
</span><span style="color:#c0c5ce;">|   66-71  |    jump | 1-6    | Starts at height and lands on feet                     |
</span><span style="color:#c0c5ce;">|   72-83  |    flip | 01-12  | Flipoff, i.e. middle finger                            |
</span><span style="color:#c0c5ce;">|   84-94  |  salute | 01-11  |                                                        |
</span><span style="color:#c0c5ce;">|   95-111 |   taunt | 01-17  |                                                        |
</span><span style="color:#c0c5ce;">|  112-122 |    wave | 01-11  | Q2Pro plays this backwards for a handgrenade toss      |
</span><span style="color:#c0c5ce;">|  123-134 |   point | 01-12  |                                                        |
</span><span style="color:#c0c5ce;">|  135-153 |  crstnd | 01-19  | Idle while crouching                                   |
</span><span style="color:#c0c5ce;">|  154-159 |  crwalk | 1-6    |                                                        |
</span><span style="color:#c0c5ce;">|  160-168 | crattak | 1-9    |                                                        |
</span><span style="color:#c0c5ce;">|  169-172 |  crpain | 1-4    |                                                        |
</span><span style="color:#c0c5ce;">|  173-177 | crdeath | 1-5    |                                                        |
</span><span style="color:#c0c5ce;">|  178-183 |  death1 | 01-06  |                                                        |
</span><span style="color:#c0c5ce;">|  184-189 |  death2 | 01-06  |                                                        |
</span><span style="color:#c0c5ce;">|  190-197 |  death3 | 01-08  |                                                        |
</span></code></pre>
<p>The above are filled in for player models; for the separate weapon models,
the final frame is 173 &quot;g_view&quot; (unknown purpose) since weapons aren't shown
during death animations. <code>a_grenades.md2</code>, the handgrenade weapon model, is
the same except that the <code>wave</code> frames are blank (according to the default
female model files). This is likely due to its dual use as a grenade throw
animation where this model must leave the player's model.</p>
</p>
            </div>
            <div class="col-md-4">
                <div class="panel panel-info">
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">Application</h3>
                    </div>
                    <div class="panel-body">
                        Quake II
                    </div>
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">File extension</h3>
                    </div>
                    <div class="panel-body">
                        md2
                    </div>
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">KS implementation details</h3>
                    </div>
                    
                    <div class="panel-body">
                        License: <a href="https://spdx.org/licenses/CC0-1.0.html">CC0-1.0</a>
                    </div>
                    
                    
                    
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">References</h3>
                    </div>
                    <div class="panel-body">
                        <ul>
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <li><a href="http://fileformats.archiveteam.org/wiki/MD2">MD2 in Just Solve the File Format Problem</a></li>
                            
                        </ul>
                    </div>
                    
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
            <p>
            This page hosts a formal specification of Quake II player model (version 8)
            using <a href="//kaitai.io">Kaitai Struct</a>. This
            specification can be automatically translated into a
            variety of programming languages to get a parsing library.
            </p>

            <ul class="nav nav-pills">
                
                
                <li>
                
                <a href="index.html" title="Quake II player model (version 8) parsing Overview library">Overview</a></li>
                
                
                <li>
                
                <a href="cpp_stl_11.html" title="Quake II player model (version 8) parsing C++11/STL library">C++11/STL</a></li>
                
                
                <li>
                
                <a href="csharp.html" title="Quake II player model (version 8) parsing C# library">C#</a></li>
                
                
                <li>
                
                <a href="go.html" title="Quake II player model (version 8) parsing Go library">Go</a></li>
                
                
                <li>
                
                <a href="graphviz.html" title="Quake II player model (version 8) parsing GraphViz library">GraphViz</a></li>
                
                
                <li>
                
                <a href="java.html" title="Quake II player model (version 8) parsing Java library">Java</a></li>
                
                
                <li>
                
                <a href="java-write.html" title="Quake II player model (version 8) parsing Java (read-write) library">Java (read-write)</a></li>
                
                
                <li>
                
                <a href="javascript.html" title="Quake II player model (version 8) parsing JavaScript library">JavaScript</a></li>
                
                
                <li class="active">
                
                <a href="lua.html" title="Quake II player model (version 8) parsing Lua library">Lua</a></li>
                
                
                <li>
                
                <a href="nim.html" title="Quake II player model (version 8) parsing Nim library">Nim</a></li>
                
                
                <li>
                
                <a href="perl.html" title="Quake II player model (version 8) parsing Perl library">Perl</a></li>
                
                
                <li>
                
                <a href="php.html" title="Quake II player model (version 8) parsing PHP library">PHP</a></li>
                
                
                <li>
                
                <a href="python.html" title="Quake II player model (version 8) parsing Python library">Python</a></li>
                
                
                <li>
                
                <a href="python-write.html" title="Quake II player model (version 8) parsing Python (read-write) library">Python (read-write)</a></li>
                
                
                <li>
                
                <a href="ruby.html" title="Quake II player model (version 8) parsing Ruby library">Ruby</a></li>
                
                
                <li>
                
                <a href="rust.html" title="Quake II player model (version 8) parsing Rust library">Rust</a></li>
                
            </ul>
            </div>
        </div>
    </div>
</section>


<section id="format-lang" class="format">
    <div class="container">
        <h2>
            
            Lua source code to parse Quake II player model (version 8)
            
        </h2>

        

        <h3>quake2_md2.lua</h3>

        <div class="row">
            <div class="pull-right">
                <p>
                    <a href="src/lua/quake2_md2.lua" download="quake2_md2.lua" class="btn btn-success">Download <i class="fa fa-download"></i></a>
                </p>
            </div>
        </div>

        <div class="row">
            <div class="highlight"><pre><span></span><span class="c1">-- This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild</span>
<span class="c1">--</span>
<span class="c1">-- This file is compatible with Lua 5.3</span>

<span class="kd">local</span><span class="w"> </span><span class="nv">class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">)</span>
<span class="nb">require</span><span class="p">(</span><span class="s2">&quot;kaitaistruct&quot;</span><span class="p">)</span>
<span class="kd">local</span><span class="w"> </span><span class="nv">enum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="p">(</span><span class="s2">&quot;enum&quot;</span><span class="p">)</span>
<span class="kd">local</span><span class="w"> </span><span class="nv">stringstream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="p">(</span><span class="s2">&quot;string_stream&quot;</span><span class="p">)</span>
<span class="kd">local</span><span class="w"> </span><span class="nv">str_decode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="p">(</span><span class="s2">&quot;string_decode&quot;</span><span class="p">)</span>
<span class="kd">local</span><span class="w"> </span><span class="nv">utils</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="p">(</span><span class="s2">&quot;utils&quot;</span><span class="p">)</span>

<span class="c1">-- </span>
<span class="c1">-- The MD2 format is used for 3D animated models in id Sofware&#39;s Quake II.</span>
<span class="c1">-- </span>
<span class="c1">-- A model consists of named `frames`, each with the same number of `vertices`</span>
<span class="c1">-- (`vertices_per_frame`). Each such vertex has a `position` and `normal` in</span>
<span class="c1">-- model space. Each vertex has the same topological &quot;meaning&quot; across frames, in</span>
<span class="c1">-- terms of triangle and texture info; it just varies in position and normal for</span>
<span class="c1">-- animation purposes.</span>
<span class="c1">-- </span>
<span class="c1">-- How the vertices form triangles is defined via disjoint `triangles` or via</span>
<span class="c1">-- `gl_cmds` (which allows strip and fan topology). Each triangle contains three</span>
<span class="c1">-- `vertex_indices` into frame vertices, and three `tex_point_indices` into</span>
<span class="c1">-- global `tex_coords`. Each texture point has pixel coords `s_px` and `t_px`</span>
<span class="c1">-- ranging from 0 to `skin_{width,height}_px` respectively, along with</span>
<span class="c1">-- `{s,t}_normalized` ranging from 0 to 1 for your convenience.</span>
<span class="c1">-- </span>
<span class="c1">-- A GL command has a `primitive` type (`TRIANGLE_FAN` or `TRIANGLE_STRIP`) along</span>
<span class="c1">-- with some `vertices`. Each GL vertex contains `tex_coords_normalized` from 0</span>
<span class="c1">-- to 1, and a `vertex_index` into frame vertices.</span>
<span class="c1">-- </span>
<span class="c1">-- A model may also contain `skins`, which are just file paths to PCX images.</span>
<span class="c1">-- However, this is empty for many models, in which case it is up to the client</span>
<span class="c1">-- (e.g. Q2PRO) to offer skins some other way (e.g. by similar filename in the</span>
<span class="c1">-- current directory).</span>
<span class="c1">-- </span>
<span class="c1">-- There are 198 `frames` in total, partitioned into a fixed set of ranges used</span>
<span class="c1">-- for different animations. Each frame has a standard `name` for humans, but the</span>
<span class="c1">-- client just uses their index and the name can be arbitrary. The name, start</span>
<span class="c1">-- frame index and frame count of each animation can be looked up in the arrays</span>
<span class="c1">-- `anim_names`, `anim_start_indices`, and `anim_num_frames` respectively. This</span>
<span class="c1">-- information is summarized in the following table:</span>
<span class="c1">-- </span>
<span class="c1">-- ```</span>
<span class="c1">-- |   INDEX  |    NAME | SUFFIX | NOTES                                                  |</span>
<span class="c1">-- |:--------:|--------:|:-------|:-------------------------------------------------------|</span>
<span class="c1">-- |    0-39  |   stand | 01-40  | Idle animation                                         |</span>
<span class="c1">-- |   40-45  |     run | 1-6    | Full run cycle                                         |</span>
<span class="c1">-- |   46-53  |  attack | 1-8    | Shoot, reload; some weapons just repeat 1st few frames |</span>
<span class="c1">-- |   54-57  |   pain1 | 01-04  | Q2Pro also uses this for switching weapons             |</span>
<span class="c1">-- |   58-61  |   pain2 | 01-04  |                                                        |</span>
<span class="c1">-- |   62-65  |   pain3 | 01-04  |                                                        |</span>
<span class="c1">-- |   66-71  |    jump | 1-6    | Starts at height and lands on feet                     |</span>
<span class="c1">-- |   72-83  |    flip | 01-12  | Flipoff, i.e. middle finger                            |</span>
<span class="c1">-- |   84-94  |  salute | 01-11  |                                                        |</span>
<span class="c1">-- |   95-111 |   taunt | 01-17  |                                                        |</span>
<span class="c1">-- |  112-122 |    wave | 01-11  | Q2Pro plays this backwards for a handgrenade toss      |</span>
<span class="c1">-- |  123-134 |   point | 01-12  |                                                        |</span>
<span class="c1">-- |  135-153 |  crstnd | 01-19  | Idle while crouching                                   |</span>
<span class="c1">-- |  154-159 |  crwalk | 1-6    |                                                        |</span>
<span class="c1">-- |  160-168 | crattak | 1-9    |                                                        |</span>
<span class="c1">-- |  169-172 |  crpain | 1-4    |                                                        |</span>
<span class="c1">-- |  173-177 | crdeath | 1-5    |                                                        |</span>
<span class="c1">-- |  178-183 |  death1 | 01-06  |                                                        |</span>
<span class="c1">-- |  184-189 |  death2 | 01-06  |                                                        |</span>
<span class="c1">-- |  190-197 |  death3 | 01-08  |                                                        |</span>
<span class="c1">-- ```</span>
<span class="c1">-- </span>
<span class="c1">-- The above are filled in for player models; for the separate weapon models,</span>
<span class="c1">-- the final frame is 173 &quot;g_view&quot; (unknown purpose) since weapons aren&#39;t shown</span>
<span class="c1">-- during death animations. `a_grenades.md2`, the handgrenade weapon model, is</span>
<span class="c1">-- the same except that the `wave` frames are blank (according to the default</span>
<span class="c1">-- female model files). This is likely due to its dual use as a grenade throw</span>
<span class="c1">-- animation where this model must leave the player&#39;s model.</span>
<span class="c1">-- See also: Source (https://icculus.org/~phaethon/q3a/formats/md2-schoenblum.html)</span>
<span class="c1">-- See also: Source (http://tfc.duke.free.fr/coding/md2-specs-en.html)</span>
<span class="c1">-- See also: Source (http://tastyspleen.net/~panjoo/downloads/quake2_model_frames.html)</span>
<span class="c1">-- See also: Source (http://wiki.polycount.com/wiki/OldSiteResourcesQuake2FramesList)</span>
<span class="nv">Quake2Md2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">class</span><span class="p">.</span><span class="nf">class</span><span class="p">(</span><span class="nv">KaitaiStruct</span><span class="p">)</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">GlPrimitive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">enum</span><span class="p">.</span><span class="py">Enum</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nv">triangle_strip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">  </span><span class="nv">triangle_fan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="p">}</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">:</span><span class="nf">_init</span><span class="p">(</span><span class="nv">io</span><span class="p">,</span><span class="w"> </span><span class="nv">parent</span><span class="p">,</span><span class="w"> </span><span class="nv">root</span><span class="p">)</span>
<span class="w">  </span><span class="nv">KaitaiStruct</span><span class="p">.</span><span class="nf">_init</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">io</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">parent</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">root</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nv">self</span>
<span class="w">  </span><span class="nv">self</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">magic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_bytes</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="ow">not</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">magic</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\073\068\080\050</span><span class="s2">&quot;</span><span class="p">)</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="nb">error</span><span class="p">(</span><span class="s2">&quot;not equal, expected &quot;</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\073\068\080\050</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="s2">&quot;, but got &quot;</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">magic</span><span class="p">)</span>
<span class="w">  </span><span class="kr">end</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u4le</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="ow">not</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">version</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="nb">error</span><span class="p">(</span><span class="s2">&quot;not equal, expected &quot;</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="s2">&quot;, but got &quot;</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">version</span><span class="p">)</span>
<span class="w">  </span><span class="kr">end</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">skin_width_px</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u4le</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">skin_height_px</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u4le</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">bytes_per_frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u4le</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">num_skins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u4le</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">vertices_per_frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u4le</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">num_tex_coords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u4le</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">num_triangles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u4le</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">num_gl_cmds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u4le</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">num_frames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u4le</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">ofs_skins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u4le</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">ofs_tex_coords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u4le</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">ofs_triangles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u4le</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">ofs_frames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u4le</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">ofs_gl_cmds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u4le</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">ofs_eof</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u4le</span><span class="p">()</span>
<span class="kr">end</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">property</span><span class="p">.</span><span class="py">anim_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">anim_names</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_anim_names</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_anim_names</span>
<span class="w">  </span><span class="kr">end</span>

<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_anim_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;stand&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;run&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;attack&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;pain1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;pain2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;pain3&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;jump&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;flip&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;salute&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;taunt&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wave&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;point&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;crstnd&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;crwalk&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;crattak&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;crpain&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;crdeath&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;death1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;death2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;death3&quot;</span><span class="p">}</span>
<span class="w">  </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_anim_names</span>
<span class="kr">end</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">property</span><span class="p">.</span><span class="py">anim_num_frames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">anim_num_frames</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_anim_num_frames</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_anim_num_frames</span>
<span class="w">  </span><span class="kr">end</span>

<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_anim_num_frames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\040\006\008\004\004\004\006\012\011\017\011\012\019\006\009\004\005\006\006\008</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_anim_num_frames</span>
<span class="kr">end</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">property</span><span class="p">.</span><span class="py">anim_start_indices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">anim_start_indices</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_anim_start_indices</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_anim_start_indices</span>
<span class="w">  </span><span class="kr">end</span>

<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_anim_start_indices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\000\040\046\054\058\062\066\072\084\095\112\123\135\154\160\169\173\178\184\190</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_anim_start_indices</span>
<span class="kr">end</span>

<span class="c1">-- </span>
<span class="c1">-- See also: Quake anorms.h (https://github.com/skullernet/q2pro/blob/f4faabd/src/common/math.c#L80</span>
<span class="c1">-- from)</span>
<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">property</span><span class="p">.</span><span class="py">anorms_table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">anorms_table</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_anorms_table</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_anorms_table</span>
<span class="w">  </span><span class="kr">end</span>

<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_anorms_table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="o">-</span><span class="mf">0.525731</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.850651</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.442863</span><span class="p">,</span><span class="w"> </span><span class="mf">0.238856</span><span class="p">,</span><span class="w"> </span><span class="mf">0.864188</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.295242</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.955423</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.309017</span><span class="p">,</span><span class="w"> </span><span class="mf">0.500000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.809017</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.162460</span><span class="p">,</span><span class="w"> </span><span class="mf">0.262866</span><span class="p">,</span><span class="w"> </span><span class="mf">0.951056</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">1.000000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.850651</span><span class="p">,</span><span class="w"> </span><span class="mf">0.525731</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.147621</span><span class="p">,</span><span class="w"> </span><span class="mf">0.716567</span><span class="p">,</span><span class="w"> </span><span class="mf">0.681718</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.147621</span><span class="p">,</span><span class="w"> </span><span class="mf">0.716567</span><span class="p">,</span><span class="w"> </span><span class="mf">0.681718</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.525731</span><span class="p">,</span><span class="w"> </span><span class="mf">0.850651</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.309017</span><span class="p">,</span><span class="w"> </span><span class="mf">0.500000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.809017</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.525731</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.850651</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.295242</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.955423</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.442863</span><span class="p">,</span><span class="w"> </span><span class="mf">0.238856</span><span class="p">,</span><span class="w"> </span><span class="mf">0.864188</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.162460</span><span class="p">,</span><span class="w"> </span><span class="mf">0.262866</span><span class="p">,</span><span class="w"> </span><span class="mf">0.951056</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.681718</span><span class="p">,</span><span class="w"> </span><span class="mf">0.147621</span><span class="p">,</span><span class="w"> </span><span class="mf">0.716567</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.809017</span><span class="p">,</span><span class="w"> </span><span class="mf">0.309017</span><span class="p">,</span><span class="w"> </span><span class="mf">0.500000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.587785</span><span class="p">,</span><span class="w"> </span><span class="mf">0.425325</span><span class="p">,</span><span class="w"> </span><span class="mf">0.688191</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.850651</span><span class="p">,</span><span class="w"> </span><span class="mf">0.525731</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.864188</span><span class="p">,</span><span class="w"> </span><span class="mf">0.442863</span><span class="p">,</span><span class="w"> </span><span class="mf">0.238856</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.716567</span><span class="p">,</span><span class="w"> </span><span class="mf">0.681718</span><span class="p">,</span><span class="w"> </span><span class="mf">0.147621</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.688191</span><span class="p">,</span><span class="w"> </span><span class="mf">0.587785</span><span class="p">,</span><span class="w"> </span><span class="mf">0.425325</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.500000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.809017</span><span class="p">,</span><span class="w"> </span><span class="mf">0.309017</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.238856</span><span class="p">,</span><span class="w"> </span><span class="mf">0.864188</span><span class="p">,</span><span class="w"> </span><span class="mf">0.442863</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.425325</span><span class="p">,</span><span class="w"> </span><span class="mf">0.688191</span><span class="p">,</span><span class="w"> </span><span class="mf">0.587785</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.716567</span><span class="p">,</span><span class="w"> </span><span class="mf">0.681718</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.147621</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.500000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.809017</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.309017</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.525731</span><span class="p">,</span><span class="w"> </span><span class="mf">0.850651</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.850651</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.525731</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.238856</span><span class="p">,</span><span class="w"> </span><span class="mf">0.864188</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.442863</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.955423</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.295242</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.262866</span><span class="p">,</span><span class="w"> </span><span class="mf">0.951056</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.162460</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">1.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.955423</span><span class="p">,</span><span class="w"> </span><span class="mf">0.295242</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.262866</span><span class="p">,</span><span class="w"> </span><span class="mf">0.951056</span><span class="p">,</span><span class="w"> </span><span class="mf">0.162460</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.238856</span><span class="p">,</span><span class="w"> </span><span class="mf">0.864188</span><span class="p">,</span><span class="w"> </span><span class="mf">0.442863</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.262866</span><span class="p">,</span><span class="w"> </span><span class="mf">0.951056</span><span class="p">,</span><span class="w"> </span><span class="mf">0.162460</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.500000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.809017</span><span class="p">,</span><span class="w"> </span><span class="mf">0.309017</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.238856</span><span class="p">,</span><span class="w"> </span><span class="mf">0.864188</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.442863</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.262866</span><span class="p">,</span><span class="w"> </span><span class="mf">0.951056</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.162460</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.500000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.809017</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.309017</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.850651</span><span class="p">,</span><span class="w"> </span><span class="mf">0.525731</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.716567</span><span class="p">,</span><span class="w"> </span><span class="mf">0.681718</span><span class="p">,</span><span class="w"> </span><span class="mf">0.147621</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.716567</span><span class="p">,</span><span class="w"> </span><span class="mf">0.681718</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.147621</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.525731</span><span class="p">,</span><span class="w"> </span><span class="mf">0.850651</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.425325</span><span class="p">,</span><span class="w"> </span><span class="mf">0.688191</span><span class="p">,</span><span class="w"> </span><span class="mf">0.587785</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.864188</span><span class="p">,</span><span class="w"> </span><span class="mf">0.442863</span><span class="p">,</span><span class="w"> </span><span class="mf">0.238856</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.688191</span><span class="p">,</span><span class="w"> </span><span class="mf">0.587785</span><span class="p">,</span><span class="w"> </span><span class="mf">0.425325</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.809017</span><span class="p">,</span><span class="w"> </span><span class="mf">0.309017</span><span class="p">,</span><span class="w"> </span><span class="mf">0.500000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.681718</span><span class="p">,</span><span class="w"> </span><span class="mf">0.147621</span><span class="p">,</span><span class="w"> </span><span class="mf">0.716567</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.587785</span><span class="p">,</span><span class="w"> </span><span class="mf">0.425325</span><span class="p">,</span><span class="w"> </span><span class="mf">0.688191</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.955423</span><span class="p">,</span><span class="w"> </span><span class="mf">0.295242</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">1.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.951056</span><span class="p">,</span><span class="w"> </span><span class="mf">0.162460</span><span class="p">,</span><span class="w"> </span><span class="mf">0.262866</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.850651</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.525731</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.955423</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.295242</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.864188</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.442863</span><span class="p">,</span><span class="w"> </span><span class="mf">0.238856</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.951056</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.162460</span><span class="p">,</span><span class="w"> </span><span class="mf">0.262866</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.809017</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.309017</span><span class="p">,</span><span class="w"> </span><span class="mf">0.500000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.681718</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.147621</span><span class="p">,</span><span class="w"> </span><span class="mf">0.716567</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.850651</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.525731</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.864188</span><span class="p">,</span><span class="w"> </span><span class="mf">0.442863</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.238856</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.809017</span><span class="p">,</span><span class="w"> </span><span class="mf">0.309017</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.500000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.951056</span><span class="p">,</span><span class="w"> </span><span class="mf">0.162460</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.262866</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.525731</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.850651</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.681718</span><span class="p">,</span><span class="w"> </span><span class="mf">0.147621</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.716567</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.681718</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.147621</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.716567</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.850651</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.525731</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.809017</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.309017</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.500000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.864188</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.442863</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.238856</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.951056</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.162460</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.262866</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.147621</span><span class="p">,</span><span class="w"> </span><span class="mf">0.716567</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.681718</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.309017</span><span class="p">,</span><span class="w"> </span><span class="mf">0.500000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.809017</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.425325</span><span class="p">,</span><span class="w"> </span><span class="mf">0.688191</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.587785</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.442863</span><span class="p">,</span><span class="w"> </span><span class="mf">0.238856</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.864188</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.587785</span><span class="p">,</span><span class="w"> </span><span class="mf">0.425325</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.688191</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.688191</span><span class="p">,</span><span class="w"> </span><span class="mf">0.587785</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.425325</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.147621</span><span class="p">,</span><span class="w"> </span><span class="mf">0.716567</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.681718</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.309017</span><span class="p">,</span><span class="w"> </span><span class="mf">0.500000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.809017</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.525731</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.850651</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.525731</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.850651</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.442863</span><span class="p">,</span><span class="w"> </span><span class="mf">0.238856</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.864188</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.295242</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.955423</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.162460</span><span class="p">,</span><span class="w"> </span><span class="mf">0.262866</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.951056</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">1.000000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.295242</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.955423</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.162460</span><span class="p">,</span><span class="w"> </span><span class="mf">0.262866</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.951056</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.442863</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.238856</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.864188</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.309017</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.500000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.809017</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.162460</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.262866</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.951056</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.850651</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.525731</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.147621</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.716567</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.681718</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.147621</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.716567</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.681718</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.525731</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.850651</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.309017</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.500000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.809017</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.442863</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.238856</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.864188</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.162460</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.262866</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.951056</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.238856</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.864188</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.442863</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.500000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.809017</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.309017</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.425325</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.688191</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.587785</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.716567</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.681718</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.147621</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.688191</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.587785</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.425325</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.587785</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.425325</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.688191</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.955423</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.295242</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">1.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.262866</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.951056</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.162460</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.850651</span><span class="p">,</span><span class="w"> </span><span class="mf">0.525731</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.955423</span><span class="p">,</span><span class="w"> </span><span class="mf">0.295242</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.238856</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.864188</span><span class="p">,</span><span class="w"> </span><span class="mf">0.442863</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.262866</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.951056</span><span class="p">,</span><span class="w"> </span><span class="mf">0.162460</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.500000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.809017</span><span class="p">,</span><span class="w"> </span><span class="mf">0.309017</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.716567</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.681718</span><span class="p">,</span><span class="w"> </span><span class="mf">0.147621</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.525731</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.850651</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.238856</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.864188</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.442863</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.500000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.809017</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.309017</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.262866</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.951056</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.162460</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.850651</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.525731</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.716567</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.681718</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.147621</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.716567</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.681718</span><span class="p">,</span><span class="w"> </span><span class="mf">0.147621</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.525731</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.850651</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.500000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.809017</span><span class="p">,</span><span class="w"> </span><span class="mf">0.309017</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.238856</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.864188</span><span class="p">,</span><span class="w"> </span><span class="mf">0.442863</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.262866</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.951056</span><span class="p">,</span><span class="w"> </span><span class="mf">0.162460</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.864188</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.442863</span><span class="p">,</span><span class="w"> </span><span class="mf">0.238856</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.809017</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.309017</span><span class="p">,</span><span class="w"> </span><span class="mf">0.500000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.688191</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.587785</span><span class="p">,</span><span class="w"> </span><span class="mf">0.425325</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.681718</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.147621</span><span class="p">,</span><span class="w"> </span><span class="mf">0.716567</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.442863</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.238856</span><span class="p">,</span><span class="w"> </span><span class="mf">0.864188</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.587785</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.425325</span><span class="p">,</span><span class="w"> </span><span class="mf">0.688191</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.309017</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.500000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.809017</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.147621</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.716567</span><span class="p">,</span><span class="w"> </span><span class="mf">0.681718</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.425325</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.688191</span><span class="p">,</span><span class="w"> </span><span class="mf">0.587785</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.162460</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.262866</span><span class="p">,</span><span class="w"> </span><span class="mf">0.951056</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.442863</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.238856</span><span class="p">,</span><span class="w"> </span><span class="mf">0.864188</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.162460</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.262866</span><span class="p">,</span><span class="w"> </span><span class="mf">0.951056</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.309017</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.500000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.809017</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.147621</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.716567</span><span class="p">,</span><span class="w"> </span><span class="mf">0.681718</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.525731</span><span class="p">,</span><span class="w"> </span><span class="mf">0.850651</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.425325</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.688191</span><span class="p">,</span><span class="w"> </span><span class="mf">0.587785</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.587785</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.425325</span><span class="p">,</span><span class="w"> </span><span class="mf">0.688191</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mf">0.688191</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.587785</span><span class="p">,</span><span class="w"> </span><span class="mf">0.425325</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.955423</span><span class="p">,</span><span class="w"> </span><span class="mf">0.295242</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.951056</span><span class="p">,</span><span class="w"> </span><span class="mf">0.162460</span><span class="p">,</span><span class="w"> </span><span class="mf">0.262866</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">1.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.850651</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.525731</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.955423</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.295242</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.951056</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.162460</span><span class="p">,</span><span class="w"> </span><span class="mf">0.262866</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.864188</span><span class="p">,</span><span class="w"> </span><span class="mf">0.442863</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.238856</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.951056</span><span class="p">,</span><span class="w"> </span><span class="mf">0.162460</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.262866</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.809017</span><span class="p">,</span><span class="w"> </span><span class="mf">0.309017</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.500000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.864188</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.442863</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.238856</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.951056</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.162460</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.262866</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.809017</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.309017</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.500000</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.681718</span><span class="p">,</span><span class="w"> </span><span class="mf">0.147621</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.716567</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.681718</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.147621</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.716567</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.850651</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.525731</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.688191</span><span class="p">,</span><span class="w"> </span><span class="mf">0.587785</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.425325</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.587785</span><span class="p">,</span><span class="w"> </span><span class="mf">0.425325</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.688191</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.425325</span><span class="p">,</span><span class="w"> </span><span class="mf">0.688191</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.587785</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.425325</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.688191</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.587785</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.587785</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.425325</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.688191</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mf">0.688191</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.587785</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.425325</span><span class="p">}}</span>
<span class="w">  </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_anorms_table</span>
<span class="kr">end</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">property</span><span class="p">.</span><span class="py">frames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">frames</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_frames</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_frames</span>
<span class="w">  </span><span class="kr">end</span>

<span class="w">  </span><span class="kd">local</span><span class="w"> </span><span class="nv">_pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">pos</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">seek</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">ofs_frames</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_raw__m_frames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_frames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="kr">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">num_frames</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">_raw__m_frames</span><span class="p">[</span><span class="nv">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_bytes</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">bytes_per_frame</span><span class="p">)</span>
<span class="w">    </span><span class="kd">local</span><span class="w"> </span><span class="nv">_io</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">KaitaiStream</span><span class="p">(</span><span class="nf">stringstream</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">_raw__m_frames</span><span class="p">[</span><span class="nv">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]))</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_frames</span><span class="p">[</span><span class="nv">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Quake2Md2</span><span class="p">.</span><span class="nf">Frame</span><span class="p">(</span><span class="nv">_io</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="p">)</span>
<span class="w">  </span><span class="kr">end</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">seek</span><span class="p">(</span><span class="nv">_pos</span><span class="p">)</span>
<span class="w">  </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_frames</span>
<span class="kr">end</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">property</span><span class="p">.</span><span class="py">gl_cmds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">gl_cmds</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_gl_cmds</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_gl_cmds</span>
<span class="w">  </span><span class="kr">end</span>

<span class="w">  </span><span class="kd">local</span><span class="w"> </span><span class="nv">_pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">pos</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">seek</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">ofs_gl_cmds</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_raw__m_gl_cmds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_bytes</span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">num_gl_cmds</span><span class="p">)</span>
<span class="w">  </span><span class="kd">local</span><span class="w"> </span><span class="nv">_io</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">KaitaiStream</span><span class="p">(</span><span class="nf">stringstream</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">_raw__m_gl_cmds</span><span class="p">))</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_gl_cmds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Quake2Md2</span><span class="p">.</span><span class="nf">GlCmdsList</span><span class="p">(</span><span class="nv">_io</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">seek</span><span class="p">(</span><span class="nv">_pos</span><span class="p">)</span>
<span class="w">  </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_gl_cmds</span>
<span class="kr">end</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">property</span><span class="p">.</span><span class="py">skins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">skins</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_skins</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_skins</span>
<span class="w">  </span><span class="kr">end</span>

<span class="w">  </span><span class="kd">local</span><span class="w"> </span><span class="nv">_pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">pos</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">seek</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">ofs_skins</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_skins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="kr">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">num_skins</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_skins</span><span class="p">[</span><span class="nv">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">str_decode</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="nv">KaitaiStream</span><span class="p">.</span><span class="nf">bytes_terminate</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_bytes</span><span class="p">(</span><span class="mi">64</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;ASCII&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="kr">end</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">seek</span><span class="p">(</span><span class="nv">_pos</span><span class="p">)</span>
<span class="w">  </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_skins</span>
<span class="kr">end</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">property</span><span class="p">.</span><span class="py">tex_coords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">tex_coords</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_tex_coords</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_tex_coords</span>
<span class="w">  </span><span class="kr">end</span>

<span class="w">  </span><span class="kd">local</span><span class="w"> </span><span class="nv">_pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">pos</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">seek</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">ofs_tex_coords</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_tex_coords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="kr">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">num_tex_coords</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_tex_coords</span><span class="p">[</span><span class="nv">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Quake2Md2</span><span class="p">.</span><span class="nf">TexPoint</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="p">)</span>
<span class="w">  </span><span class="kr">end</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">seek</span><span class="p">(</span><span class="nv">_pos</span><span class="p">)</span>
<span class="w">  </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_tex_coords</span>
<span class="kr">end</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">property</span><span class="p">.</span><span class="py">triangles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">triangles</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_triangles</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_triangles</span>
<span class="w">  </span><span class="kr">end</span>

<span class="w">  </span><span class="kd">local</span><span class="w"> </span><span class="nv">_pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">pos</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">seek</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">ofs_triangles</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_triangles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="kr">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">num_triangles</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_triangles</span><span class="p">[</span><span class="nv">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Quake2Md2</span><span class="p">.</span><span class="nf">Triangle</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="p">)</span>
<span class="w">  </span><span class="kr">end</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">seek</span><span class="p">(</span><span class="nv">_pos</span><span class="p">)</span>
<span class="w">  </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_triangles</span>
<span class="kr">end</span>


<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">CompressedVec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">class</span><span class="p">.</span><span class="nf">class</span><span class="p">(</span><span class="nv">KaitaiStruct</span><span class="p">)</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">CompressedVec</span><span class="p">:</span><span class="nf">_init</span><span class="p">(</span><span class="nv">io</span><span class="p">,</span><span class="w"> </span><span class="nv">parent</span><span class="p">,</span><span class="w"> </span><span class="nv">root</span><span class="p">)</span>
<span class="w">  </span><span class="nv">KaitaiStruct</span><span class="p">.</span><span class="nf">_init</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">io</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">parent</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">root</span>
<span class="w">  </span><span class="nv">self</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">CompressedVec</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">x_compressed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u1</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">y_compressed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u1</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">z_compressed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u1</span><span class="p">()</span>
<span class="kr">end</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">CompressedVec</span><span class="p">.</span><span class="py">property</span><span class="p">.</span><span class="py">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">CompressedVec</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">x</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_x</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_x</span>
<span class="w">  </span><span class="kr">end</span>

<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">x_compressed</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_parent</span><span class="p">.</span><span class="py">_parent</span><span class="p">.</span><span class="py">scale</span><span class="p">.</span><span class="py">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_parent</span><span class="p">.</span><span class="py">_parent</span><span class="p">.</span><span class="py">translate</span><span class="p">.</span><span class="py">x</span>
<span class="w">  </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_x</span>
<span class="kr">end</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">CompressedVec</span><span class="p">.</span><span class="py">property</span><span class="p">.</span><span class="py">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">CompressedVec</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">y</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_y</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_y</span>
<span class="w">  </span><span class="kr">end</span>

<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">y_compressed</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_parent</span><span class="p">.</span><span class="py">_parent</span><span class="p">.</span><span class="py">scale</span><span class="p">.</span><span class="py">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_parent</span><span class="p">.</span><span class="py">_parent</span><span class="p">.</span><span class="py">translate</span><span class="p">.</span><span class="py">y</span>
<span class="w">  </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_y</span>
<span class="kr">end</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">CompressedVec</span><span class="p">.</span><span class="py">property</span><span class="p">.</span><span class="py">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">CompressedVec</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">z</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_z</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_z</span>
<span class="w">  </span><span class="kr">end</span>

<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">z_compressed</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_parent</span><span class="p">.</span><span class="py">_parent</span><span class="p">.</span><span class="py">scale</span><span class="p">.</span><span class="py">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_parent</span><span class="p">.</span><span class="py">_parent</span><span class="p">.</span><span class="py">translate</span><span class="p">.</span><span class="py">z</span>
<span class="w">  </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_z</span>
<span class="kr">end</span>


<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">Frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">class</span><span class="p">.</span><span class="nf">class</span><span class="p">(</span><span class="nv">KaitaiStruct</span><span class="p">)</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">Frame</span><span class="p">:</span><span class="nf">_init</span><span class="p">(</span><span class="nv">io</span><span class="p">,</span><span class="w"> </span><span class="nv">parent</span><span class="p">,</span><span class="w"> </span><span class="nv">root</span><span class="p">)</span>
<span class="w">  </span><span class="nv">KaitaiStruct</span><span class="p">.</span><span class="nf">_init</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">io</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">parent</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">root</span>
<span class="w">  </span><span class="nv">self</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">Frame</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Quake2Md2</span><span class="p">.</span><span class="nf">Vec3f</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">translate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Quake2Md2</span><span class="p">.</span><span class="nf">Vec3f</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">str_decode</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="nv">KaitaiStream</span><span class="p">.</span><span class="nf">bytes_terminate</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_bytes</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;ASCII&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">vertices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="kr">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="p">.</span><span class="py">vertices_per_frame</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">vertices</span><span class="p">[</span><span class="nv">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Quake2Md2</span><span class="p">.</span><span class="nf">Vertex</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="p">)</span>
<span class="w">  </span><span class="kr">end</span>
<span class="kr">end</span>


<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">GlCmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">class</span><span class="p">.</span><span class="nf">class</span><span class="p">(</span><span class="nv">KaitaiStruct</span><span class="p">)</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">GlCmd</span><span class="p">:</span><span class="nf">_init</span><span class="p">(</span><span class="nv">io</span><span class="p">,</span><span class="w"> </span><span class="nv">parent</span><span class="p">,</span><span class="w"> </span><span class="nv">root</span><span class="p">)</span>
<span class="w">  </span><span class="nv">KaitaiStruct</span><span class="p">.</span><span class="nf">_init</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">io</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">parent</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">root</span>
<span class="w">  </span><span class="nv">self</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">GlCmd</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">cmd_num_vertices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_s4le</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">vertices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="kr">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">num_vertices</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">vertices</span><span class="p">[</span><span class="nv">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Quake2Md2</span><span class="p">.</span><span class="nf">GlVertex</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="p">)</span>
<span class="w">  </span><span class="kr">end</span>
<span class="kr">end</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">GlCmd</span><span class="p">.</span><span class="py">property</span><span class="p">.</span><span class="py">num_vertices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">GlCmd</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">num_vertices</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_num_vertices</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_num_vertices</span>
<span class="w">  </span><span class="kr">end</span>

<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_num_vertices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">utils</span><span class="p">.</span><span class="nf">box_unwrap</span><span class="p">((</span><span class="nv">self</span><span class="p">.</span><span class="py">cmd_num_vertices</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nv">utils</span><span class="p">.</span><span class="nf">box_wrap</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">cmd_num_vertices</span><span class="p">))</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">cmd_num_vertices</span><span class="p">))</span>
<span class="w">  </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_num_vertices</span>
<span class="kr">end</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">GlCmd</span><span class="p">.</span><span class="py">property</span><span class="p">.</span><span class="py">primitive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">GlCmd</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">primitive</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_primitive</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_primitive</span>
<span class="w">  </span><span class="kr">end</span>

<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_primitive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">utils</span><span class="p">.</span><span class="nf">box_unwrap</span><span class="p">((</span><span class="nv">self</span><span class="p">.</span><span class="py">cmd_num_vertices</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nv">utils</span><span class="p">.</span><span class="nf">box_wrap</span><span class="p">(</span><span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">GlPrimitive</span><span class="p">.</span><span class="py">triangle_fan</span><span class="p">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="p">(</span><span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">GlPrimitive</span><span class="p">.</span><span class="py">triangle_strip</span><span class="p">))</span>
<span class="w">  </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_primitive</span>
<span class="kr">end</span>


<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">GlCmdsList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">class</span><span class="p">.</span><span class="nf">class</span><span class="p">(</span><span class="nv">KaitaiStruct</span><span class="p">)</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">GlCmdsList</span><span class="p">:</span><span class="nf">_init</span><span class="p">(</span><span class="nv">io</span><span class="p">,</span><span class="w"> </span><span class="nv">parent</span><span class="p">,</span><span class="w"> </span><span class="nv">root</span><span class="p">)</span>
<span class="w">  </span><span class="nv">KaitaiStruct</span><span class="p">.</span><span class="nf">_init</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">io</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">parent</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">root</span>
<span class="w">  </span><span class="nv">self</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">GlCmdsList</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="ow">not</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">is_eof</span><span class="p">())</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="w">    </span><span class="kd">local</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="kr">while</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="kr">do</span>
<span class="w">      </span><span class="kd">local</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Quake2Md2</span><span class="p">.</span><span class="nf">GlCmd</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="p">)</span>
<span class="w">      </span><span class="nv">self</span><span class="p">.</span><span class="py">items</span><span class="p">[</span><span class="nv">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">_</span>
<span class="w">      </span><span class="kr">if</span><span class="w"> </span><span class="nv">_</span><span class="p">.</span><span class="py">cmd_num_vertices</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="kr">then</span>
<span class="w">        </span><span class="kr">break</span>
<span class="w">      </span><span class="kr">end</span>
<span class="w">      </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="kr">end</span>
<span class="w">  </span><span class="kr">end</span>
<span class="kr">end</span>


<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">GlVertex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">class</span><span class="p">.</span><span class="nf">class</span><span class="p">(</span><span class="nv">KaitaiStruct</span><span class="p">)</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">GlVertex</span><span class="p">:</span><span class="nf">_init</span><span class="p">(</span><span class="nv">io</span><span class="p">,</span><span class="w"> </span><span class="nv">parent</span><span class="p">,</span><span class="w"> </span><span class="nv">root</span><span class="p">)</span>
<span class="w">  </span><span class="nv">KaitaiStruct</span><span class="p">.</span><span class="nf">_init</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">io</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">parent</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">root</span>
<span class="w">  </span><span class="nv">self</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">GlVertex</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">tex_coords_normalized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="kr">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">tex_coords_normalized</span><span class="p">[</span><span class="nv">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_f4le</span><span class="p">()</span>
<span class="w">  </span><span class="kr">end</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">vertex_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u4le</span><span class="p">()</span>
<span class="kr">end</span>

<span class="c1">-- </span>
<span class="c1">-- index to `_root.frames[i].vertices` (for each frame with index `i`).</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">TexPoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">class</span><span class="p">.</span><span class="nf">class</span><span class="p">(</span><span class="nv">KaitaiStruct</span><span class="p">)</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">TexPoint</span><span class="p">:</span><span class="nf">_init</span><span class="p">(</span><span class="nv">io</span><span class="p">,</span><span class="w"> </span><span class="nv">parent</span><span class="p">,</span><span class="w"> </span><span class="nv">root</span><span class="p">)</span>
<span class="w">  </span><span class="nv">KaitaiStruct</span><span class="p">.</span><span class="nf">_init</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">io</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">parent</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">root</span>
<span class="w">  </span><span class="nv">self</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">TexPoint</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">s_px</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u2le</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">t_px</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u2le</span><span class="p">()</span>
<span class="kr">end</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">TexPoint</span><span class="p">.</span><span class="py">property</span><span class="p">.</span><span class="py">s_normalized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">TexPoint</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">s_normalized</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_s_normalized</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_s_normalized</span>
<span class="w">  </span><span class="kr">end</span>

<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_s_normalized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">s_px</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="p">.</span><span class="py">skin_width_px</span>
<span class="w">  </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_s_normalized</span>
<span class="kr">end</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">TexPoint</span><span class="p">.</span><span class="py">property</span><span class="p">.</span><span class="py">t_normalized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">TexPoint</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">t_normalized</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_t_normalized</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_t_normalized</span>
<span class="w">  </span><span class="kr">end</span>

<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_t_normalized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">t_px</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="p">.</span><span class="py">skin_height_px</span>
<span class="w">  </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_t_normalized</span>
<span class="kr">end</span>


<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">Triangle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">class</span><span class="p">.</span><span class="nf">class</span><span class="p">(</span><span class="nv">KaitaiStruct</span><span class="p">)</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">Triangle</span><span class="p">:</span><span class="nf">_init</span><span class="p">(</span><span class="nv">io</span><span class="p">,</span><span class="w"> </span><span class="nv">parent</span><span class="p">,</span><span class="w"> </span><span class="nv">root</span><span class="p">)</span>
<span class="w">  </span><span class="nv">KaitaiStruct</span><span class="p">.</span><span class="nf">_init</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">io</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">parent</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">root</span>
<span class="w">  </span><span class="nv">self</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">Triangle</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">vertex_indices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="kr">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">vertex_indices</span><span class="p">[</span><span class="nv">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u2le</span><span class="p">()</span>
<span class="w">  </span><span class="kr">end</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">tex_point_indices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="kr">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">tex_point_indices</span><span class="p">[</span><span class="nv">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u2le</span><span class="p">()</span>
<span class="w">  </span><span class="kr">end</span>
<span class="kr">end</span>

<span class="c1">-- </span>
<span class="c1">-- indices to `_root.frames[i].vertices` (for each frame with index `i`).</span>
<span class="c1">-- </span>
<span class="c1">-- indices to `_root.tex_coords`.</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">Vec3f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">class</span><span class="p">.</span><span class="nf">class</span><span class="p">(</span><span class="nv">KaitaiStruct</span><span class="p">)</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">Vec3f</span><span class="p">:</span><span class="nf">_init</span><span class="p">(</span><span class="nv">io</span><span class="p">,</span><span class="w"> </span><span class="nv">parent</span><span class="p">,</span><span class="w"> </span><span class="nv">root</span><span class="p">)</span>
<span class="w">  </span><span class="nv">KaitaiStruct</span><span class="p">.</span><span class="nf">_init</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">io</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">parent</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">root</span>
<span class="w">  </span><span class="nv">self</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">Vec3f</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_f4le</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_f4le</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_f4le</span><span class="p">()</span>
<span class="kr">end</span>


<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">Vertex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">class</span><span class="p">.</span><span class="nf">class</span><span class="p">(</span><span class="nv">KaitaiStruct</span><span class="p">)</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">Vertex</span><span class="p">:</span><span class="nf">_init</span><span class="p">(</span><span class="nv">io</span><span class="p">,</span><span class="w"> </span><span class="nv">parent</span><span class="p">,</span><span class="w"> </span><span class="nv">root</span><span class="p">)</span>
<span class="w">  </span><span class="nv">KaitaiStruct</span><span class="p">.</span><span class="nf">_init</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">io</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">parent</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">root</span>
<span class="w">  </span><span class="nv">self</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">Vertex</span><span class="p">:</span><span class="nf">_read</span><span class="p">()</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Quake2Md2</span><span class="p">.</span><span class="nf">CompressedVec</span><span class="p">(</span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="p">)</span>
<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">normal_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_io</span><span class="p">:</span><span class="nf">read_u1</span><span class="p">()</span>
<span class="kr">end</span>

<span class="nv">Quake2Md2</span><span class="p">.</span><span class="py">Vertex</span><span class="p">.</span><span class="py">property</span><span class="p">.</span><span class="py">normal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="kr">function</span><span class="w"> </span><span class="nc">Quake2Md2</span><span class="p">.</span><span class="nc">Vertex</span><span class="p">.</span><span class="nc">property</span><span class="p">.</span><span class="nc">normal</span><span class="p">:</span><span class="nf">get</span><span class="p">()</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_normal</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_normal</span>
<span class="w">  </span><span class="kr">end</span>

<span class="w">  </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_normal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_root</span><span class="p">.</span><span class="py">anorms_table</span><span class="p">[</span><span class="nv">self</span><span class="p">.</span><span class="py">normal_index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span>
<span class="w">  </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">_m_normal</span>
<span class="kr">end</span>
</pre></div>

        </div>
        
    </div>
</section>

    <footer id="main-footer">
        <div class="container">
            &copy; 2015&ndash;2025 Kaitai Project and <a href="https://github.com/kaitai-io/kaitai_struct_formats/graphs/contributors">format repo contributors</a>

            <h3>Contacts</h3>

            <div class="row">
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-github"></i> <a href="https://github.com/kaitai-io/kaitai_struct">GitHub</a>
                </div>
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-twitter"></i> <a href="https://twitter.com/kaitai_io">@kaitai_io</a>
                </div>
                <div class="col-sm-4">
                    Gitter: <a href="https://gitter.im/kaitai_struct/Lobby">kaitai_struct</a>
                </div>
            </div>
        </div>
    </footer>

  <script src="//kaitai.io/js/jquery-1.12.3.min.js"></script>
  <script src="//kaitai.io/js/bootstrap.min.js"></script>
</body>
</html>
