<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Windows Shell Items: GraphViz block diagram (.dot) source: Kaitai Struct</title>
  <meta name="keywords" content="kaitai,struct,binary,format,parsing,decoding,java,javascript,python,ruby,library,metadata">
  <meta name="description" content="Kaitai Struct is a formal language for binary format specification that can be compiled into parser code">

  <link rel="stylesheet" href="http://kaitai.io/styles/bootstrap.min.css">
  <link rel="stylesheet" href="http://kaitai.io/styles/bootstrap-theme.min.css">
  <link href='https://fonts.googleapis.com/css?family=Exo:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Share+Tech+Mono' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  <link rel="stylesheet" href="http://kaitai.io/styles/main.css" type="text/css">

  <link rel="stylesheet" href="http://kaitai.io/styles/highlight/default.css">
  <style>
.diagram-img {
    display: block;
    max-width: 100%;
    height: auto;
    margin: 0 auto;
}

section.format {
    padding: 30px 0;
}

section#format-meta, section#format-index-header {
    background: #e3eef7;
}

section#format-diagram, section#format-index-footer {
    background: #e9f8dd;
}

section#format-ksy, section#format-lang {
    background: #d1eadd;
}

section#format-index .row {
    padding-bottom: 10px;
}

  </style>
  <script src="http://kaitai.io/js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>
<body data-spy="scroll" data-target="#main-navbar" data-offset="100">

    <nav class="navbar navbar-inverse navbar-fixed-top" id="main-navbar">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-navbar-collapse" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <span class="navbar-brand">Kaitai Struct</span>
            </div>
            <div class="collapse navbar-collapse" id="main-navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="http://kaitai.io/#what-is-it">What is it?</a></li>
                    <li><a href="http://kaitai.io/#quick-start">Quick Start</a></li>
                    <li><a href="http://kaitai.io/#download">Download</a></li>
                    <li class="active"><a href="http://formats.kaitai.io/">Format Gallery</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="http://kaitai.io/repl/index.html">Try it</a></li>
                    <li><a href="https://ide.kaitai.io/">Web IDE</a></li>
                    <li><a href="http://doc.kaitai.io/">Documentation</a></li>
                </ul>
            </div>
        </div>
    </nav>
<nav>
    <div class="container">
    <ol class="breadcrumb">
        <li><a href="../index.html">Format Gallery</a></li>
        <li>Windows-specific</li>
        <li class="active">Windows Shell Items</li>
    </ol>
    </div>
</nav>

<section id="format-meta" class="format">
    <div class="container">
        <h1>Windows Shell Items:
            
            GraphViz block diagram (.dot) source
            
        </h1>

        <div class="row">
            <div class="col-md-8">
                <p><p>Windows Shell Items (AKA &quot;shellbags&quot;) is an undocumented set of
structures used internally within Windows to identify paths in
Windows Folder Hierarchy. It is widely used in Windows Shell (and
most visible in File Explorer), both as in-memory and in-file
structures. Some formats embed them, namely:</p>
<ul>
<li>Windows Shell link files (.lnk) Windows registry</li>
<li>Windows registry &quot;ShellBags&quot; keys</li>
</ul>
<p>The format is mostly undocumented, and is known to vary between
various Windows versions.</p>
</p>
            </div>
            <div class="col-md-4">
                <div class="panel panel-info">
                    
                    
                    
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
            <p>
            This page hosts a formal specification of Windows Shell Items
            using <a href="http://kaitai.io">Kaitai Struct</a>. This
            specification can be automatically translated into a
            variety of programming languages to get a parsing library.
            </p>

            <ul class="nav nav-pills">
                
                
                <li>
                
                <a href="index.html" title="Windows Shell Items parsing Overview library">Overview</a></li>
                
                
                <li>
                
                <a href="cpp_stl.html" title="Windows Shell Items parsing C++/STL library">C++/STL</a></li>
                
                
                <li>
                
                <a href="csharp.html" title="Windows Shell Items parsing C# library">C#</a></li>
                
                
                <li class="active">
                
                <a href="graphviz.html" title="Windows Shell Items parsing GraphViz library">GraphViz</a></li>
                
                
                <li>
                
                <a href="java.html" title="Windows Shell Items parsing Java library">Java</a></li>
                
                
                <li>
                
                <a href="javascript.html" title="Windows Shell Items parsing JavaScript library">JavaScript</a></li>
                
                
                <li>
                
                <a href="lua.html" title="Windows Shell Items parsing Lua library">Lua</a></li>
                
                
                <li>
                
                <a href="perl.html" title="Windows Shell Items parsing Perl library">Perl</a></li>
                
                
                <li>
                
                <a href="php.html" title="Windows Shell Items parsing PHP library">PHP</a></li>
                
                
                <li>
                
                <a href="python.html" title="Windows Shell Items parsing Python library">Python</a></li>
                
                
                <li>
                
                <a href="ruby.html" title="Windows Shell Items parsing Ruby library">Ruby</a></li>
                
            </ul>
            </div>
        </div>
    </div>
</section>


<section id="format-lang" class="format">
    <div class="container">
        <h2>
            
            GraphViz block diagram source
            
        </h2>

        

        <h3>windows_shell_items.dot</h3>

        <div class="row">
            <div class="pull-right">
                <p>
                    <a href="src/graphviz/windows_shell_items.dot" class="btn btn-success">Download <i class="fa fa-download"></i></a>
                </p>
            </div>
        </div>

        <div class="row">
            <pre><code class="graphviz">digraph {
	rankdir=LR;
	node [shape=plaintext];
	subgraph cluster__windows_shell_items {
		label=&quot;WindowsShellItems&quot;;
		graph[style=dotted];

		windows_shell_items__seq [label=&lt;&lt;TABLE BORDER=&quot;0&quot; CELLBORDER=&quot;1&quot; CELLSPACING=&quot;0&quot;&gt;
			&lt;TR&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;pos&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;size&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;type&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;id&lt;/TD&gt;&lt;/TR&gt;
			&lt;TR&gt;&lt;TD PORT=&quot;items_pos&quot;&gt;0&lt;/TD&gt;&lt;TD PORT=&quot;items_size&quot;&gt;...&lt;/TD&gt;&lt;TD&gt;ShellItem&lt;/TD&gt;&lt;TD PORT=&quot;items_type&quot;&gt;items&lt;/TD&gt;&lt;/TR&gt;
			&lt;TR&gt;&lt;TD COLSPAN=&quot;4&quot; PORT=&quot;items__repeat&quot;&gt;repeat until _.len_data == 0&lt;/TD&gt;&lt;/TR&gt;
		&lt;/TABLE&gt;&gt;];
		subgraph cluster__shell_item_data {
			label=&quot;WindowsShellItems::ShellItemData&quot;;
			graph[style=dotted];

			shell_item_data__seq [label=&lt;&lt;TABLE BORDER=&quot;0&quot; CELLBORDER=&quot;1&quot; CELLSPACING=&quot;0&quot;&gt;
				&lt;TR&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;pos&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;size&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;type&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;id&lt;/TD&gt;&lt;/TR&gt;
				&lt;TR&gt;&lt;TD PORT=&quot;code_pos&quot;&gt;0&lt;/TD&gt;&lt;TD PORT=&quot;code_size&quot;&gt;1&lt;/TD&gt;&lt;TD&gt;u1&lt;/TD&gt;&lt;TD PORT=&quot;code_type&quot;&gt;code&lt;/TD&gt;&lt;/TR&gt;
				&lt;TR&gt;&lt;TD PORT=&quot;body1_pos&quot;&gt;1&lt;/TD&gt;&lt;TD PORT=&quot;body1_size&quot;&gt;...&lt;/TD&gt;&lt;TD&gt;switch (code)&lt;/TD&gt;&lt;TD PORT=&quot;body1_type&quot;&gt;body1&lt;/TD&gt;&lt;/TR&gt;
				&lt;TR&gt;&lt;TD PORT=&quot;body2_pos&quot;&gt;...&lt;/TD&gt;&lt;TD PORT=&quot;body2_size&quot;&gt;...&lt;/TD&gt;&lt;TD&gt;switch ((code &amp;amp; 112))&lt;/TD&gt;&lt;TD PORT=&quot;body2_type&quot;&gt;body2&lt;/TD&gt;&lt;/TR&gt;
			&lt;/TABLE&gt;&gt;];
shell_item_data__seq_body1_switch [label=&lt;&lt;TABLE BORDER=&quot;0&quot; CELLBORDER=&quot;1&quot; CELLSPACING=&quot;0&quot;&gt;
	&lt;TR&gt;&lt;TD BGCOLOR=&quot;#F0F2E4&quot;&gt;case&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#F0F2E4&quot;&gt;type&lt;/TD&gt;&lt;/TR&gt;
	&lt;TR&gt;&lt;TD&gt;31&lt;/TD&gt;&lt;TD PORT=&quot;case0&quot;&gt;RootFolderBody&lt;/TD&gt;&lt;/TR&gt;
&lt;/TABLE&gt;&gt;];
shell_item_data__seq_body2_switch [label=&lt;&lt;TABLE BORDER=&quot;0&quot; CELLBORDER=&quot;1&quot; CELLSPACING=&quot;0&quot;&gt;
	&lt;TR&gt;&lt;TD BGCOLOR=&quot;#F0F2E4&quot;&gt;case&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#F0F2E4&quot;&gt;type&lt;/TD&gt;&lt;/TR&gt;
	&lt;TR&gt;&lt;TD&gt;32&lt;/TD&gt;&lt;TD PORT=&quot;case0&quot;&gt;VolumeBody&lt;/TD&gt;&lt;/TR&gt;
	&lt;TR&gt;&lt;TD&gt;48&lt;/TD&gt;&lt;TD PORT=&quot;case1&quot;&gt;FileEntryBody&lt;/TD&gt;&lt;/TR&gt;
&lt;/TABLE&gt;&gt;];
		}
		subgraph cluster__shell_item {
			label=&quot;WindowsShellItems::ShellItem&quot;;
			graph[style=dotted];

			shell_item__seq [label=&lt;&lt;TABLE BORDER=&quot;0&quot; CELLBORDER=&quot;1&quot; CELLSPACING=&quot;0&quot;&gt;
				&lt;TR&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;pos&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;size&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;type&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;id&lt;/TD&gt;&lt;/TR&gt;
				&lt;TR&gt;&lt;TD PORT=&quot;len_data_pos&quot;&gt;0&lt;/TD&gt;&lt;TD PORT=&quot;len_data_size&quot;&gt;2&lt;/TD&gt;&lt;TD&gt;u2le&lt;/TD&gt;&lt;TD PORT=&quot;len_data_type&quot;&gt;len_data&lt;/TD&gt;&lt;/TR&gt;
				&lt;TR&gt;&lt;TD PORT=&quot;data_pos&quot;&gt;2&lt;/TD&gt;&lt;TD PORT=&quot;data_size&quot;&gt;(len_data - 2)&lt;/TD&gt;&lt;TD&gt;ShellItemData&lt;/TD&gt;&lt;TD PORT=&quot;data_type&quot;&gt;data&lt;/TD&gt;&lt;/TR&gt;
			&lt;/TABLE&gt;&gt;];
		}
		subgraph cluster__root_folder_body {
			label=&quot;WindowsShellItems::RootFolderBody&quot;;
			graph[style=dotted];

			root_folder_body__seq [label=&lt;&lt;TABLE BORDER=&quot;0&quot; CELLBORDER=&quot;1&quot; CELLSPACING=&quot;0&quot;&gt;
				&lt;TR&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;pos&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;size&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;type&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;id&lt;/TD&gt;&lt;/TR&gt;
				&lt;TR&gt;&lt;TD PORT=&quot;sort_index_pos&quot;&gt;0&lt;/TD&gt;&lt;TD PORT=&quot;sort_index_size&quot;&gt;1&lt;/TD&gt;&lt;TD&gt;u1&lt;/TD&gt;&lt;TD PORT=&quot;sort_index_type&quot;&gt;sort_index&lt;/TD&gt;&lt;/TR&gt;
				&lt;TR&gt;&lt;TD PORT=&quot;shell_folder_id_pos&quot;&gt;1&lt;/TD&gt;&lt;TD PORT=&quot;shell_folder_id_size&quot;&gt;16&lt;/TD&gt;&lt;TD&gt;&lt;/TD&gt;&lt;TD PORT=&quot;shell_folder_id_type&quot;&gt;shell_folder_id&lt;/TD&gt;&lt;/TR&gt;
			&lt;/TABLE&gt;&gt;];
		}
		subgraph cluster__volume_body {
			label=&quot;WindowsShellItems::VolumeBody&quot;;
			graph[style=dotted];

			volume_body__seq [label=&lt;&lt;TABLE BORDER=&quot;0&quot; CELLBORDER=&quot;1&quot; CELLSPACING=&quot;0&quot;&gt;
				&lt;TR&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;pos&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;size&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;type&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;id&lt;/TD&gt;&lt;/TR&gt;
				&lt;TR&gt;&lt;TD PORT=&quot;flags_pos&quot;&gt;0&lt;/TD&gt;&lt;TD PORT=&quot;flags_size&quot;&gt;1&lt;/TD&gt;&lt;TD&gt;u1&lt;/TD&gt;&lt;TD PORT=&quot;flags_type&quot;&gt;flags&lt;/TD&gt;&lt;/TR&gt;
			&lt;/TABLE&gt;&gt;];
		}
		subgraph cluster__file_entry_body {
			label=&quot;WindowsShellItems::FileEntryBody&quot;;
			graph[style=dotted];

			file_entry_body__seq [label=&lt;&lt;TABLE BORDER=&quot;0&quot; CELLBORDER=&quot;1&quot; CELLSPACING=&quot;0&quot;&gt;
				&lt;TR&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;pos&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;size&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;type&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;id&lt;/TD&gt;&lt;/TR&gt;
				&lt;TR&gt;&lt;TD PORT=&quot;_unnamed0_pos&quot;&gt;0&lt;/TD&gt;&lt;TD PORT=&quot;_unnamed0_size&quot;&gt;1&lt;/TD&gt;&lt;TD&gt;u1&lt;/TD&gt;&lt;TD PORT=&quot;_unnamed0_type&quot;&gt;_unnamed0&lt;/TD&gt;&lt;/TR&gt;
				&lt;TR&gt;&lt;TD PORT=&quot;file_size_pos&quot;&gt;1&lt;/TD&gt;&lt;TD PORT=&quot;file_size_size&quot;&gt;4&lt;/TD&gt;&lt;TD&gt;u4le&lt;/TD&gt;&lt;TD PORT=&quot;file_size_type&quot;&gt;file_size&lt;/TD&gt;&lt;/TR&gt;
				&lt;TR&gt;&lt;TD PORT=&quot;last_mod_time_pos&quot;&gt;5&lt;/TD&gt;&lt;TD PORT=&quot;last_mod_time_size&quot;&gt;4&lt;/TD&gt;&lt;TD&gt;u4le&lt;/TD&gt;&lt;TD PORT=&quot;last_mod_time_type&quot;&gt;last_mod_time&lt;/TD&gt;&lt;/TR&gt;
				&lt;TR&gt;&lt;TD PORT=&quot;file_attrs_pos&quot;&gt;9&lt;/TD&gt;&lt;TD PORT=&quot;file_attrs_size&quot;&gt;2&lt;/TD&gt;&lt;TD&gt;u2le&lt;/TD&gt;&lt;TD PORT=&quot;file_attrs_type&quot;&gt;file_attrs&lt;/TD&gt;&lt;/TR&gt;
			&lt;/TABLE&gt;&gt;];
			file_entry_body__inst__is_dir [label=&lt;&lt;TABLE BORDER=&quot;0&quot; CELLBORDER=&quot;1&quot; CELLSPACING=&quot;0&quot;&gt;
				&lt;TR&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;id&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;value&lt;/TD&gt;&lt;/TR&gt;
				&lt;TR&gt;&lt;TD&gt;is_dir&lt;/TD&gt;&lt;TD&gt;(_parent.code &amp;amp; 1) != 0&lt;/TD&gt;&lt;/TR&gt;
			&lt;/TABLE&gt;&gt;];
			file_entry_body__inst__is_file [label=&lt;&lt;TABLE BORDER=&quot;0&quot; CELLBORDER=&quot;1&quot; CELLSPACING=&quot;0&quot;&gt;
				&lt;TR&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;id&lt;/TD&gt;&lt;TD BGCOLOR=&quot;#E0FFE0&quot;&gt;value&lt;/TD&gt;&lt;/TR&gt;
				&lt;TR&gt;&lt;TD&gt;is_file&lt;/TD&gt;&lt;TD&gt;(_parent.code &amp;amp; 2) != 0&lt;/TD&gt;&lt;/TR&gt;
			&lt;/TABLE&gt;&gt;];
		}
	}
	windows_shell_items__seq:items_type -&gt; shell_item__seq [style=bold];
	shell_item__seq:len_data_type -&gt; windows_shell_items__seq:items__repeat [color=&quot;#404040&quot;];
	shell_item_data__seq:body1_type -&gt; shell_item_data__seq_body1_switch [style=bold];
	shell_item_data__seq_body1_switch:case0 -&gt; root_folder_body__seq [style=bold];
	shell_item_data__seq:code_type -&gt; shell_item_data__seq:body1_type [color=&quot;#404040&quot;];
	shell_item_data__seq:body2_type -&gt; shell_item_data__seq_body2_switch [style=bold];
	shell_item_data__seq_body2_switch:case0 -&gt; volume_body__seq [style=bold];
	shell_item_data__seq_body2_switch:case1 -&gt; file_entry_body__seq [style=bold];
	shell_item_data__seq:code_type -&gt; shell_item_data__seq:body2_type [color=&quot;#404040&quot;];
	shell_item__seq:len_data_type -&gt; shell_item__seq:data_size [color=&quot;#404040&quot;];
	shell_item__seq:data_type -&gt; shell_item_data__seq [style=bold];
	shell_item_data__seq:code_type -&gt; file_entry_body__inst__is_dir [color=&quot;#404040&quot;];
	shell_item_data__seq:code_type -&gt; file_entry_body__inst__is_file [color=&quot;#404040&quot;];
}
</code></pre>
            
        </div>
        
    </div>
</section>

    <footer id="main-footer">
        <div class="container">
            &copy; 2015-2018 Kaitai Project and <a href="https://github.com/kaitai-io/kaitai_struct_formats/graphs/contributors">formats repo contributors</a>

            <h3>Contacts</h3>

            <div class="row">
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-github"></i> <a href="https://github.com/kaitai-io/kaitai_struct">GitHub</a>
                </div>
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-twitter"></i> <a href="https://twitter.com/kaitai_io">@kaitai_io</a>
                </div>
                <div class="col-sm-4">
                    Gitter: <a href="https://gitter.im/kaitai_struct/Lobby">kaitai_struct</a>
                </div>
            </div>
        </div>
    </footer>

  <script src="http://kaitai.io/js/jquery-1.12.3.min.js"></script>
  <script src="http://kaitai.io/js/bootstrap.min.js"></script>

  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-76299550-1', 'auto');
      ga('send', 'pageview');
  </script>
</body>
</html>
