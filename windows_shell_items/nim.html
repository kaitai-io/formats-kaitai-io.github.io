<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Windows Shell Items: Nim parsing library</title>
  <meta name="keywords" content="kaitai,struct,binary,format,parsing,decoding,java,javascript,python,ruby,library,metadata">
  <meta name="description" content="Kaitai Struct is a formal language for binary format specification that can be compiled into parser code">

  <link rel="stylesheet" href="//kaitai.io/styles/bootstrap.min.css">
  <link rel="stylesheet" href="//kaitai.io/styles/bootstrap-theme.min.css">
  <link href='https://fonts.googleapis.com/css?family=Exo:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Share+Tech+Mono' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  <link rel="stylesheet" href="//kaitai.io/styles/main.css" type="text/css">
  <link rel="stylesheet" href="/pygments-default.css" type="text/css">
  <style>
.diagram-img {
    display: block;
    max-width: 100%;
    height: auto;
    margin: 0 auto;
}

section.format {
    padding: 30px 0;
}

section#format-meta, section#format-index-header {
    background: #e3eef7;
}

section#format-diagram, section#format-index-footer {
    background: #e9f8dd;
}

section#format-ksy, section#format-lang {
    background: #d1eadd;
}

section#format-index .row {
    padding-bottom: 10px;
}

  </style>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-MFSBBRGREL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-MFSBBRGREL');
  </script>
</head>
<body data-spy="scroll" data-target="#main-navbar" data-offset="100">

    <nav class="navbar navbar-inverse navbar-fixed-top" id="main-navbar">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-navbar-collapse" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <span class="navbar-brand">Kaitai Struct</span>
            </div>
            <div class="collapse navbar-collapse" id="main-navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="//kaitai.io/#what-is-it">What is it?</a></li>
                    <li><a href="//kaitai.io/#quick-start">Quick Start</a></li>
                    <li><a href="//kaitai.io/#download">Download</a></li>
                    <li class="active"><a href="//formats.kaitai.io/">Format Gallery</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="https://ide.kaitai.io/">Try it &mdash; Web IDE</a></li>
                    <li><a href="//doc.kaitai.io/">Documentation</a></li>
                </ul>
            </div>
        </div>
    </nav>
<nav>
    <div class="container">
    <ol class="breadcrumb">
        <li><a href="../">Format Gallery</a></li>
        <li>Windows-specific</li>
        <li class="active">Windows Shell Items</li>
    </ol>
    </div>
</nav>

<section id="format-meta" class="format">
    <div class="container">
        <h1>Windows Shell Items:
            
            Nim parsing library
            
        </h1>

        <div class="row">
            <div class="col-md-8">
                <p><p>Windows Shell Items (AKA &quot;shellbags&quot;) is an undocumented set of
structures used internally within Windows to identify paths in
Windows Folder Hierarchy. It is widely used in Windows Shell (and
most visible in File Explorer), both as in-memory and in-file
structures. Some formats embed them, namely:</p>
<ul>
<li>Windows Shell link files (.lnk) Windows registry</li>
<li>Windows registry &quot;ShellBags&quot; keys</li>
</ul>
<p>The format is mostly undocumented, and is known to vary between
various Windows versions.</p>
</p>
            </div>
            <div class="col-md-4">
                <div class="panel panel-info">
                    
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">KS implementation details</h3>
                    </div>
                    
                    <div class="panel-body">
                        License: <a href="https://spdx.org/licenses/CC0-1.0.html">CC0-1.0</a>
                    </div>
                    
                    
                    
                    
                    
                    <div class="panel-heading">
                        <h3 class="panel-title">References</h3>
                    </div>
                    <div class="panel-body">
                        <ul>
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <li><a href="https://forensicswiki.xyz/page/Shell_Item">Shell Item in ForensicsWiki</a></li>
                            
                            
                            
                        </ul>
                    </div>
                    
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
            <p>
            This page hosts a formal specification of Windows Shell Items
            using <a href="//kaitai.io">Kaitai Struct</a>. This
            specification can be automatically translated into a
            variety of programming languages to get a parsing library.
            </p>

            <ul class="nav nav-pills">
                
                
                <li>
                
                <a href="index.html" title="Windows Shell Items parsing Overview library">Overview</a></li>
                
                
                <li>
                
                <a href="cpp_stl_11.html" title="Windows Shell Items parsing C++11/STL library">C++11/STL</a></li>
                
                
                <li>
                
                <a href="cpp_stl_98.html" title="Windows Shell Items parsing C++98/STL library">C++98/STL</a></li>
                
                
                <li>
                
                <a href="csharp.html" title="Windows Shell Items parsing C# library">C#</a></li>
                
                
                <li>
                
                <a href="go.html" title="Windows Shell Items parsing Go library">Go</a></li>
                
                
                <li>
                
                <a href="graphviz.html" title="Windows Shell Items parsing GraphViz library">GraphViz</a></li>
                
                
                <li>
                
                <a href="java.html" title="Windows Shell Items parsing Java library">Java</a></li>
                
                
                <li>
                
                <a href="javascript.html" title="Windows Shell Items parsing JavaScript library">JavaScript</a></li>
                
                
                <li>
                
                <a href="lua.html" title="Windows Shell Items parsing Lua library">Lua</a></li>
                
                
                <li class="active">
                
                <a href="nim.html" title="Windows Shell Items parsing Nim library">Nim</a></li>
                
                
                <li>
                
                <a href="perl.html" title="Windows Shell Items parsing Perl library">Perl</a></li>
                
                
                <li>
                
                <a href="php.html" title="Windows Shell Items parsing PHP library">PHP</a></li>
                
                
                <li>
                
                <a href="python.html" title="Windows Shell Items parsing Python library">Python</a></li>
                
                
                <li>
                
                <a href="ruby.html" title="Windows Shell Items parsing Ruby library">Ruby</a></li>
                
            </ul>
            </div>
        </div>
    </div>
</section>


<section id="format-lang" class="format">
    <div class="container">
        <h2>
            
            Nim source code to parse Windows Shell Items
            
        </h2>

        

        <h3>windows_shell_items.nim</h3>

        <div class="row">
            <div class="pull-right">
                <p>
                    <a href="src/nim/windows_shell_items.nim" download="windows_shell_items.nim" class="btn btn-success">Download <i class="fa fa-download"></i></a>
                </p>
            </div>
        </div>

        <div class="row">
            <div class="highlight"><pre><span></span><span class="kn">import</span> <span class="n">kaitai_struct_nim_runtime</span>
<span class="kn">import</span> <span class="n">options</span>

<span class="k">type</span>
  <span class="n">WindowsShellItems</span><span class="o">*</span> <span class="o">=</span> <span class="k">ref</span> <span class="k">object</span> <span class="k">of</span> <span class="n">KaitaiStruct</span>
    <span class="p">`</span><span class="n">items</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="kt">seq</span><span class="o">[</span><span class="n">WindowsShellItems_ShellItem</span><span class="o">]</span>
    <span class="p">`</span><span class="n">parent</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="n">KaitaiStruct</span>
  <span class="n">WindowsShellItems_ShellItemData</span><span class="o">*</span> <span class="o">=</span> <span class="k">ref</span> <span class="k">object</span> <span class="k">of</span> <span class="n">KaitaiStruct</span>
    <span class="p">`</span><span class="n">code</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="n">uint8</span>
    <span class="p">`</span><span class="n">body1</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="n">WindowsShellItems_RootFolderBody</span>
    <span class="p">`</span><span class="n">body2</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="n">KaitaiStruct</span>
    <span class="p">`</span><span class="n">parent</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="n">WindowsShellItems_ShellItem</span>
  <span class="n">WindowsShellItems_ShellItem</span><span class="o">*</span> <span class="o">=</span> <span class="k">ref</span> <span class="k">object</span> <span class="k">of</span> <span class="n">KaitaiStruct</span>
    <span class="p">`</span><span class="n">lenData</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="n">uint16</span>
    <span class="p">`</span><span class="n">data</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="n">WindowsShellItems_ShellItemData</span>
    <span class="p">`</span><span class="n">parent</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="n">WindowsShellItems</span>
    <span class="p">`</span><span class="n">rawData</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="kt">seq</span><span class="o">[</span><span class="n">byte</span><span class="o">]</span>
  <span class="n">WindowsShellItems_RootFolderBody</span><span class="o">*</span> <span class="o">=</span> <span class="k">ref</span> <span class="k">object</span> <span class="k">of</span> <span class="n">KaitaiStruct</span>
    <span class="p">`</span><span class="n">sortIndex</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="n">uint8</span>
    <span class="p">`</span><span class="n">shellFolderId</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="kt">seq</span><span class="o">[</span><span class="n">byte</span><span class="o">]</span>
    <span class="p">`</span><span class="n">parent</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="n">WindowsShellItems_ShellItemData</span>
  <span class="n">WindowsShellItems_VolumeBody</span><span class="o">*</span> <span class="o">=</span> <span class="k">ref</span> <span class="k">object</span> <span class="k">of</span> <span class="n">KaitaiStruct</span>
    <span class="p">`</span><span class="n">flags</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="n">uint8</span>
    <span class="p">`</span><span class="n">parent</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="n">WindowsShellItems_ShellItemData</span>
  <span class="n">WindowsShellItems_FileEntryBody</span><span class="o">*</span> <span class="o">=</span> <span class="k">ref</span> <span class="k">object</span> <span class="k">of</span> <span class="n">KaitaiStruct</span>
    <span class="p">`</span><span class="n">unnamed0</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="n">uint8</span>
    <span class="p">`</span><span class="n">fileSize</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="n">uint32</span>
    <span class="p">`</span><span class="n">lastModTime</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="n">uint32</span>
    <span class="p">`</span><span class="n">fileAttrs</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="n">uint16</span>
    <span class="p">`</span><span class="n">parent</span><span class="p">`</span><span class="o">*</span><span class="p">:</span> <span class="n">WindowsShellItems_ShellItemData</span>
    <span class="p">`</span><span class="n">isDirInst</span><span class="p">`:</span> <span class="kt">bool</span>
    <span class="p">`</span><span class="n">isDirInstFlag</span><span class="p">`:</span> <span class="kt">bool</span>
    <span class="p">`</span><span class="n">isFileInst</span><span class="p">`:</span> <span class="kt">bool</span>
    <span class="p">`</span><span class="n">isFileInstFlag</span><span class="p">`:</span> <span class="kt">bool</span>

<span class="k">proc </span><span class="nf">read</span><span class="o">*</span><span class="p">(</span><span class="err">_: typedesc[WindowsShellItems], io: KaitaiStream, root: KaitaiStruct, parent: KaitaiStruct): WindowsShellItems</span>
<span class="k">proc </span><span class="nf">read</span><span class="o">*</span><span class="p">(</span><span class="err">_: typedesc[WindowsShellItems_ShellItemData], io: KaitaiStream, root: KaitaiStruct, parent: WindowsShellItems_ShellItem): WindowsShellItems_ShellItemData</span>
<span class="k">proc </span><span class="nf">read</span><span class="o">*</span><span class="p">(</span><span class="err">_: typedesc[WindowsShellItems_ShellItem], io: KaitaiStream, root: KaitaiStruct, parent: WindowsShellItems): WindowsShellItems_ShellItem</span>
<span class="k">proc </span><span class="nf">read</span><span class="o">*</span><span class="p">(</span><span class="err">_: typedesc[WindowsShellItems_RootFolderBody], io: KaitaiStream, root: KaitaiStruct, parent: WindowsShellItems_ShellItemData): WindowsShellItems_RootFolderBody</span>
<span class="k">proc </span><span class="nf">read</span><span class="o">*</span><span class="p">(</span><span class="err">_: typedesc[WindowsShellItems_VolumeBody], io: KaitaiStream, root: KaitaiStruct, parent: WindowsShellItems_ShellItemData): WindowsShellItems_VolumeBody</span>
<span class="k">proc </span><span class="nf">read</span><span class="o">*</span><span class="p">(</span><span class="err">_: typedesc[WindowsShellItems_FileEntryBody], io: KaitaiStream, root: KaitaiStruct, parent: WindowsShellItems_ShellItemData): WindowsShellItems_FileEntryBody</span>

<span class="k">proc </span><span class="nf">isDir</span><span class="o">*</span><span class="p">(</span><span class="n">this</span><span class="p">:</span> <span class="n">WindowsShellItems_FileEntryBody</span><span class="p">):</span> <span class="kt">bool</span>
<span class="k">proc </span><span class="nf">isFile</span><span class="o">*</span><span class="p">(</span><span class="n">this</span><span class="p">:</span> <span class="n">WindowsShellItems_FileEntryBody</span><span class="p">):</span> <span class="kt">bool</span>


<span class="sd">##[</span>
<span class="n">Windows</span> <span class="n">Shell</span> <span class="n">Items</span> <span class="p">(</span><span class="n">AKA</span> <span class="s">&quot;shellbags&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">an</span> <span class="n">undocumented</span> <span class="kt">set</span> <span class="k">of</span>
<span class="n">structures</span> <span class="n">used</span> <span class="n">internally</span> <span class="n">within</span> <span class="n">Windows</span> <span class="n">to</span> <span class="n">identify</span> <span class="n">paths</span> <span class="ow">in</span>
<span class="n">Windows</span> <span class="n">Folder</span> <span class="n">Hierarchy</span><span class="p">.</span> <span class="n">It</span> <span class="ow">is</span> <span class="n">widely</span> <span class="n">used</span> <span class="ow">in</span> <span class="n">Windows</span> <span class="n">Shell</span> <span class="p">(</span><span class="ow">and</span>
<span class="n">most</span> <span class="n">visible</span> <span class="ow">in</span> <span class="n">File</span> <span class="n">Explorer</span><span class="p">),</span> <span class="n">both</span> <span class="k">as</span> <span class="ow">in</span><span class="o">-</span><span class="n">memory</span> <span class="ow">and</span> <span class="ow">in</span><span class="o">-</span><span class="n">file</span>
<span class="n">structures</span><span class="p">.</span> <span class="n">Some</span> <span class="n">formats</span> <span class="n">embed</span> <span class="n">them</span><span class="p">,</span> <span class="n">namely</span><span class="p">:</span>

<span class="o">*</span> <span class="n">Windows</span> <span class="n">Shell</span> <span class="n">link</span> <span class="n">files</span> <span class="p">(.</span><span class="n">lnk</span><span class="p">)</span> <span class="n">Windows</span> <span class="n">registry</span>
<span class="o">*</span> <span class="n">Windows</span> <span class="n">registry</span> <span class="s">&quot;ShellBags&quot;</span> <span class="n">keys</span>

<span class="n">The</span> <span class="n">format</span> <span class="ow">is</span> <span class="n">mostly</span> <span class="n">undocumented</span><span class="p">,</span> <span class="ow">and</span> <span class="ow">is</span> <span class="n">known</span> <span class="n">to</span> <span class="n">vary</span> <span class="n">between</span>
<span class="n">various</span> <span class="n">Windows</span> <span class="n">versions</span><span class="p">.</span>

<span class="o">@</span><span class="n">see</span> <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">&quot;https://github.com/libyal/libfwsi/blob/master/documentation/Windows%20Shell%20Item%20format.asciidoc&quot;</span><span class="o">&gt;</span><span class="n">Source</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
<span class="o">]</span><span class="sd">##</span>
<span class="k">proc </span><span class="nf">read</span><span class="o">*</span><span class="p">(</span><span class="err">_: typedesc[WindowsShellItems], io: KaitaiStream, root: KaitaiStruct, parent: KaitaiStruct): WindowsShellItems =</span>
  <span class="k">template</span> <span class="n">this</span><span class="p">:</span> <span class="n">untyped</span> <span class="o">=</span> <span class="n">result</span>
  <span class="n">this</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span><span class="n">WindowsShellItems</span><span class="p">)</span>
  <span class="k">let</span> <span class="n">root</span> <span class="o">=</span> <span class="k">if</span> <span class="n">root</span> <span class="o">==</span> <span class="kp">nil</span><span class="p">:</span> <span class="k">cast</span><span class="o">[</span><span class="n">WindowsShellItems</span><span class="o">]</span><span class="p">(</span><span class="n">this</span><span class="p">)</span> <span class="k">else</span><span class="p">:</span> <span class="k">cast</span><span class="o">[</span><span class="n">WindowsShellItems</span><span class="o">]</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
  <span class="n">this</span><span class="p">.</span><span class="n">io</span> <span class="o">=</span> <span class="n">io</span>
  <span class="n">this</span><span class="p">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
  <span class="n">this</span><span class="p">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>


  <span class="sd">##[</span>
  <span class="o">@</span><span class="n">see</span> <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">&quot;https://winprotocoldoc.blob.core.windows.net/productionwindowsarchives/MS-SHLLINK/[MS-SHLLINK].pdf&quot;</span><span class="o">&gt;</span><span class="n">Section</span> <span class="mf">2.2.1</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
  <span class="o">]</span><span class="sd">##</span>
  <span class="k">block</span><span class="p">:</span>
    <span class="kd">var</span> <span class="n">i</span><span class="p">:</span> <span class="kt">int</span>
    <span class="k">while</span> <span class="kp">true</span><span class="p">:</span>
      <span class="k">let</span> <span class="n">it</span> <span class="o">=</span> <span class="n">WindowsShellItems_ShellItem</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">this</span><span class="p">.</span><span class="n">io</span><span class="p">,</span> <span class="n">this</span><span class="p">.</span><span class="n">root</span><span class="p">,</span> <span class="n">this</span><span class="p">)</span>
      <span class="n">this</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">it</span><span class="p">.</span><span class="n">lenData</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">break</span>
      <span class="n">inc</span> <span class="n">i</span>

<span class="k">proc </span><span class="nf">fromFile</span><span class="o">*</span><span class="p">(</span><span class="err">_: typedesc[WindowsShellItems], filename: string): WindowsShellItems =</span>
  <span class="n">WindowsShellItems</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">newKaitaiFileStream</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="kp">nil</span><span class="p">,</span> <span class="kp">nil</span><span class="p">)</span>

<span class="k">proc </span><span class="nf">read</span><span class="o">*</span><span class="p">(</span><span class="err">_: typedesc[WindowsShellItems_ShellItemData], io: KaitaiStream, root: KaitaiStruct, parent: WindowsShellItems_ShellItem): WindowsShellItems_ShellItemData =</span>
  <span class="k">template</span> <span class="n">this</span><span class="p">:</span> <span class="n">untyped</span> <span class="o">=</span> <span class="n">result</span>
  <span class="n">this</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span><span class="n">WindowsShellItems_ShellItemData</span><span class="p">)</span>
  <span class="k">let</span> <span class="n">root</span> <span class="o">=</span> <span class="k">if</span> <span class="n">root</span> <span class="o">==</span> <span class="kp">nil</span><span class="p">:</span> <span class="k">cast</span><span class="o">[</span><span class="n">WindowsShellItems</span><span class="o">]</span><span class="p">(</span><span class="n">this</span><span class="p">)</span> <span class="k">else</span><span class="p">:</span> <span class="k">cast</span><span class="o">[</span><span class="n">WindowsShellItems</span><span class="o">]</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
  <span class="n">this</span><span class="p">.</span><span class="n">io</span> <span class="o">=</span> <span class="n">io</span>
  <span class="n">this</span><span class="p">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
  <span class="n">this</span><span class="p">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>

  <span class="k">let</span> <span class="n">codeExpr</span> <span class="o">=</span> <span class="n">this</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">readU1</span><span class="p">()</span>
  <span class="n">this</span><span class="p">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">codeExpr</span>
  <span class="k">block</span><span class="p">:</span>
    <span class="k">let</span> <span class="n">on</span> <span class="o">=</span> <span class="n">this</span><span class="p">.</span><span class="n">code</span>
    <span class="k">if</span> <span class="n">on</span> <span class="o">==</span> <span class="mi">31</span><span class="p">:</span>
      <span class="k">let</span> <span class="n">body1Expr</span> <span class="o">=</span> <span class="n">WindowsShellItems_RootFolderBody</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">this</span><span class="p">.</span><span class="n">io</span><span class="p">,</span> <span class="n">this</span><span class="p">.</span><span class="n">root</span><span class="p">,</span> <span class="n">this</span><span class="p">)</span>
      <span class="n">this</span><span class="p">.</span><span class="n">body1</span> <span class="o">=</span> <span class="n">body1Expr</span>
  <span class="k">block</span><span class="p">:</span>
    <span class="k">let</span> <span class="n">on</span> <span class="o">=</span> <span class="p">(</span><span class="n">this</span><span class="p">.</span><span class="n">code</span> <span class="ow">and</span> <span class="mi">112</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">on</span> <span class="o">==</span> <span class="mi">32</span><span class="p">:</span>
      <span class="k">let</span> <span class="n">body2Expr</span> <span class="o">=</span> <span class="n">WindowsShellItems_VolumeBody</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">this</span><span class="p">.</span><span class="n">io</span><span class="p">,</span> <span class="n">this</span><span class="p">.</span><span class="n">root</span><span class="p">,</span> <span class="n">this</span><span class="p">)</span>
      <span class="n">this</span><span class="p">.</span><span class="n">body2</span> <span class="o">=</span> <span class="n">body2Expr</span>
    <span class="k">elif</span> <span class="n">on</span> <span class="o">==</span> <span class="mi">48</span><span class="p">:</span>
      <span class="k">let</span> <span class="n">body2Expr</span> <span class="o">=</span> <span class="n">WindowsShellItems_FileEntryBody</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">this</span><span class="p">.</span><span class="n">io</span><span class="p">,</span> <span class="n">this</span><span class="p">.</span><span class="n">root</span><span class="p">,</span> <span class="n">this</span><span class="p">)</span>
      <span class="n">this</span><span class="p">.</span><span class="n">body2</span> <span class="o">=</span> <span class="n">body2Expr</span>

<span class="k">proc </span><span class="nf">fromFile</span><span class="o">*</span><span class="p">(</span><span class="err">_: typedesc[WindowsShellItems_ShellItemData], filename: string): WindowsShellItems_ShellItemData =</span>
  <span class="n">WindowsShellItems_ShellItemData</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">newKaitaiFileStream</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="kp">nil</span><span class="p">,</span> <span class="kp">nil</span><span class="p">)</span>


<span class="sd">##[</span>
<span class="o">@</span><span class="n">see</span> <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">&quot;https://winprotocoldoc.blob.core.windows.net/productionwindowsarchives/MS-SHLLINK/[MS-SHLLINK].pdf&quot;</span><span class="o">&gt;</span><span class="n">Section</span> <span class="mf">2.2.2</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
<span class="o">]</span><span class="sd">##</span>
<span class="k">proc </span><span class="nf">read</span><span class="o">*</span><span class="p">(</span><span class="err">_: typedesc[WindowsShellItems_ShellItem], io: KaitaiStream, root: KaitaiStruct, parent: WindowsShellItems): WindowsShellItems_ShellItem =</span>
  <span class="k">template</span> <span class="n">this</span><span class="p">:</span> <span class="n">untyped</span> <span class="o">=</span> <span class="n">result</span>
  <span class="n">this</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span><span class="n">WindowsShellItems_ShellItem</span><span class="p">)</span>
  <span class="k">let</span> <span class="n">root</span> <span class="o">=</span> <span class="k">if</span> <span class="n">root</span> <span class="o">==</span> <span class="kp">nil</span><span class="p">:</span> <span class="k">cast</span><span class="o">[</span><span class="n">WindowsShellItems</span><span class="o">]</span><span class="p">(</span><span class="n">this</span><span class="p">)</span> <span class="k">else</span><span class="p">:</span> <span class="k">cast</span><span class="o">[</span><span class="n">WindowsShellItems</span><span class="o">]</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
  <span class="n">this</span><span class="p">.</span><span class="n">io</span> <span class="o">=</span> <span class="n">io</span>
  <span class="n">this</span><span class="p">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
  <span class="n">this</span><span class="p">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>

  <span class="k">let</span> <span class="n">lenDataExpr</span> <span class="o">=</span> <span class="n">this</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">readU2le</span><span class="p">()</span>
  <span class="n">this</span><span class="p">.</span><span class="n">lenData</span> <span class="o">=</span> <span class="n">lenDataExpr</span>
  <span class="k">if</span> <span class="n">this</span><span class="p">.</span><span class="n">lenData</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
    <span class="k">let</span> <span class="n">rawDataExpr</span> <span class="o">=</span> <span class="n">this</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">readBytes</span><span class="p">(</span><span class="kt">int</span><span class="p">((</span><span class="n">this</span><span class="p">.</span><span class="n">lenData</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)))</span>
    <span class="n">this</span><span class="p">.</span><span class="n">rawData</span> <span class="o">=</span> <span class="n">rawDataExpr</span>
    <span class="k">let</span> <span class="n">rawDataIo</span> <span class="o">=</span> <span class="n">newKaitaiStream</span><span class="p">(</span><span class="n">rawDataExpr</span><span class="p">)</span>
    <span class="k">let</span> <span class="n">dataExpr</span> <span class="o">=</span> <span class="n">WindowsShellItems_ShellItemData</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">rawDataIo</span><span class="p">,</span> <span class="n">this</span><span class="p">.</span><span class="n">root</span><span class="p">,</span> <span class="n">this</span><span class="p">)</span>
    <span class="n">this</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">dataExpr</span>

<span class="k">proc </span><span class="nf">fromFile</span><span class="o">*</span><span class="p">(</span><span class="err">_: typedesc[WindowsShellItems_ShellItem], filename: string): WindowsShellItems_ShellItem =</span>
  <span class="n">WindowsShellItems_ShellItem</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">newKaitaiFileStream</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="kp">nil</span><span class="p">,</span> <span class="kp">nil</span><span class="p">)</span>


<span class="sd">##[</span>
<span class="o">@</span><span class="n">see</span> <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">&quot;https://github.com/libyal/libfwsi/blob/master/documentation/Windows%20Shell%20Item%20format.asciidoc#32-root-folder-shell-item&quot;</span><span class="o">&gt;</span><span class="n">Source</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
<span class="o">]</span><span class="sd">##</span>
<span class="k">proc </span><span class="nf">read</span><span class="o">*</span><span class="p">(</span><span class="err">_: typedesc[WindowsShellItems_RootFolderBody], io: KaitaiStream, root: KaitaiStruct, parent: WindowsShellItems_ShellItemData): WindowsShellItems_RootFolderBody =</span>
  <span class="k">template</span> <span class="n">this</span><span class="p">:</span> <span class="n">untyped</span> <span class="o">=</span> <span class="n">result</span>
  <span class="n">this</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span><span class="n">WindowsShellItems_RootFolderBody</span><span class="p">)</span>
  <span class="k">let</span> <span class="n">root</span> <span class="o">=</span> <span class="k">if</span> <span class="n">root</span> <span class="o">==</span> <span class="kp">nil</span><span class="p">:</span> <span class="k">cast</span><span class="o">[</span><span class="n">WindowsShellItems</span><span class="o">]</span><span class="p">(</span><span class="n">this</span><span class="p">)</span> <span class="k">else</span><span class="p">:</span> <span class="k">cast</span><span class="o">[</span><span class="n">WindowsShellItems</span><span class="o">]</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
  <span class="n">this</span><span class="p">.</span><span class="n">io</span> <span class="o">=</span> <span class="n">io</span>
  <span class="n">this</span><span class="p">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
  <span class="n">this</span><span class="p">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>

  <span class="k">let</span> <span class="n">sortIndexExpr</span> <span class="o">=</span> <span class="n">this</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">readU1</span><span class="p">()</span>
  <span class="n">this</span><span class="p">.</span><span class="n">sortIndex</span> <span class="o">=</span> <span class="n">sortIndexExpr</span>
  <span class="k">let</span> <span class="n">shellFolderIdExpr</span> <span class="o">=</span> <span class="n">this</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">readBytes</span><span class="p">(</span><span class="kt">int</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
  <span class="n">this</span><span class="p">.</span><span class="n">shellFolderId</span> <span class="o">=</span> <span class="n">shellFolderIdExpr</span>

<span class="k">proc </span><span class="nf">fromFile</span><span class="o">*</span><span class="p">(</span><span class="err">_: typedesc[WindowsShellItems_RootFolderBody], filename: string): WindowsShellItems_RootFolderBody =</span>
  <span class="n">WindowsShellItems_RootFolderBody</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">newKaitaiFileStream</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="kp">nil</span><span class="p">,</span> <span class="kp">nil</span><span class="p">)</span>


<span class="sd">##[</span>
<span class="o">@</span><span class="n">see</span> <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">&quot;https://github.com/libyal/libfwsi/blob/master/documentation/Windows%20Shell%20Item%20format.asciidoc#33-volume-shell-item&quot;</span><span class="o">&gt;</span><span class="n">Source</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
<span class="o">]</span><span class="sd">##</span>
<span class="k">proc </span><span class="nf">read</span><span class="o">*</span><span class="p">(</span><span class="err">_: typedesc[WindowsShellItems_VolumeBody], io: KaitaiStream, root: KaitaiStruct, parent: WindowsShellItems_ShellItemData): WindowsShellItems_VolumeBody =</span>
  <span class="k">template</span> <span class="n">this</span><span class="p">:</span> <span class="n">untyped</span> <span class="o">=</span> <span class="n">result</span>
  <span class="n">this</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span><span class="n">WindowsShellItems_VolumeBody</span><span class="p">)</span>
  <span class="k">let</span> <span class="n">root</span> <span class="o">=</span> <span class="k">if</span> <span class="n">root</span> <span class="o">==</span> <span class="kp">nil</span><span class="p">:</span> <span class="k">cast</span><span class="o">[</span><span class="n">WindowsShellItems</span><span class="o">]</span><span class="p">(</span><span class="n">this</span><span class="p">)</span> <span class="k">else</span><span class="p">:</span> <span class="k">cast</span><span class="o">[</span><span class="n">WindowsShellItems</span><span class="o">]</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
  <span class="n">this</span><span class="p">.</span><span class="n">io</span> <span class="o">=</span> <span class="n">io</span>
  <span class="n">this</span><span class="p">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
  <span class="n">this</span><span class="p">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>

  <span class="k">let</span> <span class="n">flagsExpr</span> <span class="o">=</span> <span class="n">this</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">readU1</span><span class="p">()</span>
  <span class="n">this</span><span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">flagsExpr</span>

<span class="k">proc </span><span class="nf">fromFile</span><span class="o">*</span><span class="p">(</span><span class="err">_: typedesc[WindowsShellItems_VolumeBody], filename: string): WindowsShellItems_VolumeBody =</span>
  <span class="n">WindowsShellItems_VolumeBody</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">newKaitaiFileStream</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="kp">nil</span><span class="p">,</span> <span class="kp">nil</span><span class="p">)</span>


<span class="sd">##[</span>
<span class="o">@</span><span class="n">see</span> <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">&quot;https://github.com/libyal/libfwsi/blob/master/documentation/Windows%20Shell%20Item%20format.asciidoc#34-file-entry-shell-item&quot;</span><span class="o">&gt;</span><span class="n">Source</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
<span class="o">]</span><span class="sd">##</span>
<span class="k">proc </span><span class="nf">read</span><span class="o">*</span><span class="p">(</span><span class="err">_: typedesc[WindowsShellItems_FileEntryBody], io: KaitaiStream, root: KaitaiStruct, parent: WindowsShellItems_ShellItemData): WindowsShellItems_FileEntryBody =</span>
  <span class="k">template</span> <span class="n">this</span><span class="p">:</span> <span class="n">untyped</span> <span class="o">=</span> <span class="n">result</span>
  <span class="n">this</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span><span class="n">WindowsShellItems_FileEntryBody</span><span class="p">)</span>
  <span class="k">let</span> <span class="n">root</span> <span class="o">=</span> <span class="k">if</span> <span class="n">root</span> <span class="o">==</span> <span class="kp">nil</span><span class="p">:</span> <span class="k">cast</span><span class="o">[</span><span class="n">WindowsShellItems</span><span class="o">]</span><span class="p">(</span><span class="n">this</span><span class="p">)</span> <span class="k">else</span><span class="p">:</span> <span class="k">cast</span><span class="o">[</span><span class="n">WindowsShellItems</span><span class="o">]</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
  <span class="n">this</span><span class="p">.</span><span class="n">io</span> <span class="o">=</span> <span class="n">io</span>
  <span class="n">this</span><span class="p">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
  <span class="n">this</span><span class="p">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>

  <span class="k">let</span> <span class="n">unnamed0Expr</span> <span class="o">=</span> <span class="n">this</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">readU1</span><span class="p">()</span>
  <span class="n">this</span><span class="p">.</span><span class="n">unnamed0</span> <span class="o">=</span> <span class="n">unnamed0Expr</span>
  <span class="k">let</span> <span class="n">fileSizeExpr</span> <span class="o">=</span> <span class="n">this</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">readU4le</span><span class="p">()</span>
  <span class="n">this</span><span class="p">.</span><span class="n">fileSize</span> <span class="o">=</span> <span class="n">fileSizeExpr</span>
  <span class="k">let</span> <span class="n">lastModTimeExpr</span> <span class="o">=</span> <span class="n">this</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">readU4le</span><span class="p">()</span>
  <span class="n">this</span><span class="p">.</span><span class="n">lastModTime</span> <span class="o">=</span> <span class="n">lastModTimeExpr</span>
  <span class="k">let</span> <span class="n">fileAttrsExpr</span> <span class="o">=</span> <span class="n">this</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">readU2le</span><span class="p">()</span>
  <span class="n">this</span><span class="p">.</span><span class="n">fileAttrs</span> <span class="o">=</span> <span class="n">fileAttrsExpr</span>

<span class="k">proc </span><span class="nf">isDir</span><span class="p">(</span><span class="n">this</span><span class="p">:</span> <span class="n">WindowsShellItems_FileEntryBody</span><span class="p">):</span> <span class="kt">bool</span> <span class="o">=</span> 
  <span class="k">if</span> <span class="n">this</span><span class="p">.</span><span class="n">isDirInstFlag</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">this</span><span class="p">.</span><span class="n">isDirInst</span>
  <span class="k">let</span> <span class="n">isDirInstExpr</span> <span class="o">=</span> <span class="kt">bool</span><span class="p">((</span><span class="n">this</span><span class="p">.</span><span class="n">parent</span><span class="p">.</span><span class="n">code</span> <span class="ow">and</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
  <span class="n">this</span><span class="p">.</span><span class="n">isDirInst</span> <span class="o">=</span> <span class="n">isDirInstExpr</span>
  <span class="n">this</span><span class="p">.</span><span class="n">isDirInstFlag</span> <span class="o">=</span> <span class="kp">true</span>
  <span class="k">return</span> <span class="n">this</span><span class="p">.</span><span class="n">isDirInst</span>

<span class="k">proc </span><span class="nf">isFile</span><span class="p">(</span><span class="n">this</span><span class="p">:</span> <span class="n">WindowsShellItems_FileEntryBody</span><span class="p">):</span> <span class="kt">bool</span> <span class="o">=</span> 
  <span class="k">if</span> <span class="n">this</span><span class="p">.</span><span class="n">isFileInstFlag</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">this</span><span class="p">.</span><span class="n">isFileInst</span>
  <span class="k">let</span> <span class="n">isFileInstExpr</span> <span class="o">=</span> <span class="kt">bool</span><span class="p">((</span><span class="n">this</span><span class="p">.</span><span class="n">parent</span><span class="p">.</span><span class="n">code</span> <span class="ow">and</span> <span class="mi">2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
  <span class="n">this</span><span class="p">.</span><span class="n">isFileInst</span> <span class="o">=</span> <span class="n">isFileInstExpr</span>
  <span class="n">this</span><span class="p">.</span><span class="n">isFileInstFlag</span> <span class="o">=</span> <span class="kp">true</span>
  <span class="k">return</span> <span class="n">this</span><span class="p">.</span><span class="n">isFileInst</span>

<span class="k">proc </span><span class="nf">fromFile</span><span class="o">*</span><span class="p">(</span><span class="err">_: typedesc[WindowsShellItems_FileEntryBody], filename: string): WindowsShellItems_FileEntryBody =</span>
  <span class="n">WindowsShellItems_FileEntryBody</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">newKaitaiFileStream</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="kp">nil</span><span class="p">,</span> <span class="kp">nil</span><span class="p">)</span>
</pre></div>

        </div>
        
    </div>
</section>

    <footer id="main-footer">
        <div class="container">
            &copy; 2015&ndash;2021 Kaitai Project and <a href="https://github.com/kaitai-io/kaitai_struct_formats/graphs/contributors">format repo contributors</a>

            <h3>Contacts</h3>

            <div class="row">
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-github"></i> <a href="https://github.com/kaitai-io/kaitai_struct">GitHub</a>
                </div>
                <div class="col-sm-4">
                    <i class="fa fa-fw fa-2x fa-twitter"></i> <a href="https://twitter.com/kaitai_io">@kaitai_io</a>
                </div>
                <div class="col-sm-4">
                    Gitter: <a href="https://gitter.im/kaitai_struct/Lobby">kaitai_struct</a>
                </div>
            </div>
        </div>
    </footer>

  <script src="//kaitai.io/js/jquery-1.12.3.min.js"></script>
  <script src="//kaitai.io/js/bootstrap.min.js"></script>

  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-76299550-1', 'auto');
      ga('send', 'pageview');
  </script>
</body>
</html>
